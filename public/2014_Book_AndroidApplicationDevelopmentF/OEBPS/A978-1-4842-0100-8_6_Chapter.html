<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><title>Customization and Installation of Android</title><link href="springer_epub.css" type="text/css" rel="styleSheet"/></head><body><div class="ChapterContextInformation"><div class="ContextInformation" id="Chap6"><div class="ChapterCopyright">© Ryan Cohen 2014</div><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">Ryan Cohen</span> and </span><span class="Author"><span class="AuthorName">Tao Wang</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" xml:lang="en">Android Application Development for the Intel<sup>®</sup> Platform</span></span><span class="ChapterDOI">10.1007/978-1-4842-0100-8_6</span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" xml:lang="en">6. Customization and Installation of Android</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">Ryan Cohen</span><sup>1 <span class="ContactIcon"/></sup> and </span><span class="Author"><span class="AuthorName">Tao Wang</span><sup>1 <span class="ContactIcon"/></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff1"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">OR, USA</div></div><div class="ClearBoth"> </div></div></div><!--End Abstract--><div class="Fulltext"><div class="Para">Due to the characteristics of any embedded systems, such as resource constraints, tailoring and customization are important features for an embedded OS, and Android is no exception. This chapter provides a general discussion of customization in an embedded OS and then explains the customization of Android, specifically.</div><div id="Sec1" class="Section1 RenderAsSection1"><h2 class="Heading">Tailoring and Customization of an Embedded OS</h2><div class="Para">Not all functions and services provided by the embedded OS are included in a special embedded application, for two reasons. First, the embedded system is always resource constrained, especially with regard to storage space; thus it is impossible to include all redundant functions in the system at release. Second, many commercial embedded OSs collect a licensing fee based on the components chosen by the user. So, users should tailor the embedded OS according to their individual needs. The principle of OS customization is shown in Figure <span class="InternalRef"><a href="#Fig1">6-1</a></span>.<div class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img src="A978-1-4842-0100-8_6_Fig1_HTML.jpg" alt="A978-1-4842-0100-8_6_Fig1_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 6-1.</span><div class="SimplePara">Principle of OS customization</div></div></div></div>
          </div><div class="Para">For example, Windows XP Embedded OS offers tens of thousands of components—more than the functions of desktop Windows XP. But for a subway baffle-gate system based on Windows XP Embedded, for example, components such as Windows Media Player, the Internet Explorer browser, the DirectX settings panel, and Explorer task manager are not required. Eliminating such components reduces the hardware resources required by the system, thus reducing the cost; and this makes the system operate faster, thereby improving efficiency.</div><div class="Para">A majority of embedded OSs provide means for customization and tailoring. However, there are many different tailoring modes: some start with compiling source code, which requires the user to configure the option of conditional compilation; some start by linking the target files, linking to different library files according to the user’s configuration; and the remaining modes extract precompiled files from the existing binary file library according to the user’s choice. Table <span class="InternalRef"><a href="#Tab1">6-1</a></span> lists the customization modes provided by frequently used embedded OSs.<div id="Tab1" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 6-1.</span><div class="SimplePara">Customization Modes of Different Embedded Operating Systems</div></div></div><table border="1"><colgroup><col/><col/></colgroup><thead><tr class="header"><th><div class="SimplePara">Embedded OS</div></th><th><div class="SimplePara">Customization Modes</div></th></tr></thead><tbody><tr class="noclass"><td><div class="SimplePara">Windows CE</div></td><td><div class="SimplePara">Provide Platform Builder IDE and graphical component options. Link different library files according to the selected components.</div></td></tr><tr class="noclass"><td><div class="SimplePara">Embedded Linux</div></td><td><div class="SimplePara">For the kernel, generate config files via <span class="EmphasisFontCategoryNonProportional">make config</span> before; then compile according to the configuration files.</div></td></tr><tr class="noclass"><td><div class="SimplePara">Windows XP Embedded</div></td><td><div class="SimplePara">Provide Target Designer IDE and graphical component options. Extract required binary files according to the selected components; no compilation is necessary for the linking process.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisTypeItalic">μ</span>C/OS-II</div></td><td><div class="SimplePara">Selectively and conditionally compile some part of the code according to the value defined by the C language macro in the header file.</div></td></tr><tr class="noclass"><td><div class="SimplePara">VxWorks</div></td><td><div class="SimplePara">Select which modules are necessary in the Tornado IDE.</div></td></tr></tbody></table></div>
          </div><div class="Para">After system customization, you get an embedded OS that runs on the target hardware device and has been optimized for the special application field.</div></div><div id="Sec2" class="Section1 RenderAsSection1"><h2 class="Heading">Overview of Android Customization</h2><div class="Para">Theoretically, Android customization falls into two levels: customization of the Linux kernel and customization of the entire image. Customization of the Linux kernel is similar to customization of embedded Linux: both involve the same methods and steps. Android customization mainly focuses on image customization. Let’s see why.</div><div id="Sec3" class="Section2 RenderAsSection2"><h3 class="Heading">ROM Package/Image</h3><div class="Para">The Android image is commonly known as a read-only memory (ROM) package, which is the system package of an Android phone. The reason for this naming convention is that mobile phones prior to Android phones, including smartphones (such as Nokia and WM) and non-smart phones (such as Sony Ericsson, Moto P2K platform, and MTK), all have a separate ROM chip storage system file. So, the system file is referred to as ROM package or ROM image.</div><div class="Para">The image is a cross-compiled binary Linux file that can be installed and run on some embedded device, becoming the OS of the device. To better understand this concept, let’s review the typical development process, shown in Figure <span class="InternalRef"><a href="#Fig2">6-2</a></span>.<div class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img src="A978-1-4842-0100-8_6_Fig2_HTML.jpg" alt="A978-1-4842-0100-8_6_Fig2_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 6-2.</span><div class="SimplePara">Development process for Android software</div></div></div></div>
            </div><div class="Para">For embedded software, generally speaking, developing Android software requires the same steps as general-purpose software: designing, encoding, compiling, linking, packaging, deploying, debugging, and optimizing. For some Android systems, testing and verification steps are also required. The OS deployed on the embedded logic device also goes through such phases. For example, for a Linux system, you get its kernel source code, cross-compile, and generate code that can be executed on the embedded target machine; then you compress and package this code to form the image file (see Figure <span class="InternalRef"><a href="#Fig3">6-3</a></span>). The last step is deployment. Unlike the deployment of an application file, the deployment of an OS image file is referred to as <span class="EmphasisTypeItalic">installation</span> due to the particularity of its operation. <div class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img src="A978-1-4842-0100-8_6_Fig3_HTML.jpg" alt="A978-1-4842-0100-8_6_Fig3_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 6-3.</span><div class="SimplePara">Image use process</div></div></div></div>
            </div><div class="Para">The image file (package) of a complete executable software system in the embedded system consists of the bootloader, OS kernel (kernel for short), file system, and user applications. The actual image file usually adopts a partition (also known as independent layer) structure to store all parts that are located in different areas (modules) of the image, and all parts are loaded into the system from the bottom layer. An example of a typical embedded system image is shown in Figure <span class="InternalRef"><a href="#Fig4">6-4</a></span>. <div class="Figure" id="Fig4"><div class="MediaObject" id="MO4"><img src="A978-1-4842-0100-8_6_Fig4_HTML.jpg" alt="A978-1-4842-0100-8_6_Fig4_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 6-4.</span><div class="SimplePara">Example of an embedded system image</div></div></div></div>
            </div><div class="Para">The Android image includes a bootloader, the core OS, a hardware adaptation module, a file system, the user experience, and applications. The core OS layer of Android includes the Linux kernel and various middleware modules. Below the core OS layer is the hardware adaptation layer. To adapt to different hardware, diversified drivers need to be installed for the OS. Without these drivers, the OS cannot use the hardware to operate as usual. Therefore, the image consists of the drivers and any applications developed by the user.</div><div class="Para">The Android image usually exists in the form of a compressed file (<span class="EmphasisFontCategoryNonProportional">.zip</span>, <span class="EmphasisFontCategoryNonProportional">tar.gz</span>, or a similar file format), which usually contains the file and folders shown in Table <span class="InternalRef"><a href="#Tab2">6-2</a></span>. The file structure can be seen after the compressed file is decompressed. <div id="Tab2" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 6-2.</span><div class="SimplePara">File Structure of an Android Image File</div></div></div><table border="1"><colgroup><col/><col/><col/></colgroup><thead><tr class="header"><th><div class="SimplePara">Name</div></th><th><div class="SimplePara">Property r</div></th><th><div class="SimplePara">Remarks</div></th></tr></thead><tbody><tr class="noclass"><td><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">META-IN</span>
                        </div></td><td><div class="SimplePara">Directory</div></td><td><div class="SimplePara">Optional; may be unavailable in some images</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">system</span>
                        </div></td><td><div class="SimplePara">Directory</div></td><td> </td></tr><tr class="noclass"><td><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">boot.img</span>
                        </div></td><td><div class="SimplePara">File</div></td><td> </td></tr></tbody></table></div>
            </div><div class="Para">The function and structure of the files and folders are as follows:<div class="UnorderedList"><ul class="UnorderedListMarkNone"><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">boot.img</span>
                    <span class="EmphasisTypeItalic">file:</span> The system image, including the Linux kernel, bootloader, and ramdisk launched by the system. A ramdisk is a small file system that holds the core files needed to initialize the system. The <span class="EmphasisFontCategoryNonProportional">boot.img</span> file is created using an open source tool called mkbootimg.</div></li><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">META-INF</span>
                    <span class="EmphasisTypeItalic">directory:</span> The system-update script, with the path <span class="EmphasisFontCategoryNonProportional">META-INF\com\google\android\updater-script</span>.</div></li><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">system\app</span>
                    <span class="EmphasisTypeItalic">directory:</span> All system-provided applications such as calendar, contacts, Gmail, and so on. You can put your application’s <span class="EmphasisFontCategoryNonProportional">.apk</span> file in this directory so it can be directly installed when the ROM is reflashed.</div></li><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">system\bin</span>
                    <span class="EmphasisTypeItalic">directory:</span> System commands such as <span class="EmphasisFontCategoryNonProportional">top</span>, which can be executed after logging in through the adb shell.</div></li><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">system\etc</span>
                    <span class="EmphasisTypeItalic">directory:</span> Configuration files.</div></li><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">system\font</span>
                    <span class="EmphasisTypeItalic">directory:</span> All kinds of fonts.</div></li><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">system\framework</span>
                    <span class="EmphasisTypeItalic">directory:</span> Java core files, such as <span class="EmphasisFontCategoryNonProportional">.jar</span> files. Under the Dalvik virtual machine (DVM), it supports the framework developed by the user via Java.</div></li><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">system\lib</span>
                    <span class="EmphasisTypeItalic">directory:</span> Android local shared libraries that consist of <span class="EmphasisFontCategoryNonProportional">.so</span> files, which are shared objects in the form of ELF binaries, compiled by assembler, C, or C++.</div></li><li><div class="Para">
                    <span class="EmphasisFontCategoryNonProportional">system\media</span>
                    <span class="EmphasisTypeItalic">directory:</span> Media files such as <span class="EmphasisFontCategoryNonProportional">bootanimation.zip</span>, which consists of <span class="EmphasisFontCategoryNonProportional">.png</span> pictures used for boot animation and for changing the boot image. Under the <span class="EmphasisFontCategoryNonProportional">audio</span> directory are some audio files that are used as ringtones and for notifications.</div></li></ul></div>
            </div></div><div id="Sec4" class="Section2 RenderAsSection2"><h3 class="Heading">Overview of Android Image Customization</h3><div class="Para">
              <span class="EmphasisTypeItalic">Android image customization</span>, commonly known as <span class="EmphasisTypeItalic">creating Android ROM</span> (<span class="EmphasisTypeItalic">creating ROM</span> for short), is an academic term. The Android core OS layer has multiple components, and the applications vary in different systems; image customization decides which components and applications are written into the image file of the target system. The process makes a personal customized system file into a flashable ROM image. This is also known as a <span class="EmphasisTypeItalic">system firmware update</span>.</div><div class="Para">The ready-made Android image can be installed onto an Intel Atom processor-based system (that is, a mobile phone, tablet, or the like) via USB flash and SD card. Then the system with the Android image will have the capability to enter the Android operating environment at self-start.The MicroSD card, originally called the TransFlash Card, was launched by SanDisk. It is 15 × 11 × 1 mm, about the size of a fingernail. It can be used in an SD card slot via an SD adapter card and is widely used in mobile phones.</div><div class="Para">You can create Android ROM in the following ways:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">Compile the Android source code, which is a little complex.</div></li><li><div class="Para">Create or customize your own ROM based on the existing ROM.</div></li></ul></div>
            </div><div class="Para">The process of Android image customization is shown in Figure <span class="InternalRef"><a href="#Fig5">6-5</a></span>.<div class="Figure" id="Fig5"><div class="MediaObject" id="MO5"><img src="A978-1-4842-0100-8_6_Fig5_HTML.jpg" alt="A978-1-4842-0100-8_6_Fig5_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 6-5.</span><div class="SimplePara">Process of Android image customization</div></div></div></div>
            </div></div><div id="Sec5" class="Section2 RenderAsSection2"><h3 class="Heading">Example of Android Image Customization</h3><div class="Para">The following example illustrates the second way to customize Android: by creating ROM using the cloned ROM image released by device manufacturer for targeted hardware. In this way, the Android customization includes structure parsing for Android system folder, application software updates, and the customization of the ROM signature package. The steps are as follows:
<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><div class="Para">Download the compiled ROM package from Android’s official website, your mobile phone manufacturer’s official website (for example, the website for the Lenovo K900 mobile phone), or websites providing an Android image. For example, the ROM provided by the Lenovo K900 mobile phone’s website (<span class="ExternalRef"><a href="http://www.lenovocare.com.cn/ProductDetail.aspx?id=719"><span class="RefSource">www.​lenovocare.​com.​cn/​ProductDetail.​aspx?​id=​719</span></a></span>) is shown in Table <span class="InternalRef"><a href="#Tab3">6-3</a></span>. Be noted that since the Lenovo K800 and K900 phones are sold in China market, the software dates are only provided by Lenovo’s official site in Chinese language.</div></div><div class="ClearBoth"> </div></div></div>
            </div><div class="Para">
              <div id="Tab3" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 6-3.</span><div class="SimplePara">Information in the ROM Package on the Lenovo K900 Website</div></div></div><table border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr class="header"><th><div class="SimplePara">ROM Name</div></th><th><div class="SimplePara">Description</div></th><th><div class="SimplePara">Android Version</div></th><th><div class="SimplePara">Date of Release</div></th></tr></thead><tbody><tr class="noclass"><td><div class="SimplePara">K900_1_S_2_162_0074</div></td><td><div class="SimplePara">Official update</div></td><td><div class="SimplePara">4.0.4</div></td><td><div class="SimplePara">Aug. 8, 2012</div></td></tr><tr class="noclass"><td><div class="SimplePara">K900_1_S_2_162_0086</div></td><td><div class="SimplePara">Official update</div></td><td><div class="SimplePara">4.0.4</div></td><td><div class="SimplePara">Aug. 15, 2012</div></td></tr><tr class="noclass"><td><div class="SimplePara">K900_1_S_2_019_0113_130903</div></td><td><div class="SimplePara">Official update</div></td><td><div class="SimplePara">4.2.0</div></td><td><div class="SimplePara">Sep. 3, 2013</div></td></tr><tr class="noclass"><td><div class="SimplePara">K900_source</div></td><td><div class="SimplePara">Official update</div></td><td><div class="SimplePara">4.4</div></td><td><div class="SimplePara">May 23, 2014</div></td></tr></tbody></table></div>
            </div><div class="Para">
              <div class="OrderedList"><div class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><div class="Para">Compress all the ROM files into one folder (named NewsROM” in this example).</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">3.</span><div class="ItemContent"><div class="Para">Delete and add files in the ROM folder (NewsROM in this example) to tailor and customize Android.</div></div><div class="ClearBoth"> </div></div></div>
            </div><div class="Para">Some customization examples are as follows:
<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">Go to the <span class="EmphasisFontCategoryNonProportional">data\app</span> directory to check whether the preinstalled applications are what you need. At this point you can remove unnecessary apps. You can also add the default installed applications you need.</div></li><li><div class="Para">Go to the <span class="EmphasisFontCategoryNonProportional">system\app</span> directory and customize the system applications for your device. You can delete unwanted system applications or add your special-built or customized applications (as customized <span class="EmphasisFontCategoryNonProportional">.apk</span> files). Be careful: some system applications are dependent on others, so best practice is to test before the customization to fix dependencies and other issues prior to implementing the changes to the Android system image.</div></li><li><div class="Para">Go to the <span class="EmphasisFontCategoryNonProportional">system\media</span> directory to make modifications such as changing the boot image or adding a customized ringtone.</div></li><li><div class="Para">Go to the <span class="EmphasisFontCategoryNonProportional">system\bin</span> directory to add commands and so forth.</div></li></ul></div>
            </div><div class="Para">If you’re worried about deleting some files accidently and thus causing failure at startup, you should adopt a conservative approach: execute delete or add operations only for files in the <span class="EmphasisFontCategoryNonProportional">data/app</span> and <span class="EmphasisFontCategoryNonProportional">system/app</span> folders.
<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">4.</span><div class="ItemContent"><div class="Para">Compress the modified ROM folder as a <span class="EmphasisFontCategoryNonProportional">.zip</span> file. Ensure that the contents, including <span class="EmphasisFontCategoryNonProportional">META-INF</span>, <span class="EmphasisFontCategoryNonProportional">system</span>, <span class="EmphasisFontCategoryNonProportional">boot.img</span>, and <span class="EmphasisFontCategoryNonProportional">data</span> (optional), are displayed when you double-click the compressed file.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">5.</span><div class="ItemContent"><div class="Para">Install and configure the Java environment. The Java environment is required in the following steps to support the operation of the auto-sign tool, so you need to install and set up Java operation. Download the latest JDK (jdk1.7.0 in this example), and install it; then follow these steps:<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">a.</span><div class="ItemContent"><div class="Para">Set the Java environment variable as follows: right-click My Computer and select [Properties] ➤ [Advanced] ➤ [Environment Variables] ➤ [System Variables] ➤ [New] in the pop-up shortcut menu.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">b.</span><div class="ItemContent"><div class="Para">In the dialog box, set [Variable Name] to “JAVA_HOME variable value: JAVA installation directory”. Find [path] in the same place, double-click it, and add “C:\JDK1.7.0;.;C:\JDK1.7.0\bin” after the variable value.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">c.</span><div class="ItemContent"><div class="Para">Reboot the system.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">d.</span><div class="ItemContent"><div class="Para">Test. Enter Java commands in the command-line window. The configuration is successful if no error message appears.</div></div><div class="ClearBoth"> </div></div></div>
                    </div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">6.</span><div class="ItemContent"><div class="Para">Use the <span class="EmphasisFontCategoryNonProportional">sign</span> tool to sign the <span class="EmphasisFontCategoryNonProportional">.zip</span> packages. The steps are as follows:<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">a.</span><div class="ItemContent"><div class="Para">Download the auto-sign tool and unpack it under a directory (<span class="EmphasisFontCategoryNonProportional">myautosign</span> in this example). The tool can be downloaded at <span class="ExternalRef"><a href="http://androidforums.com/developer-101/8665-how-signing-roms.html"><span class="RefSource">
                                  <span class="EmphasisFontCategoryNonProportional">http://androidforums.com/developer-101/8665-how-signing-roms.html</span>
                                </span></a></span>.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">b.</span><div class="ItemContent"><div class="Para">Rename the <span class="EmphasisFontCategoryNonProportional">.zip</span> file package to <span class="EmphasisFontCategoryNonProportional">update.zip</span>, and copy it to the directory where you unpacked auto-sign (the <span class="EmphasisFontCategoryNonProportional">myautosign</span> directory).</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">c.</span><div class="ItemContent"><div class="Para">Run the <span class="EmphasisFontCategoryNonProportional">sign.bat</span> file under the directory where you unpacked auto-sign.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">d.</span><div class="ItemContent"><div class="Para">After the customization build, the directory contains an <span class="EmphasisFontCategoryNonProportional">update_signed.zip</span> file, which is the signed ROM package and the customized ROM package you need.</div></div><div class="ClearBoth"> </div></div></div>
                    </div></div><div class="ClearBoth"> </div></div></div>
            </div></div><div id="Sec6" class="Section2 RenderAsSection2"><h3 class="Heading">Installation/Reflash of the Android Image</h3><div class="Para">Image installation is required to use the customized image on the target machine. In other words, the process of image customization and use must go through two stages: image generation (production) and image installation, as shown in Figure <span class="InternalRef"><a href="#Fig6">6-6</a></span>.<div class="Figure" id="Fig6"><div class="MediaObject" id="MO6"><img src="A978-1-4842-0100-8_6_Fig6_HTML.jpg" alt="A978-1-4842-0100-8_6_Fig6_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 6-6.</span><div class="SimplePara">Image generation and installation</div></div></div></div>
            </div><div class="Para">
              <span class="EmphasisTypeItalic">Image installation</span> means installing the Android image on the target device or emulator. This process is commonly known as <span class="EmphasisTypeItalic">reflashing</span>. Reflashing an Android phone is equivalent to reinstalling the system for the phone, which is similar to computer system reinstallation. Generally speaking, when a computer needs system reinstallation, you use a system disk or an image file. When an Android phone needs to be reflashed, you burn an official or third-party ROM image file into the ROM via a tool and install a new system for the phone.</div><div class="Para">The official Android website often releases the latest Android image systems for users, so you can download image files directly to skip image-generation stage. For users, the customization and installation process can be very simple: download the image, and reflash.</div><div class="Para">Android installation also involves <span class="EmphasisTypeItalic">recovery</span> and <span class="EmphasisTypeItalic">wiping</span>:
<div class="UnorderedList"><ul class="UnorderedListMarkNone"><li><div class="Para">
                    <span class="EmphasisTypeItalic">Recovery</span>is a mode of the mobile device. Through recovery, users can install the system (that is, reflash ROM), empty various data from the phone, partition a memory card, back up and restore data, and so on. Recovery is similar to the Ghost one-key recovery function on a computer.</div></li><li><div class="Para">
                    <span class="EmphasisTypeItalic">Wipe</span>means to erase and remove. Wiping is an option in recovery mode; it removes various data from the phone, similar to restoring factory defaults. Wipe is most commonly used before the reflash. Users may see the Wipe prompt, which suggests the need to clear data before the reflash.</div></li></ul></div>
            </div><div class="Para">As mentioned, Android installation is essentially an issue of deployment in the process of software cross-development, but generally you adopt offline programming instead of online programming. In the installation process, the media you use are SD cards and other portable external storage devices. This process is shown in Figure <span class="InternalRef"><a href="#Fig7">6-7</a></span>. The installation is divided into two steps: first, place the image from the host on the portable SD card external storage device; second, start the machine from the portable external storage device and install Android on the target machine. <div class="Figure" id="Fig7"><div class="MediaObject" id="MO7"><img src="A978-1-4842-0100-8_6_Fig7_HTML.jpg" alt="A978-1-4842-0100-8_6_Fig7_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 6-7.</span><div class="SimplePara">Android image installation</div></div></div></div>
            </div></div><div id="Sec7" class="Section2 RenderAsSection2"><h3 class="Heading">Image Installation Example</h3><div class="Para">Following is an example of image installation. The path/directory may be different from different OEMs or from different Android versions (this example is based on a Lenovo phone):
<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><div class="Para">Empty the phone’s SD card. This step is optional and can be done either on the host or on the phone. It is very simple to complete the step on the host: unplug the SD card from the phone, insert it in the SD card reader of the host, and delete all files from the removable disk at the host (for example, in Windows).</div></div><div class="ClearBoth"> </div></div></div>
            </div><div class="Para">Empty the SD card on the phone by following these steps:
<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">a.</span><div class="ItemContent"><div class="Para">Connect the phone to the host.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">b.</span><div class="ItemContent"><div class="Para">Execute the following commands successively in the command-line window at the host:</div></div><div class="ClearBoth"> </div></div></div>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">adb devices</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">adb remount</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">adb shell</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">su</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">rm -r /system/sd/*</span>
            </div><div class="Para">
              <div class="UnorderedList"><ul class="UnorderedListMarkNone"><li><div class="Para">(Note: <span class="EmphasisFontCategoryNonProportional">sdcard</span> is usually mounted under <span class="EmphasisFontCategoryNonProportional">/storage/sdcard0</span> or <span class="EmphasisFontCategoryNonProportional">/sdcard</span>, However, the location may be different if you’re using a device from a different OEM or on another Android version.)</div></li></ul></div>
              <div class="OrderedList"><div class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><div class="Para">Copy the customized ROM file (<span class="EmphasisFontCategoryNonProportional">update_signed.zip</span> in the example) to the SD card, and rename it <span class="EmphasisFontCategoryNonProportional">update.zip</span>.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">3.</span><div class="ItemContent"><div class="Para">Make sure the SD card has been inserted in the phone. Restart the phone, and enter Recovery mode. Follow these steps:
<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">a.</span><div class="ItemContent"><div class="Para">Shut down the phone normally.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">b.</span><div class="ItemContent"><div class="Para">Press the power button and the &lt;volume+&gt; button of the device at the same time: the phone starts while vibrating and enters BKB Provisioning OS mode. Double-click the &lt;volume+&gt; button quickly to make the system enter Test mode.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">c.</span><div class="ItemContent"><div class="Para">Press &lt;volume+&gt; and &lt;volume-&gt; to move to the sixth option (SD Update), and click Enter in the lower-left corner. Automatic reflash begins.</div></div><div class="ClearBoth"> </div></div></div>
                    </div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">4.</span><div class="ItemContent"><div class="Para">Reboot.</div></div><div class="ClearBoth"> </div></div></div>
            </div><div class="Para">The entire reflash process takes a few minutes. The phone restarts automatically after vibrating twice; the first reboot takes longer, and then the familiar four-leaf clover interface appears.</div><div class="Para">After reboot, choose Settings ➤ System Information to check the phone, network, battery, and version information; IMEI code; and internal version number to confirm whether the upgrade has been successful.</div><div id="Sec8" class="Section3 RenderAsSection3"><h4 class="Heading">Automating the Procedure with flash_device.sh</h4><div class="Para">There is a script that will perform all the previously described procedures for you. This script is located here:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">&lt;Path-to-your-project&gt;/vendor/intel/support/flash_device.sh</span>
              </div><div class="Para">You can add this script to your <span class="EmphasisFontCategoryNonProportional">bin</span> folder and run it from a terminal window. You should be able to find the section on this topic in the user manual from the OEM.</div></div></div><div id="Sec9" class="Section2 RenderAsSection2"><h3 class="Heading">Intel Build Tools Suite</h3><div class="Para">Intel has developed an Android Build Tools Suite (see Figure <span class="InternalRef"><a href="#Fig8">6-8</a></span>) to help developers easily and quickly do the Android system build and customization. The suite provides the following features:
<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">Device customization</div></li><li><div class="Para">Ability to generate a customized firmware module and Android OS image</div></li><li><div class="Para">Final customization and localization</div></li><li><div class="Para">Ability to compile a single image and load the image into a supported device</div></li><li><div class="Para">Ability to verify configuration readiness</div></li><li><div class="Para">Troubleshooting and calibration</div></li></ul></div>
              <div class="Figure" id="Fig8"><div class="MediaObject" id="MO8"><img src="A978-1-4842-0100-8_6_Fig8_HTML.jpg" alt="A978-1-4842-0100-8_6_Fig8_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 6-8.</span><div class="SimplePara">Intel Build Tools Suite</div></div></div></div>
            </div></div></div><div id="Sec10" class="Section1 RenderAsSection1"><h2 class="Heading">Summary</h2><div class="Para">This chapter completed the discussion of system-level topics for Android. Starting in the next chapter, you begin to learn application development for Android on x86, and you see how to develop user interfaces suitable for the UX and interaction characteristics of mobile devices on Android. You start by learning about Android graphic user interface (GUI) design, because it’s an indispensable part of human-computer interaction (HCI). Because resources are limited for a mobile phone or tablet, GUI design of Android systems is more challenging than for desktops. In addition, users have more rigorous demands and expectations for a user-friendly experience. Interface design has become one of the important factors determining the success of applications for Android on the market.</div></div></div></body></html>
