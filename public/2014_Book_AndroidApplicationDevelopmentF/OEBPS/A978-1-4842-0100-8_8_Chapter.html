<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><title>GUI Design for Android Apps, Part 2: The Android-Specific GUI</title><link href="springer_epub.css" type="text/css" rel="styleSheet"/></head><body><div class="ChapterContextInformation"><div class="ContextInformation" id="Chap8"><div class="ChapterCopyright">© Ryan Cohen 2014</div><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">Ryan Cohen</span> and </span><span class="Author"><span class="AuthorName">Tao Wang</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" xml:lang="en">Android Application Development for the Intel<sup>®</sup> Platform</span></span><span class="ChapterDOI">10.1007/978-1-4842-0100-8_8</span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" xml:lang="en">8. GUI Design for Android Apps, Part 2: The Android-Specific GUI</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">Ryan Cohen</span><sup>1 <span class="ContactIcon"/></sup> and </span><span class="Author"><span class="AuthorName">Tao Wang</span><sup>1 <span class="ContactIcon"/></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff1"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">OR, USA</div></div><div class="ClearBoth"> </div></div></div><!--End Abstract--><div class="Fulltext"><div class="Para">This chapter describes the state transitions of activities and discusses the <span class="EmphasisFontCategoryNonProportional">Context</span> class, intent, and the relationship between applications and activities.</div><div id="Sec1" class="Section1 RenderAsSection1"><h2 class="Heading">State Transitions of Activities</h2><div class="Para">As mentioned in <span class="ExternalRef"><a href="A978-1-4842-0100-8_7_Chapter.html"><span class="RefSource">Chapter 7</span></a></span>, the activity is the most important component. Activities have their own state and transition rules, and they are the basis of what you need to understand to write Android applications.</div><div id="Sec2" class="Section2 RenderAsSection2"><h3 class="Heading">Activity States</h3><div class="Para">When activities are created or destroyed, they enter or exit the activity stack. And as they do, they transition among four possible states:<div class="UnorderedList"><ul class="UnorderedListMarkNone"><li><div class="Para">
                    <span class="EmphasisTypeItalic">Active</span>: An activity in the active state is visible when it is on the top of the stack. Typically, it is the foreground activity that is responding to user input. Android will ensure that it executes at all costs. If required, Android will destroy stack activities further down to ensure required resources for the active activity. When another activity becomes active, this activity is paused.</div></li><li><div class="Para">
                    <span class="EmphasisTypeItalic">Paused</span>: In some cases, an activity is visible but does not have focus. At this moment, it is suspended. When the active activity is fully transparent or is the non-full screen activity, the activity below reaches this state. Paused activities are considered active but do not accept user input events. In extreme cases, Android will kill a paused activity to restore resources to the active activity. When an activity is completely invisible, it becomes stopped.</div></li><li><div class="Para">
                    <span class="EmphasisTypeItalic">Stopped</span>: When an activity is not visible, it is stopped. This activity remains in memory to save all state and member information. But when the system needs memory, this activity is “taken out and shot.” When an activity stops, it is very important to save the data and the current UI state. Once the activity exits or is closed, it becomes inactive.</div></li><li><div class="Para">
                    <span class="EmphasisTypeItalic">Inactive</span>: When an activity is killed, it becomes inactive. Inactive activities are removed from the activity stack. When you need to use or display the activity, it needs to be started again.</div></li></ul></div>
            </div><div class="Para">The activity state transition diagram is shown in Figure <span class="InternalRef"><a href="#Fig1">8-1</a></span>.<div class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img src="A978-1-4842-0100-8_8_Fig1_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig1_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-1.</span><div class="SimplePara">Android activity state transition diagram</div></div></div></div>
            </div><div class="Para">State change is not artificial and is controlled entirely by the Android memory manager. Android first closes applications that contain inactive activities, followed by those with stopped activities. In extreme cases, it removes paused activities.</div><div class="Para">To ensure a flawless user experience, transition of these states is invisible to users. When an activity returns to active status from the paused, stopped, or inactive state, the UI must be nondiscriminatory. So, when an activity is stopped, it is very important to save the UI state and data. Once an activity becomes active, it needs to recover the saved values.</div></div><div id="Sec3" class="Section2 RenderAsSection2"><h3 class="Heading">Important Functions of Activities</h3><div class="Para">The activity state transition triggers the function of the corresponding <span class="EmphasisFontCategoryNonProportional">activity</span> class (that is, the Java method). Android calls these functions; developers do not have to explicitly call them. They are called <span class="EmphasisTypeItalic">state-transition functions</span>. You can override the state-transition functions so they can complete their work at the specified time. There are also some functions that are used to control the state of the activity. These functions constitute the basis of activity programming. Let’s learn about those functions.</div><div id="Sec4" class="Section3 RenderAsSection3"><h4 class="Heading">onCreate State-Transition Function</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onCreate</span> function prototype is as follows:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">void  onCreate(Bundle savedInstanceState);</span>
              </div><div class="Para">This function is run when the activity is first loaded. When you start a new program, its main activity’s <span class="EmphasisFontCategoryNonProportional">onCreate</span> event is executed. If the activity is destroyed (<span class="EmphasisFontCategoryNonProportional">OnDestroy</span>, explained later) and then reloaded into the task, its <span class="EmphasisFontCategoryNonProportional">onCreate</span> event participants are re-executed.</div><div class="Para">An activity is likely to be forced to switch to the background. (An activity switched to the background is no longer visible to the user, but it still exists in the middle of a task, such as when a new activity is started to “cover” the current activity; or the user presses the Home button to return to the home screen; or other events occur in the new activity on top of the current activity, such as an incoming caller interface.) If the user does not view the activity again after a period of time, the activity may be automatically destroyed by the system along with the task and process. If you check the activity again, the <span class="EmphasisFontCategoryNonProportional">onCreate</span> event initialization activity will have to be rerun.</div><div class="Para">And sometimes you may want users to continue from the last open operating state of the activity, rather than starting from scratch. For example, when the user receives a sudden incoming call while editing a text message, the user may have to do other things immediately after the call, such as saving the incoming phone number to a contact. If the user does not immediately return to the text-editing interface, the text-editing interface is destroyed. As a result, when the user returns to the SMS program, that user may want to continue from the last edit. In this case, you can override the activity’s void <span class="EmphasisFontCategoryNonProportional">onSaveInstanceState (Bundle outState)</span> events by writing the data you want to be saved before the destruction of the state of activity or information through <span class="EmphasisFontCategoryNonProportional">outState</span>, so that when the activity executes the <span class="EmphasisFontCategoryNonProportional">onCreate</span> event again, it transmits information previously saved through the <span class="EmphasisFontCategoryNonProportional">savedInstanceState</span>. At this point, you can selectively use the information to initialize the activity, instead of starting it from scratch.</div></div><div id="Sec5" class="Section3 RenderAsSection3"><h4 class="Heading">onStart State-Transition Function</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onStart</span> function prototype is as follows:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">void onStart();</span>
              </div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onStart</span> function executes after the <span class="EmphasisFontCategoryNonProportional">onCreate</span> event or when the current activity is switched to the background. When the user switches back to this activity by selecting it from switch panel, if it has not been destroyed, and only the <span class="EmphasisFontCategoryNonProportional">onStop</span> event has been performed, the activity will skip <span class="EmphasisFontCategoryNonProportional">onCreate</span> event activities and directly execute <span class="EmphasisFontCategoryNonProportional">onStart</span> events.</div></div><div id="Sec6" class="Section3 RenderAsSection3"><h4 class="Heading">onResume State-Transition Function</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onResume</span> function prototype is as follows:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">void onResume()</span>
              </div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onResume</span> function is executed after the <span class="EmphasisFontCategoryNonProportional">OnStart</span> event or after the current activity is switched to the background. When the user views this activity again, if it has not been destroyed, and if <span class="EmphasisFontCategoryNonProportional">onStop</span> events have not been performed (activities continue to exist in the task), the activity will skip <span class="EmphasisFontCategoryNonProportional">onCreate</span> and <span class="EmphasisFontCategoryNonProportional">onStart</span> event activities and directly execute <span class="EmphasisFontCategoryNonProportional">onResume</span> events.</div></div><div id="Sec7" class="Section3 RenderAsSection3"><h4 class="Heading">onPause State-Transition Function</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onPause</span> function prototype is as follows:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">void onPause()</span>
              </div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onPause</span> function is executed when the current activity is switched to the background.</div></div><div id="Sec8" class="Section3 RenderAsSection3"><h4 class="Heading">onStop State-Transition Function</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onStop</span> function prototype is as follows:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">void onStop()</span>
              </div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onStop</span> function is executed after the <span class="EmphasisFontCategoryNonProportional">onPause</span> event. If the user does not view the activity again for some time, the <span class="EmphasisFontCategoryNonProportional">onStop</span> event of the activity is executed. The <span class="EmphasisFontCategoryNonProportional">onStop</span> events are also executed if the user presses the Back key, and the activity is removed from the current task list.</div></div><div id="Sec9" class="Section3 RenderAsSection3"><h4 class="Heading">onRestart State-Transition Function</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onRestart</span> function prototype is as follows:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">void onRestart()</span>
              </div><div class="Para">After the <span class="EmphasisFontCategoryNonProportional">onStop</span> event is executed, if the activity and the process it resides in have not been systematically destroyed, or if the user views the activity again, the <span class="EmphasisFontCategoryNonProportional">onRestart</span> event(s) of the activity are executed. The <span class="EmphasisFontCategoryNonProportional">onRestart</span> event skips the <span class="EmphasisFontCategoryNonProportional">onCreate</span> event activities and directly executes the <span class="EmphasisFontCategoryNonProportional">onStart</span> events.</div></div><div id="Sec10" class="Section3 RenderAsSection3"><h4 class="Heading">onDestroy State-Transition Function</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">onDestroy</span> function prototype is as follows:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">void onDestroy()</span>
              </div><div class="Para">After an <span class="EmphasisFontCategoryNonProportional">onStop</span> event of the activity, if the user does not view the activity again, it is destroyed.</div></div><div id="Sec11" class="Section3 RenderAsSection3"><h4 class="Heading">The finish Function</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">finish</span> function prototype is as follows:</div><div class="Para ParaTypeProgramcode">
                <span class="EmphasisFontCategoryNonProportional">void finish()</span>
              </div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">finish</span> function closes the activity and removes it from the stack, which leads to a call to the <span class="EmphasisFontCategoryNonProportional">onDestroy()</span> state-transition function. One way to resolve this is for the user to navigate to the previous activity using the Back button.</div><div class="Para">In addition to the activity switch, the <span class="EmphasisFontCategoryNonProportional">finish</span> function triggers the activity’s state-transition function, and the <span class="EmphasisFontCategoryNonProportional">startActivity</span> and <span class="EmphasisFontCategoryNonProportional">startActivityForResult</span> methods of the context class (described in the next sections) also activate it. Functions such as <span class="EmphasisFontCategoryNonProportional">Context.startActivity</span> also cause the construction of <span class="EmphasisFontCategoryNonProportional">activity</span> objects (that is, create new ones).</div><div class="Para">Typical causes of the triggers and corresponding functions are listed in Table <span class="InternalRef"><a href="#Tab1">8-1</a></span>.<div id="Tab1" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-1.</span><div class="SimplePara">Triggers and Their Functions</div></div></div><table border="1"><colgroup><col/><col/><col/></colgroup><thead><tr class="header"><th><div class="SimplePara">Typical Trigger Cause</div></th><th><div class="SimplePara">Corresponding Method of Activity Executed</div></th><th><div class="SimplePara">Explanations</div></th></tr></thead><tbody><tr class="noclass"><td rowspan="3"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Context.startActivity[ForResult]()</span>
                          </div><div class="SimplePara">Note: As long as the activity is displayed and viewable on the screen, this method will be called.</div></td><td><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">new Activity()</span>
                          </div></td><td> </td></tr><tr class="noclass"><td><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">onCreate()</span>
                          </div></td><td><div class="SimplePara">Completes the constructor function, Saves the <span class="EmphasisFontCategoryNonProportional">activity</span> object to the application object, and initializes the various controls (such as <span class="EmphasisFontCategoryNonProportional">View</span>).</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">onStart()</span>
                          </div></td><td><div class="SimplePara">Similar to <span class="EmphasisFontCategoryNonProportional">View.onDraw()</span>.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Activity.finish()</span>
                          </div></td><td><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">onDestroy()</span>
                          </div></td><td><div class="SimplePara">Completes the constructor function, such as removing the <span class="EmphasisFontCategoryNonProportional">activity</span> object from the application.</div></td></tr></tbody></table></div>
              </div><div class="Para">Functions such as <span class="EmphasisFontCategoryNonProportional">Context.startActivity</span> in Table <span class="InternalRef"><a href="#Tab1">8-1</a></span> trigger three actions: constructing new <span class="EmphasisFontCategoryNonProportional">Activity</span> objects, <span class="EmphasisFontCategoryNonProportional">onCreate</span>, and <span class="EmphasisFontCategoryNonProportional">onStart</span>. When an activity that is moved from off screen places to the top of the screen display (that is, displayed in front of the user), it generally only includes functions being called by <span class="EmphasisFontCategoryNonProportional">onStart</span>.</div></div></div></div><div id="Sec12" class="Section1 RenderAsSection1"><h2 class="Heading">The Context Class</h2><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Context</span> class is an important Android concept to know. The class is inherited from the <span class="EmphasisFontCategoryNonProportional">Object</span> function, whose inheritance is as follows:</div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">java.lang.Object</span>
          </div><div class="Para ParaTypeProgramcode">   ↳ <span class="EmphasisFontCategoryNonProportional">android.content.Context</span>
          </div><div class="Para">The literal meaning of <span class="EmphasisTypeItalic">context</span> is the text in the adjacent area, which is located in the <span class="EmphasisFontCategoryNonProportional">android.content.Context</span> of the framework package. The <span class="EmphasisFontCategoryNonProportional">Context</span> class is a <span class="EmphasisFontCategoryNonProportional">LONG</span> type, similar to the <span class="EmphasisFontCategoryNonProportional">Handle</span> handler in Win32. <span class="EmphasisFontCategoryNonProportional">Context</span> provides the global information interface about the application environment. It is an abstract class, and its execution is provided by the Android system. It allows access to resources and characterized types of applications. At the same time, it can start application-level operations, such as starting activities and broadcasting and receiving intents.</div><div class="Para">Many methods require the caller to be identified through a context instance. For example, the first parameter of <span class="EmphasisFontCategoryNonProportional">Toast</span> is <span class="EmphasisFontCategoryNonProportional">Context</span>; and usually you use <span class="EmphasisFontCategoryNonProportional">this</span> to replace the activity, which indicates that the caller’s instance is an activity. But other methods, such as a button’s <span class="EmphasisFontCategoryNonProportional">onClick</span> (<span class="EmphasisFontCategoryNonProportional">View</span> view), cause errors if you use <span class="EmphasisFontCategoryNonProportional">this</span>. In this case, you may use <span class="EmphasisFontCategoryNonProportional">ActivityName.this</span> to solve the problem, because the class implements the context of several major Android-specific models like activities, services, and broadcast receivers.</div><div class="Para">If the parameter—especially the constructor parameter of the class (such as <span class="EmphasisFontCategoryNonProportional">Dialog</span>)—is the <span class="EmphasisFontCategoryNonProportional">Context</span> type, the actual parameters are typically activity objects, generally <span class="EmphasisFontCategoryNonProportional">[this]</span>. For example, the <span class="EmphasisFontCategoryNonProportional">Dialog</span> constructor prototype is</div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">Dialog.Dialog(Context context)</span>
          </div><div class="Para">Here’s an example:</div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">public class MyActivity extends Activity{</span>
          </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">Dialog d = new Dialog(this);</span>
          </div><div class="Para">
            <span class="EmphasisFontCategoryNonProportional">Context</span> is the ancestor of most classes of Android, such as broadcasting, intents, and so on, and it provides the interface of the global information application environment. Table <span class="InternalRef"><a href="#Tab2">8-2</a></span> lists the important subclasses of <span class="EmphasisFontCategoryNonProportional">Context</span>. You can find a detailed description in the help documentation for the Android <span class="EmphasisFontCategoryNonProportional">Context</span> class.<div id="Tab2" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-2.</span><div class="SimplePara">Important Subclasses of</div></div></div><table border="1"><colgroup><col/><col/></colgroup><thead><tr class="header"><th><div class="SimplePara">Subclass</div></th><th><div class="SimplePara">Explanation</div></th></tr></thead><tbody><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">Activity</span>
                      </div></td><td><div class="SimplePara">User-friendly interface class</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">Application</span>
                      </div></td><td><div class="SimplePara">Base class that provides global application state maintenance</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">IntentService</span>
                      </div></td><td><div class="SimplePara">Base class used to handle asynchronous requests for the service (expressed in an <span class="EmphasisFontCategoryNonProportional">Intent</span> way)</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">Service</span>
                      </div></td><td><div class="SimplePara">A component of the application that represents either a time-consuming operation that has no interaction with the user or a task that provides functionality for other application tasks</div></td></tr></tbody></table></div>
          </div><div class="Para">Classes are called <span class="EmphasisTypeItalic">offspring classes</span> because they are direct or indirect subclasses of <span class="EmphasisFontCategoryNonProportional">Context</span> and have an inheritance relationship like activities:</div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">java.lang.Object</span>
          </div><div class="Para ParaTypeProgramcode">   <span class="EmphasisFontCategoryNonProportional">↳ android.content.Context</span>
          </div><div class="Para ParaTypeProgramcode">     <span class="EmphasisFontCategoryNonProportional">↳ android.content.ContextWrapper</span>
          </div><div class="Para ParaTypeProgramcode">       <span class="EmphasisFontCategoryNonProportional">↳ android.view.ContextThemeWrapper</span>
          </div><div class="Para ParaTypeProgramcode">         <span class="EmphasisFontCategoryNonProportional">↳ android.app.Activity</span>
          </div><div class="Para">
            <span class="EmphasisFontCategoryNonProportional">Context</span> can be used for many operations in Android, but it main function is to load and access resources. There are two commonly used contexts: the application context and the activity context. The activity context is usually passed between a variety of classes and methods, similar to the code of <span class="EmphasisFontCategoryNonProportional">onCreate</span> for an activity, as follows:</div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">protected void onCreate(Bundle state) {</span>
          </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">super.onCreate(state);</span>
          </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">TextView label = new TextView(this); // Pass context to view control</span></span>
          </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">setContentView(label);</span></span>
          </div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">}</span>
          </div><div class="Para">When the activity context is passed to the view, it means that view has a reference pointed to an activity and references resources taken by the activity: view hierarchy, resource, and so on.</div><div class="Para">You can also use the application context, which always accompanies the application’s life but has nothing to do with the activity life cycle. The application context can be acquired with the <span class="EmphasisFontCategoryNonProportional">Context.getApplicationContext</span> or <span class="EmphasisFontCategoryNonProportional">Activity.getApplication</span> method.</div><div class="Para">Java usually uses a static variable (singleton and the like) to synchronize states between activities (between classes inside a program). Android’s more reliable approach is to use the application context to associate these states.</div><div class="Para">Each activity has a context, which contains the runtime state. Similarly, an application has a context that Android uses to ensure that it is the only instance of that context.</div><div class="Para">If you need to make a custom application context, first you must define a custom class that inherits from <span class="EmphasisFontCategoryNonProportional">android.app.Application</span>; then describe the class in the application’s <span class="EmphasisFontCategoryNonProportional">AndroidManifest.xml</span> file. Android automatically creates an instance of this class. By using the <span class="EmphasisFontCategoryNonProportional">Context.getApplicationContext()</span> method, you can get the application context inside each activity. The following example code gets the application context in the activity:</div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">class MyApp extends Application {</span></span>
          </div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// MyApp is a custom class inherited from android.app.Application</span></span>
          </div><div class="Para ParaTypeProgramcode">   <span class="EmphasisFontCategoryNonProportional">public String aCertainFunc () {</span>
          </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">......</span>
          </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">}</span>
          </div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">}</span>
          </div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">class Blah extends Activity {</span>
          </div><div class="Para ParaTypeProgramcode">      <span class="EmphasisFontCategoryNonProportional">public void onCreate(Bundle b){</span>
          </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">... ...</span>
          </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">MyApp appState = ((MyApp)getApplicationContext());</span></span>
          </div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Get Application Context</span></span>
          </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">appState.aCertainFunc();</span>
          </div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">//Use properties and methods of the application</span>
          </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">... ...</span>
          </div><div class="Para ParaTypeProgramcode">      <span class="EmphasisFontCategoryNonProportional">}</span>
          </div><div class="Para ParaTypeProgramcode">
            <span class="EmphasisFontCategoryNonProportional">}</span>
          </div><div class="Para">You can get global information about the application environment using the <span class="EmphasisFontCategoryNonProportional">get</span> function of <span class="EmphasisFontCategoryNonProportional">Context</span>. The main functions are shown in Table <span class="InternalRef"><a href="#Tab3">8-3</a></span> and are either <span class="EmphasisFontCategoryNonProportional">ContextWrapper</span> or direct context methods.<div id="Tab3" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-3.</span><div class="SimplePara">Commonly Used Methods for Obtaining Context</div></div></div><table border="1"><colgroup><col/><col/></colgroup><thead><tr class="header"><th><div class="SimplePara">Function Prototype</div></th><th><div class="SimplePara">Function</div></th></tr></thead><tbody><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">abstract Context ContextWrapper.getApplicationContext ()</span>
                      </div></td><td><div class="SimplePara">Returns the current process corresponding to the global context of a single application.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">abstract ApplicationInfo ContextWrapper.getApplicationInfo ()</span>
                      </div></td><td><div class="SimplePara">Returns the context package corresponding to the information of the entire application.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">abstract ContentResolver ContextWrapper.getContentResolver ()</span>
                      </div></td><td><div class="SimplePara">Returns the content-resolver instance of the corresponding application package.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">abstract PackageManager ContextWrapper.getPackageManager ()</span>
                      </div></td><td><div class="SimplePara">Returns the package-manager instance for finding all package information.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">abstract String ContextWrapper.getPackageName ()</span>
                      </div></td><td><div class="SimplePara">Returns the current package name.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">abstract Resources ContextWrapper.getResources ()</span>
                      </div></td><td><div class="SimplePara">Returns the resource instance of the (user) application package.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">abstract SharedPreferences ContextWrapper.getSharedPreferences (String name, int mode)</span>
                      </div></td><td><div class="SimplePara">Finds and holds the contents of the preference file whose name is specified by the parameter name. Returns the value of the shared preferences (<span class="EmphasisFontCategoryNonProportional">SharedPreferences</span>) that you can find and modify. When using a proper name, only one instance of <span class="EmphasisFontCategoryNonProportional">SharedPreferences</span> is returned to the caller, which means once the changes are complete, the results are shared with each other.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">public final String Context.getString (int resId)</span>
                      </div></td><td><div class="SimplePara">Returns a localized string from the application package’s default string table.</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">abstract Object ContextWrapper.getSystemService (String name)</span>
                      </div></td><td><div class="SimplePara">Returns processing system-level services according to the name specified by the variable name. The returned object classes vary based on the name of the request.</div></td></tr></tbody></table></div>
          </div></div><div id="Sec13" class="Section1 RenderAsSection1"><h2 class="Heading">Introduction to Intent</h2><div class="Para">
            <span class="EmphasisTypeItalic">Intent</span> can be used as a message-passing mechanism to allow you to declare intent to take an action, usually with specific data. You can use intent to implement interaction between components of any application on Android devices. Intent turns a group of independent components into systems with one-to-one interactions.</div><div class="Para">It can also be used to broadcast messages. Any application can register a broadcast receiver to listen and respond to these intent broadcasts. Intent can be used to create internal, system, or third-party event-driven applications.</div><div class="Para">Intent is responsible for the description of an operation and the action data of the application. Android is responsible for finding the corresponding component described under the sub-intent, passing intent to the component being called, and completing the component calls. Intent plays the decoupling role between the caller and the one who is called.</div><div class="Para">Intent is a mechanism of runtime binding; it can connect two different components in the process of running the program. Through intent, the program can request or express willingness to Android; Android selects the appropriate components to handle the request based on the contents of the intent. For example, suppose an activity wants to open a web browser to view the content of a page; this activity only needs to issue a <span class="EmphasisFontCategoryNonProportional">WEB_SEARCH_ACTION</span> request to Android. Based on the content request, Android will check the intent filter declared in the component registration statement and find an activity for a web browser.</div><div class="Para">When an intent is issued, Android finds one or more exact matches for the activity, service, or <span class="EmphasisFontCategoryNonProportional">broadcastReceiver</span> as a response. Therefore, different types of intent messages do not overlap and are not simultaneously sent to an activity or service, because <span class="EmphasisFontCategoryNonProportional">startActivity()</span> messages can be sent only to an activity and <span class="EmphasisFontCategoryNonProportional">startService()</span> intents can only be sent to a service.</div><div id="Sec14" class="Section2 RenderAsSection2"><h3 class="Heading">The Main Roles of Intent</h3><div class="Para">The main roles of intent are as follows.</div><div id="Sec15" class="Section3 RenderAsSection3"><h4 class="Heading">Triggering a New Activity or Letting an Existing Activity Implement the New Operation</h4><div class="Para">In Android, intent directly interacts with the activity. The most common use of intent is to bind application components. Intent is used to start, stop, and transfer application activities. In other words, intent can activate a new activity or make an existing activity perform a new operation. This can be accomplished by calling the <span class="EmphasisFontCategoryNonProportional">Context.startActivity()</span> or <span class="EmphasisFontCategoryNonProportional">Context.startActivityForResult()</span> method.</div><div class="Para">To open a different interface (corresponding to an activity) in an application, you call the <span class="EmphasisFontCategoryNonProportional">Context.startActivity()</span> function to pass an intent. Intent can either explicitly specify a specific class to open or include an action required to achieve the goals. In the latter case, the runtime will choose which activity to open, using a well-known process of intent resolution in which the <span class="EmphasisFontCategoryNonProportional">Context.startActivity()</span> finds and starts a single activity that best matches the intent.</div></div><div id="Sec16" class="Section3 RenderAsSection3"><h4 class="Heading">Triggering a New Service or Sending New Requests to Existing Services</h4><div class="Para">Opening a service or sending a request to an existing service is also completed by the intent class.</div></div><div id="Sec17" class="Section3 RenderAsSection3"><h4 class="Heading">Trigger BroadcastReceiver</h4><div class="Para">You can send <span class="EmphasisFontCategoryNonProportional">BroadcastIntent</span> using three different methods: <span class="EmphasisFontCategoryNonProportional">Context.sendBroadcast()</span>, <span class="EmphasisFontCategoryNonProportional">Context.sendOrderedBroadcast()</span>, and <span class="EmphasisFontCategoryNonProportional">Context.sendStickyBroadcast()</span>.</div></div></div><div id="Sec18" class="Section2 RenderAsSection2"><h3 class="Heading">Intent Resolution</h3><div class="Para">The intent transfer process has two ways to match target consumers (such as another activity, <span class="EmphasisFontCategoryNonProportional">IntentReceiver</span>, or service) with the respondents of the intent.</div><div class="Para">The first is <span class="EmphasisTypeItalic">explicit matching</span>, also known as <span class="EmphasisTypeItalic">direct intent</span>. When constructing an <span class="EmphasisFontCategoryNonProportional">intent</span> object, you must specify the recipient as one of the intent’s component properties (by calling <span class="EmphasisFontCategoryNonProportional">setComponent (ComponentName)</span> or <span class="EmphasisFontCategoryNonProportional">setClass (Context, Class)</span>). By specifying a component class, the application notification starts the corresponding components. This method is similar to an ordinary function call but varies in the reuse of the granularity.</div><div class="Para">The second is <span class="EmphasisTypeItalic">implicit matching</span>, also known as <span class="EmphasisTypeItalic">indirect intent</span>. The sender of the intent does not know or care who the recipient is when constructing an <span class="EmphasisFontCategoryNonProportional">intent</span> object. The attribute is not specified in the component intent. This intent needs to contain sufficient information so that the system can determine which components to use out of all those available to meet this intent. This method differs significantly from function calls and helps to reduce coupling between the sender and receiver. Implicit matching resolves to a single activity. If there are multiple activities that can implement a given action based on particular data, Android selects the best one to start.</div><div class="Para">For direct intent, Android does not need to do parsing because the target component is very clear. However, Android needs to resolve indirect intent. Through analysis, it maps the indirect intent to the activity, <span class="EmphasisFontCategoryNonProportional">IntentReceiver</span>, or service that processes the intent.</div><div class="Para">The mechanism of intent resolution mainly consists of the following:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">Looking for all <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span>s and the intent defined by those filters, which are registered in <span class="EmphasisFontCategoryNonProportional">AndroidManifest.xml</span>
                  </div></li><li><div class="Para">Finding and handling the component of the intent through <span class="EmphasisFontCategoryNonProportional">PackageManager</span> (<span class="EmphasisFontCategoryNonProportional">PackageManager</span> can get information about the application package installed on the current device)</div></li></ul></div>
            </div><div class="Para">Intent filters are very important. A non-declared <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> component can only respond to explicit intent requests that the component name matches, but it cannot respond to implicit intent requests. A declared <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> component can respond to either explicit intent or implicit intent requests. When resolving implicit intent requests, Android uses three attributes of the intent—action, type, and category—to make the resolution. The specific resolution methods are described next.</div><div id="Sec19" class="Section3 RenderAsSection3"><h4 class="Heading">Action Test</h4><div class="Para">A <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> element should contain at least one <span class="EmphasisFontCategoryNonProportional">&lt;action&gt;</span>, or no intent requests can be matched to the <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span>. If the action requested by an intent has at least one match of an <span class="EmphasisFontCategoryNonProportional">&lt;action&gt;</span> in <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span>, then the intent passed the action test of this <span class="EmphasisFontCategoryNonProportional">&lt;</span>.</div><div class="Para">If there is no description of a specific action type in the intent request or <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span>, then one of the two following tests applies:
<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">If <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> does not contain any action type, regardless of what the intent requests are, there is no match to this <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span>.</div></li><li><div class="Para">If the intent request has no set action type, as long as the <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> contains an action type, this intent request will successfully pass the action test of <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span>.</div></li></ul></div>
              </div></div><div id="Sec20" class="Section3 RenderAsSection3"><h4 class="Heading">Category Test</h4><div class="Para">For an intent to pass the category test, every category in the Intent must match a category in the filter. When every category of intent requests have exact matches with the <span class="EmphasisFontCategoryNonProportional">&lt;category&gt;</span> of one <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> of the components the intent request pass the test. The excess <span class="EmphasisFontCategoryNonProportional">&lt;category&gt;</span> declaration of <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> does not cause the match failure. Any <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> that does not specify a category test only matches intent requests that the configuration is not set for.</div></div><div id="Sec21" class="Section3 RenderAsSection3"><h4 class="Heading">Data Test</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">&lt;data&gt;</span> element specifies a data URI and data type of the intent request that you want to receive. A URI is divided into three parts that match: scheme, authority, and path. The URI data type and scheme of the Internet request set by <span class="EmphasisFontCategoryNonProportional">setData()</span> must be the same as specified in <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span>. If <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> also specifies authority or path, they have to match to pass the test.</div><div class="Para">This decision process can be expressed as follows:
<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">If the intent specifies the action, then the action list of the <span class="EmphasisFontCategoryNonProportional">&lt;intent-filter&gt;</span> of the target component must contain this action. Otherwise, it is not considered matched.</div></li><li><div class="Para">If the intent does not provide a type, the system gets the data types from the data. And for some action methods, the target component’s data-type list must contain the data type of the intent. Otherwise it cannot be matched.</div></li><li><div class="Para">If the data for the intent is not the URI of the content, and the category and intent also do not specify its type, the matching is based on the data scheme of the intent (for instance, <span class="EmphasisFontCategoryNonProportional">http:</span> or <span class="EmphasisFontCategoryNonProportional">mailto:</span>), and the intent’s scheme must appear in the scheme list of the target component.</div></li><li><div class="Para">If the intent specifies one or more categories, these categories must all appear in the category list of the component. For instance, if the intent contains two categories, <span class="EmphasisFontCategoryNonProportional">LAUNCHER_CATEGORY</span> and <span class="EmphasisFontCategoryNonProportional">ALTERNATIVE_CATEGORY</span>, the target component obtained by the parsing must contain at least these two categories.</div></li></ul></div>
              </div></div></div></div><div id="Sec22" class="Section1 RenderAsSection1"><h2 class="Heading">The Relationship between Applications and Activities</h2><div class="Para">Beginners tend to get confused between applications and activities—in particular, the main activities (those that occur when the application starts). In fact, they are two completely different objects. The behaviors, attributes, and so forth are not the same. Following is a list of differences between applications and activities:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">No matter how many times an application starts, as long as it is not shut down, its value (that is, the object) is constant. It has only one instance.</div></li><li><div class="Para">No matter where an application starts, as long as it is not closed, its value (that is, the object) is constant. It has only one instance.</div></li><li><div class="Para">When an activity is not finished, its value (that is, the object) is constant. Each time <span class="EmphasisFontCategoryNonProportional">onStart()</span> is called, the activity displays on the screen front.</div></li><li><div class="Para">The objects that <span class="EmphasisFontCategoryNonProportional">startActivity</span> starts are different each time. You can say that <span class="EmphasisFontCategoryNonProportional">startActivity</span> actually contains new objects.
<div class="UnorderedList"><ul class="UnorderedListMarkNone"><li><div class="Para">Although you cannot get a new activity object after <span class="EmphasisFontCategoryNonProportional">startActivity</span>, the Android framework can send parameter values (similar to the actual parameter of the function call) when <span class="EmphasisFontCategoryNonProportional">startActivity</span> starts its corresponding activity objects.</div></li><li><div class="Para">Even more surprising is that Android can have an activity coexist in multiple objects. When an activity is closed, Android returns the results to the main activity started through <span class="EmphasisFontCategoryNonProportional">startActivity</span>. As a result, it automatically calls the <span class="EmphasisFontCategoryNonProportional">onActivityResult()</span> method that starts its activity object, and random distribution can be avoided.</div></li></ul></div>
                </div></li><li><div class="Para">An application can have multiple objects of an activity.</div></li></ul></div>
          </div></div><div id="Sec23" class="Section1 RenderAsSection1"><h2 class="Heading">The Basic Android Application Interface</h2><div class="Para">In this section, you use an example to learn about Android development using the Android SDK integrated in the Eclipse IDE. You create an application named GuiExam using the Android SDK and learn about the Android interface design by following the steps of the process.</div><div id="Sec24" class="Section2 RenderAsSection2"><h3 class="Heading">GuiExam Application Code Analysis</h3><div class="Para">This section provides analysis of the GuiExam sample application. First, let’s create the GuiExam application using the Android SDK in Eclipse. For the application name, type <span class="EmphasisFontCategoryNonProportional">GuiExam</span>. For the Build SDK, choose API 19, which includes the x86 instructions. As shown in Figure <span class="InternalRef"><a href="#Fig2">8-2</a></span>, select the system default configurations for all other entries.<div class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img src="A978-1-4842-0100-8_8_Fig2_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig2_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-2.</span><div class="SimplePara">Initial setup when generating the GuiExam project</div></div></div></div>
            </div><div class="Para">The file structure of the project is shown in Figure <span class="InternalRef"><a href="#Fig3">8-3</a></span>, and the user interface is shown in Figure <span class="InternalRef"><a href="#Fig4">8-4</a></span>.<div class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img src="A978-1-4842-0100-8_8_Fig3_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig3_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-3.</span><div class="SimplePara">File structure of the GuiExam application</div></div></div></div>
              <div class="Figure" id="Fig4"><div class="MediaObject" id="MO4"><img src="A978-1-4842-0100-8_8_Fig4_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig4_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-4.</span><div class="SimplePara">The application interface of GuiExam</div></div></div></div>
            </div><div class="Para">The source code of the application’s only Java file (<span class="EmphasisFontCategoryNonProportional">MainActivity.java</span>) is shown in Figure <span class="InternalRef"><a href="#Fig5">8-5</a></span>:<div class="Figure" id="Fig5"><div class="MediaObject" id="MO5"><img src="A978-1-4842-0100-8_8_Fig5_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig5_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-5.</span><div class="SimplePara">The typical source codes in Java file MainActivity.java</div></div></div></div>
            </div><div class="Para">You know the <span class="EmphasisFontCategoryNonProportional">MainActivity.OnCreate()</span> function is called when the event is created. The source code of the function is very simple. The superclass function is called in line 12, and the <span class="EmphasisFontCategoryNonProportional">setContentView</span> function is called in line 13. This function sets the UI display of the activity. In the Android project, most of the UI is realized by the view and view subclasses. <span class="EmphasisFontCategoryNonProportional">View</span> represents a region that can handle the event and can also render this region.</div><div class="Para">The code in line 13 indicates that the view is <span class="EmphasisFontCategoryNonProportional">R.layout.activity_main</span>. The auto-generated <span class="EmphasisFontCategoryNonProportional">R.Java</span> file under the <span class="EmphasisFontCategoryNonProportional">gen</span> directory of the project includes code such as this (excerpted):</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">Line #    Source Code</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">......</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">8 package com.example.guiexam;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">9</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">10 public final class R {</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">......</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">26     public static final class layout {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">27         public static final int activity_main=0x7f030000;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">28     }</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">29     public static final class id {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">30         public static final int menu_settings=0x7f080000;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">31     }</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">32     public static final class string {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">33         public static final int app_name=0x7f050000;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">34         public static final int hello_world=0x7f050001;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">35         public static final int menu_settings=0x7f050002;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">36         public static final int title_activity_main=0x7f050003;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">37    }</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">......</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">41    }</span>
            </div><div class="Para">You can see that <span class="EmphasisFontCategoryNonProportional">R.layout.activity_main</span> is the resource ID of the main layout file <span class="EmphasisFontCategoryNonProportional">activity_main.xml</span>. This file reads as follows:</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">Line#    Source Code</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">1 &lt;RelativeLayout xmlns:android="</span>
              <span class="ExternalRef"><a href="http://schemas.android.com/apk/res/android"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional">http://schemas.android.com/apk/res/android</span>
                </span></a></span>
              <span class="EmphasisFontCategoryNonProportional">"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">2     xmlns:tools="</span>
              <span class="ExternalRef"><a href="http://schemas.android.com/tools"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional">http://schemas.android.com/tools</span>
                </span></a></span>
              <span class="EmphasisFontCategoryNonProportional">"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">3     android:layout_width="match_parent"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">4     android:layout_height="match_parent" &gt;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">5</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">6     &lt;TextView</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">7         android:layout_width="wrap_content"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">8         android:layout_height="wrap_content"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">9         android:layout_centerHorizontal="true"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">10         android:layout_centerVertical="true"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">11         android:padding="@dimen/padding_medium"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">12         android:text="@string/hello_world"</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">13         tools:context=".MainActivity" /&gt;14</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">15 &lt;/RelativeLayout&gt;</span>
            </div><div class="Para">The first line of this code indicates that the content is a <span class="EmphasisFontCategoryNonProportional">RelativeLayout</span> class. By checking the Android help documentation, you can see that the inheritance relationship of <span class="EmphasisFontCategoryNonProportional">RelativeLayout</span> is</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">java.lang.Object</span>
            </div><div class="Para ParaTypeProgramcode">   <span class="EmphasisFontCategoryNonProportional">↳ android.view.View</span>
            </div><div class="Para ParaTypeProgramcode">     <span class="EmphasisFontCategoryNonProportional">↳ android.view.ViewGroup</span>
            </div><div class="Para ParaTypeProgramcode">       <span class="EmphasisFontCategoryNonProportional">↳ android.widget.RelativeLayout</span>
            </div><div class="Para">This class is indeed seen as a view class. This layout contains a <span class="EmphasisFontCategoryNonProportional">TextView</span> class, which is also the offspring class of the view. Line 12 indicates that its <span class="EmphasisFontCategoryNonProportional">text</span> property is <span class="EmphasisFontCategoryNonProportional">@string/hello_world</span> and its display text is the contents of the variable <span class="EmphasisFontCategoryNonProportional">hello_world</span> in <span class="EmphasisFontCategoryNonProportional">strings.xml</span>: “Hello world!”</div><div class="Para">As a superclass of the layout, <span class="EmphasisFontCategoryNonProportional">ViewGroup</span> is a special view that can contain other view objects or even <span class="EmphasisFontCategoryNonProportional">ViewGroup</span> itself. In other words, the <span class="EmphasisFontCategoryNonProportional">ViewGroup</span> object treats the objects of other views or <span class="EmphasisFontCategoryNonProportional">ViewGroup</span>s as member variables (called <span class="EmphasisTypeItalic">properties</span> in Java). The internal view objects contained in <span class="EmphasisFontCategoryNonProportional">ViewGroup</span> objects are called <span class="EmphasisTypeItalic">widgets</span>. Because of the particularity of the <span class="EmphasisFontCategoryNonProportional">ViewGroup</span>, Android makes it possible for a variety of complex interfaces for applications to be automatically set.</div></div><div id="Sec25" class="Section2 RenderAsSection2"><h3 class="Heading">Using Layouts as Interfaces</h3><div class="Para">You can modify or design layouts as part of the application interface design. For example, you can modify the <span class="EmphasisFontCategoryNonProportional">activity_main.xml</span> file as follows:<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><div class="Para">Change <span class="EmphasisFontCategoryNonProportional">TextView</span>’s <span class="EmphasisFontCategoryNonProportional">Text</span> property to “Type Here”.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><div class="Para">Pick a button widget from the Form Widgets column, and drop it into the <span class="EmphasisFontCategoryNonProportional">activity_main</span> screen. Set its <span class="EmphasisFontCategoryNonProportional">Text</span> property to “Click Me”, as shown in Figure <span class="InternalRef"><a href="#Fig6">8-6</a></span>.</div></div><div class="ClearBoth"> </div></div></div>
              <div class="Figure" id="Fig6"><div class="MediaObject" id="MO6"><img src="A978-1-4842-0100-8_8_Fig6_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig6_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-6.</span><div class="SimplePara">Modifying the GuiExam layout to add a button</div></div></div></div>
              <div class="OrderedList"><div class="ListItem"><span class="ItemNumber">3.</span><div class="ItemContent"><div class="Para">Drag a plain text widget from the Text Fields section of the left column and drop it into the <span class="EmphasisFontCategoryNonProportional">activity_main</span> screen. Change the <span class="EmphasisFontCategoryNonProportional">Width</span> property under the layout parameters branch to <span class="EmphasisFontCategoryNonProportional">fill_parent</span>, and then drag plain text until it fills the entire layout, as shown in Figure <span class="InternalRef"><a href="#Fig7">8-7</a></span>.</div></div><div class="ClearBoth"> </div></div></div>
              <div class="Figure" id="Fig7"><div class="MediaObject" id="MO7"><img src="A978-1-4842-0100-8_8_Fig7_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig7_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-7.</span><div class="SimplePara">Modifying the GuiExam layout to add a text-edit widget</div></div></div></div>
              <div class="Figure" id="Fig8"><div class="MediaObject" id="MO8"><img src="A978-1-4842-0100-8_8_Fig8_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig8_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-8.</span><div class="SimplePara">The user interface of GuiExam after the layout has been modified</div></div></div></div>
            </div><div class="Para">From these examples, you can see the general structure of the interface. The activity set through <span class="EmphasisFontCategoryNonProportional">setContentView</span> (layout file resource ID) is: the activity contains a layout, and the layout contains various widgets, as shown in Figure <span class="InternalRef"><a href="#Fig9">8-9</a></span>.<div class="Figure" id="Fig9"><div class="MediaObject" id="MO9"><img src="A978-1-4842-0100-8_8_Fig9_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig9_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-9.</span><div class="SimplePara">Interface structure of the activity</div></div></div></div>
            </div><div class="Para">You may be wondering why Android introduced this layout concept. In fact, this is a developer-favored feature of Android, compared to the programming interface of Windows Microsoft Foundation Class (MFC). The layout isolates differences in screen size, orientation, and other details on the device, which makes the interface screen adaptive to a variety of devices. So, applications running on different device platforms can automatically adjust the size and position of the widget without the need for user intervention or code modification.</div><div class="Para">For example, the application you created can run on different Android phones, tablets, and television device platforms without your needing to change any code. The location and size of the widget are automatically adjusted. Even when you rotate a phone 90 degrees, the interface for portrait or landscape mode is automatically resized and maintained in its relative position. The layout also allows widgets to be arranged according to local national habits (most countries arrange them from left to right, but some countries arrange them from right to left). The details that need to be considered for the interface design are all completed by the layout. You can imagine what would happen if there were no layout classes—you would have to write code for each Android interface layout for each device. The complexity of this level of work is unthinkable.</div></div><div id="Sec26" class="Section2 RenderAsSection2"><h3 class="Heading">Using the View Directly as an Interface</h3><div class="Para">Earlier you saw an interface structure and code framework for activities. You also saw that most of the UI is implemented by the view and view subclasses. So, you can use the <span class="EmphasisFontCategoryNonProportional">setContentView</span> function to specify a view object, instead of a layout. The prototype of the <span class="EmphasisFontCategoryNonProportional">setContentView</span> function of the activity class includes the following.</div><div class="Para">This function sets a layout resource as the interface of the activity:</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">void setContentView(int layoutResID)</span>
            </div><div class="Para">The first type of the function sets an explicit view as the interface of the activity:</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">void setContentView(View view)</span>
            </div><div class="Para">The 2<sup>nd</sup> type f the function sets an explicit view as the interface of the activity, according to the specified format:</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">setContentView(View view, ViewGroup.LayoutParams params)</span>
            </div><div class="Para">Here you work through an application example that uses the view directly as an activity interface, using the second function setContentView()You can modify the code of the <span class="EmphasisFontCategoryNonProportional">MainActivity.java</span> file as follows:</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">......</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.widget.TextView;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">public class MainActivity extends Activity {</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">@Override</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">public void onCreate(Bundle savedInstanceState) {</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">super.onCreate(savedInstanceState);</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">TextView tv = new TextView(this);  // Create a TextView Object that belongs to current Activity</span></span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">tv.setText("Hello My friends!");   // Set Display text of TextView</span></span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">setContentView(tv);                // Set View as the main display of the Activity</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">}</span>
            </div><div class="Para">The application interface is shown in Figure <span class="InternalRef"><a href="#Fig10">8-10</a></span>.<div class="Figure" id="Fig10"><div class="MediaObject" id="MO10"><img src="A978-1-4842-0100-8_8_Fig10_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig10_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-10.</span><div class="SimplePara">GuiExam sets the view directly as the interface</div></div></div></div>
            </div><div class="Para">In this case you have <span class="EmphasisFontCategoryNonProportional">TextView</span> widgets, which are direct descendant classes of the view, as the application interface; they are set directly in the <span class="EmphasisFontCategoryNonProportional">setContentView</span> function. This way, the text displayed by the <span class="EmphasisFontCategoryNonProportional">TextView</span> becomes the output of the application interface. To use the <span class="EmphasisFontCategoryNonProportional">TextView</span> class, you use an <span class="EmphasisFontCategoryNonProportional">import android.widget.TextView</span> statement at the beginning of the file to import the package of the class.</div></div><div id="Sec27" class="Section2 RenderAsSection2"><h3 class="Heading">Component ID</h3><div class="Para">Now let’s go back and look at the application layout shown in Figure <span class="InternalRef"><a href="#Fig6">8-6</a></span>. The ID attribute of the added text-edit widget in the layout is <span class="EmphasisFontCategoryNonProportional">@ + id/editText1</span>, and the button’s ID property is <span class="EmphasisFontCategoryNonProportional">@ + id/button1</span> (as shown in Figure <span class="InternalRef"><a href="#Fig5">8-5</a></span>). What does that mean?</div><div class="Para">Let’s look at the <span class="EmphasisFontCategoryNonProportional">R.java</span> file (excerpted):</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">Line #    Source Code</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">......</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">8 package com.example.guiexam;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">9</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">10 public final class R {</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">......</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">22     public static final class id {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">23</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">public static final int button1=0x7f080001;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">24</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">public static final int editText1=0x7f080002;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">25         public static final int menu_settings=0x7f080003;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">26         public static final int textView1=0x7f080000;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">27     }</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">28     public static final class layout {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">29         public static final int activity_main=0x7f030000;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">30     }</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">......</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">43 }</span>
            </div><div class="Para">Compared with the <span class="EmphasisFontCategoryNonProportional">R.java</span> file in the “GuiExam Application” section, you can see that lines 23 and 24 are new; they are the resource ID number of the newly added button and text-edit box. The type is <span class="EmphasisFontCategoryNonProportional">int</span>, which corresponds to the ID attribute values of these widgets. From the <span class="EmphasisFontCategoryNonProportional">R.java</span> file, you can find the ID of these widgets—the static constant <span class="EmphasisFontCategoryNonProportional">R.id.button1</span> is the resource ID of the widgets (buttons) for which the ID attribute value is <span class="EmphasisFontCategoryNonProportional">@ + id/button1</span>, and the static constant <span class="EmphasisFontCategoryNonProportional">R.id.editText1</span> is the resource ID of the widgets (text edit) for which the ID attribute value is <span class="EmphasisFontCategoryNonProportional">@ + id/editText1</span>. What’s the reason for this? Let’s see.</div><div class="Para">Android components (including widgets and activities) need to use a value of type <span class="EmphasisFontCategoryNonProportional">int</span> as a tag This value is the ID attribute value of the component tag. The ID attribute can only accept a value of <span class="EmphasisFontCategoryNonProportional">resources</span> type. That is, the value must start with <span class="EmphasisFontCategoryNonProportional">@</span>, ; for example, <span class="EmphasisFontCategoryNonProportional">@ id/abc</span>, <span class="EmphasisFontCategoryNonProportional">@+id/xyz</span>, and so on.</div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">@</span> symbol is used to prompt the parser for XML files to parse the name behind the <span class="EmphasisFontCategoryNonProportional">@</span>. For example, for <span class="EmphasisFontCategoryNonProportional">@string/button1</span>, the parser reads the <span class="EmphasisFontCategoryNonProportional">button1</span> value of this variable from <span class="EmphasisFontCategoryNonProportional">values/string.xml</span>.</div><div class="Para">If the <span class="EmphasisFontCategoryNonProportional">+</span> symbol is used right after the <span class="EmphasisFontCategoryNonProportional">@</span>, it means that when you modify and save a layout file, the system will automatically generate the corresponding type <span class="EmphasisFontCategoryNonProportional">int</span> variables in <span class="EmphasisFontCategoryNonProportional">R.java</span>. The variable name is the value after the <span class="EmphasisFontCategoryNonProportional">/</span> symbol; for example, <span class="EmphasisFontCategoryNonProportional">@+id/xyz</span> generates <span class="EmphasisFontCategoryNonProportional">int xyz = value</span> in <span class="EmphasisFontCategoryNonProportional">R.java</span>, where the value is a hexadecimal number. If the same variable name <span class="EmphasisFontCategoryNonProportional">xyz</span> already exists in <span class="EmphasisFontCategoryNonProportional">R.java</span>, the system does not generate a new variable; instead, the component uses this existing variable.</div><div class="Para">In other words, if you use the <span class="EmphasisFontCategoryNonProportional">@+id/name</span> format and a variable named <span class="EmphasisFontCategoryNonProportional">name</span> exists in <span class="EmphasisFontCategoryNonProportional">R.java</span>, the component will use the value of the variable as an identifier. If the variable does not exist, the system adds a new variable, and the corresponding value for the variable is assigned (not repeated).</div><div class="Para">Because the component’s ID attribute can be a resource ID, you can set any existing resource ID value: for example, <span class="EmphasisFontCategoryNonProportional">@drawable/icon</span>, <span class="EmphasisFontCategoryNonProportional">@string/ok</span>, or <span class="EmphasisFontCategoryNonProportional">@+string/</span>. Of course, you can also set a resource ID that already exists in the Android system, such as <span class="EmphasisFontCategoryNonProportional">@id/android:list</span>, in which the <span class="EmphasisFontCategoryNonProportional">android:</span> modifier in the ID indicates the package where the R class of the system is located (in the <span class="EmphasisFontCategoryNonProportional">R.java</span> file). You can enter <span class="EmphasisFontCategoryNonProportional">android.R.id</span> in the Java code-editing zone, which lists the corresponding resource ID. For example, you can set the ID property value this way.</div><div class="Para">For the reason just described, you generally set the ID attributes of Android components (including widgets, activities, and so on) to the <span class="EmphasisFontCategoryNonProportional">@+id/XXX</span> format. And you use <span class="EmphasisFontCategoryNonProportional">R.id.XXX</span> to represent the component’s resource ID number in the program.</div></div></div><div id="Sec28" class="Section1 RenderAsSection1"><h2 class="Heading">Buttons and Events</h2><div class="Para">In the example in the section “Using Layouts as Interfaces,” you created an application that includes <span class="EmphasisFontCategoryNonProportional">Button</span>, <span class="EmphasisFontCategoryNonProportional">EditText</span>, and other widgets, but nothing happens when the button is clicked. This is because you did not assign a response to the <span class="EmphasisFontCategoryNonProportional">click</span> event. This section first introduces Android events and the basics of the listener functions. You review and further explore more advanced knowledge about events in future chapters covering Android’s multithreaded design.</div><div class="Para">In Android, each application maintains an event loop. When an application starts, it completes the appropriate initialization and then enters the event loop state, where it waits for a user action such as clicking the touch screen, pressing a key (a button), or some other input operation. User action triggers the program to generate a response to the <span class="EmphasisTypeItalic">event</span>; the system generates and distributes the corresponding event class to handle it according to the event location, such as <span class="EmphasisFontCategoryNonProportional">Activity</span> or <span class="EmphasisFontCategoryNonProportional">View</span>. The callback methods are integrated into an interface called the <span class="EmphasisTypeItalic">event listener</span>. You can achieve the specified event response by overriding the abstraction functions of the interface.</div><div class="Para">The scope of the event received by different classes is different for each class. For example, the <span class="EmphasisFontCategoryNonProportional">Activity</span> class can receive <span class="EmphasisFontCategoryNonProportional">keypress</span> events but not <span class="EmphasisFontCategoryNonProportional">touch</span> events, whereas the <span class="EmphasisFontCategoryNonProportional">View</span> class can receive both <span class="EmphasisFontCategoryNonProportional">touch</span> and <span class="EmphasisFontCategoryNonProportional">keypress</span> events. In addition, the event attribute details received by different classes also vary. For example, the <span class="EmphasisFontCategoryNonProportional">touch</span> event received by the <span class="EmphasisFontCategoryNonProportional">View</span> class consists of a number of touch points, coordinate values, and other information. It is subdivided into pressing down, bouncing, and moving events. But the <span class="EmphasisFontCategoryNonProportional">Button</span> class, which is a descendent of the <span class="EmphasisFontCategoryNonProportional">View</span> class, only detects a pressing action, and the event does not provide the coordinates of touch points or other information. In other words, <span class="EmphasisFontCategoryNonProportional">Button</span> processes the original event of the view and integrates all touch events into one event that records whether it is <span class="EmphasisTypeItalic">clicked</span> or not.</div><div class="Para">Most of the incident-response interfaces of the <span class="EmphasisFontCategoryNonProportional">View</span> class use <span class="EmphasisFontCategoryNonProportional">Listener</span> as a suffix, so it is easy to remember their association with the event-listener interface. Table <span class="InternalRef"><a href="#Tab4">8-4</a></span> shows examples of a number of classes and their incident-response functions.<div id="Tab4" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-4.</span><div class="SimplePara">Examples of Classes and Their Incident-Response Functions</div></div></div><table border="1"><colgroup><col/><col/><col/></colgroup><thead><tr class="header"><th><div class="SimplePara">Class</div></th><th><div class="SimplePara">Event</div></th><th><div class="SimplePara">Listener Interface and Function</div></th></tr></thead><tbody><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">Button</span>
                      </div></td><td><div class="SimplePara">Click</div></td><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">onClick()</span> function of the <span class="EmphasisFontCategoryNonProportional">onClickListener</span> Interface</div></td></tr><tr class="noclass"><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">RadioGroup</span>
                      </div></td><td><div class="SimplePara">Click</div></td><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">onCheckChange()</span> function of the <span class="EmphasisFontCategoryNonProportional">onCheckChangeListener</span> Interface</div></td></tr><tr class="noclass"><td rowspan="3"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">View</span>
                      </div></td><td><div class="SimplePara">Drop-down list</div></td><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">onTouch()</span> function of the <span class="EmphasisFontCategoryNonProportional">TouchListener</span> interface</div></td></tr><tr class="noclass"><td><div class="SimplePara">Input focus changes</div></td><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">onFocusChange()</span> function of the <span class="EmphasisFontCategoryNonProportional">onFocusChangeListener</span> interface</div></td></tr><tr class="noclass"><td><div class="SimplePara">Button</div></td><td><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">onKey()</span> function of the <span class="EmphasisFontCategoryNonProportional">onKeyListener</span> interface</div></td></tr></tbody></table></div>
          </div><div class="Para">The process to respond to events is as follows. First, define the implementation class of your listener interface and override the abstract function. Second, call functions such as <span class="EmphasisFontCategoryNonProportional">set ... Listener()</span>. Then set the implementation class of the custom monitor interface to the event listener of the corresponding objects.</div><div class="Para">For example, you can modify the application source to execute an incident response. There are many coding styles to implement a Java interface. The next section discusses several ways in which the results of the code running these styles is the same.</div><div id="Sec29" class="Section2 RenderAsSection2"><h3 class="Heading">Inner Class Listener</h3><div class="Para">Modify the <span class="EmphasisFontCategoryNonProportional">MainActivity.java</span> code as follows (the bold text is added or modified):</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">Line #    Source Code</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">1 package com.example.guiexam;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">2 import android.os.Bundle;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">3 import android.app.Activity;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">4 import android.view.Menu;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">5 import android.view.MenuItem;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">6 import android.support.v4.app.NavUtils;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">7 import android.widget.TextView;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">8</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.widget.Button;                // Use Button class</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">9</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">10</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.view.View;                   // Use View class</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">11</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.view.View.OnClickListener;   // Use View.OnClickListener class</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">12</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.util.Log;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">13</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Use Log.d debugging function</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">   public class MainActivity extends Activity {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">14</span>     <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">private int iClkTime = 1;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">15</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">16</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Count of Button Click</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">17</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">@Override</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">18     public void onCreate(Bundle savedInstanceState) {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">19         super.onCreate(savedInstanceState);</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">20         setContentView(R.layout.activity_main);</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">21</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">22</span>          <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">Button btn = (Button) findViewById(R.id.button1);</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">23</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Obtain Button object based on the resource ID number</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">24</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">final String prefixPrompt ="This is No. ";</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">25</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Define and set the value of the variable passed</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">26</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">final String suffixPrompt ="time(s) that Button is clicked";</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">27</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Define and set the value of the variable passed</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">28</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">btn.setOnClickListener(new /*View.*/OnClickListener(){</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">29</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Set the event response class of Button's click</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">30</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">31</span>             <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">public void onClick(View v) {</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">32</span>                 <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">Log.d("ProgTraceInfo",prefixPrompt + (iClkTime++) + suffixPrompt);</span></span>
            </div><div class="Para ParaTypeProgramcode">            <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">}</span></span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">});</span></span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">}</span></span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">@Override</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">public boolean onCreateOptionsMenu(Menu menu) {</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">getMenuInflater().inflate(R.menu.activity_main, menu);</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">return true;</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">}</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">}</span>
            </div><div class="Para">On lines 18‒22, you get the corresponding objects based on the resource ID of <span class="EmphasisFontCategoryNonProportional">EditText</span> and <span class="EmphasisFontCategoryNonProportional">TextView</span>, respectively. To use <span class="EmphasisFontCategoryNonProportional">OnClickListener</span> as an internal class, you add the <span class="EmphasisFontCategoryNonProportional">final</span> modifier in front of the variable. In lines 23 and 24, as the response code of the <span class="EmphasisFontCategoryNonProportional">Button</span> clicks, you first get the contents of <span class="EmphasisFontCategoryNonProportional">EditText</span> using <span class="EmphasisFontCategoryNonProportional">EditText.getText()</span>. Because the function returns a value of type <span class="EmphasisFontCategoryNonProportional">Editable</span>, you convert the type <span class="EmphasisFontCategoryNonProportional">Editable</span> to the type <span class="EmphasisFontCategoryNonProportional">String</span> via the <span class="EmphasisFontCategoryNonProportional">CharSequence.toString()</span> function (<span class="EmphasisFontCategoryNonProportional">CharSequence</span> is a superclass of <span class="EmphasisFontCategoryNonProportional">Editable</span>). Then you call the <span class="EmphasisFontCategoryNonProportional">TextView.setText (CharSequence text)</span> function to refresh the <span class="EmphasisFontCategoryNonProportional">TextView</span> display.</div><div class="Para">In Android, the accessor functions of a class attribute usually start with <span class="EmphasisFontCategoryNonProportional">set</span>/<span class="EmphasisFontCategoryNonProportional">get</span>, such as the read/write functions of the <span class="EmphasisFontCategoryNonProportional">EditText</span> contents:</div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">Editable  getText()</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">void  setText(CharSequence text, TextView.BufferType type)</span>
            </div><div class="Para">The interface of this application is shown in Figure <span class="InternalRef"><a href="#Fig11">8-11</a></span>; (a) is the start screen, (b) is the screen after text is entered in the edit text box, and (c) shows the application screen after the button is clicked.<div class="Figure" id="Fig11"><div class="MediaObject" id="MO11"><img src="A978-1-4842-0100-8_8_Fig11_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig11_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-11.</span><div class="SimplePara">The interface of the application with a <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">TextView</span></span>, a <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">Button</span></span>, and an <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">EditText</span></span>
                    </div></div></div></div>
            </div></div><div id="Sec30" class="Section2 RenderAsSection2"><h3 class="Heading">Using ImageView</h3><div class="Para">Previous sections discussed typical uses of widgets and showed the basic concepts of widget programming. The image is the foundation of multimedia applications and is thus a major part of Android applications. This section introduces the use of the image/picture display widget, <span class="EmphasisFontCategoryNonProportional">ImageView</span>. Through the examples in this section, you learn how to use <span class="EmphasisFontCategoryNonProportional">ImageView</span> and add files to the project’s resources.</div><div class="Para">The following example was originally developed in the section when you created the GuiExam application. Follow these steps to add a picture file to the project:
<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><div class="Para">Copy the image file (in this case, <span class="EmphasisFontCategoryNonProportional">morphing.png</span>) into the corresponding <span class="EmphasisFontCategoryNonProportional">/res/drawable-XXX</span> project directory (the directory in which to store project files of different resolution images), as shown in Figure <span class="InternalRef"><a href="#Fig12">8-12</a></span>.</div></div><div class="ClearBoth"> </div></div></div>
              <div class="Figure" id="Fig12"><div class="MediaObject" id="MO12"><img src="A978-1-4842-0100-8_8_Fig12_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig12_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-12.</span><div class="SimplePara">Copy the image file into the project’s <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">res</span></span> directory</div></div></div></div>
              <div class="OrderedList"><div class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><div class="Para">Open the project in Eclipse, and press the F5 key to refresh the project. You can see the file added to the project in Package Explorer (in this case, <span class="EmphasisFontCategoryNonProportional">morphing.png</span>), as shown in Figure <span class="InternalRef"><a href="#Fig13">8-13</a></span>.</div></div><div class="ClearBoth"> </div></div></div>
              <div class="Figure" id="Fig13"><div class="MediaObject" id="MO13"><img src="A978-1-4842-0100-8_8_Fig13_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig13_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-13.</span><div class="SimplePara">The Package Explorer window after the image is added</div></div></div></div>
            </div><div class="Para">To place <span class="EmphasisFontCategoryNonProportional">ImageView</span> widgets in the layout, follow these steps:
<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><div class="Para">Click to select the <span class="EmphasisFontCategoryNonProportional">TextView</span> widget of the “Hello world!” project, and then press the Del key to remove the widget from the layout.</div></div><div class="ClearBoth"> </div></div><div class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><div class="Para">In the editor window of <span class="EmphasisFontCategoryNonProportional">layout.xml</span>, locate the Image &amp; Media branch, and drag and drop the <span class="EmphasisFontCategoryNonProportional">ImageView</span> of this branch to the layout file. When the Resource Chooser dialog box pops up, click and select the Project Resource, select the just-imported picture file under the project, and click OK to complete the operation. This process is shown in Figure <span class="InternalRef"><a href="#Fig14">8-14</a></span>.</div></div><div class="ClearBoth"> </div></div></div>
              <div class="Figure" id="Fig14"><div class="MediaObject" id="MO14"><img src="A978-1-4842-0100-8_8_Fig14_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig14_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-14.</span><div class="SimplePara">Place the <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">ImageView</span></span> widget in the layout</div></div></div></div>
              <div class="OrderedList"><div class="ListItem"><span class="ItemNumber">3.</span><div class="ItemContent"><div class="Para">Adjust the size and position of the <span class="EmphasisFontCategoryNonProportional">ImageView</span>, and set its properties. This step can use the default values shown in Figure <span class="InternalRef"><a href="#Fig15">8-15</a></span>.</div></div><div class="ClearBoth"> </div></div></div>
              <div class="Figure" id="Fig15"><div class="MediaObject" id="MO15"><img src="A978-1-4842-0100-8_8_Fig15_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig15_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-15.</span><div class="SimplePara">The property settings of the <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">ImageView</span></span>
                    </div></div></div></div>
              <div class="OrderedList"><div class="ListItem"><span class="ItemNumber">4.</span><div class="ItemContent"><div class="Para">Save the layout file.</div></div><div class="ClearBoth"> </div></div></div>
            </div><div class="Para">Normally, at this point, you would have to compile the Java code. However, in this example, compiling is not necessary. Figure <span class="InternalRef"><a href="#Fig16">8-16</a></span> shows the application’s interface.<div class="Figure" id="Fig16"><div class="MediaObject" id="MO16"><img src="A978-1-4842-0100-8_8_Fig16_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig16_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-16.</span><div class="SimplePara">Application interface of the <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">ImageView</span></span>
                    </div></div></div></div>
            </div></div><div id="Sec31" class="Section2 RenderAsSection2"><h3 class="Heading">Exit Activities and Application</h3><div class="Para">In the previous example, you can press the phone’s Back button to hide the activity, but doing so does not close the activity. As you saw in the section “State Transitions of Activities,” when the Back button is pressed, started activities only change from the active state to the non-active state and remain in the system stack. To close these activities and remove them from the stack, you should use the <span class="EmphasisFontCategoryNonProportional">finish</span> function of the <span class="EmphasisFontCategoryNonProportional">Activity</span> class.</div><div class="Para">However, closing activities does not mean the application process ends. Even if all the components of the application (activity, service, broadcast intent receiver, and so on) are closed, the application process continues to exist. There are two main ways to exit the application process.</div><div class="Para">One is the static function <span class="EmphasisFontCategoryNonProportional">System.exit</span> that Java provides to forcibly end the process; another is the static function <span class="EmphasisFontCategoryNonProportional">Process.killProcess (pid)</span> provided by Android to terminate the specified process ID (PID). You can pass the <span class="EmphasisFontCategoryNonProportional">Process.myPid()</span> static function to get the application’s process ID.</div><div class="Para">You can use these methods for the example in the section “Using ImageView.” The specific steps are as follows:<div class="OrderedList"><div class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><div class="Para">Add two buttons to the layout file with the <span class="EmphasisFontCategoryNonProportional">Text</span> property “Close Activity” and “Exit Application” respectively and ID attributes <span class="EmphasisFontCategoryNonProportional">@+id/closeActivity</span> and <span class="EmphasisFontCategoryNonProportional">@+id/exitApplication</span> respectively. Adjust the buttons’ size and position, as shown in Figure <span class="InternalRef"><a href="#Fig17">8-17</a></span>.</div></div><div class="ClearBoth"> </div></div></div>
              <div class="Figure" id="Fig17"><div class="MediaObject" id="MO17"><img src="A978-1-4842-0100-8_8_Fig17_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig17_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-17.</span><div class="SimplePara">Add Close Activity and Exit Application buttons in the layout</div></div></div></div>
              <div class="OrderedList"><div class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><div class="Para">Modify the source code of the <span class="EmphasisFontCategoryNonProportional">MainActivity.java</span> file as follows (the bold code is either added or modified, and the lines with strikethrough indicate deleted code):</div></div><div class="ClearBoth"> </div></div></div>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">Line #    Source Code</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">1 package com.example.guiexam;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">2 import android.os.Bundle;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">3 import android.app.Activity;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">4 import android.view.Menu;</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">5</span>
              <span class="EmphasisTypeStrikethrough"><span class="EmphasisFontCategoryNonProportional">//import android.view.MenuItem;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">6</span>
              <span class="EmphasisTypeStrikethrough"><span class="EmphasisFontCategoryNonProportional">//import android.support.v4.app.NavUtils;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">7</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.widget.Button;               // Use Button class</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">8</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.view.View;                   // Use View class</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">9</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.view.View.OnClickListener;   // Use View.OnClickListenerClass</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">10</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">import android.os.Process;                 // Use killProcess method</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">11 public class MainActivity extends Activity {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">12     @Override</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">13     public void onCreate(Bundle savedInstanceState) {</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">14         super.onCreate(savedInstanceState);</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">15         setContentView(R.layout.activity_main);</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">16</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">Button btn = (Button) findViewById(R.id.closeActivity);</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">17</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Get Button object of &lt;Closed activity&gt;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">18</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">btn.setOnClickListener(new /*View.*/OnClickListener(){</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">19</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Set response code for Clicking</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">20</span>             <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">public void onClick(View v) {</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">21</span>                 <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">finish();                  // Close main activity</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">22</span>             <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">}</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">23</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">});</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">24</span>         <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">btn = (Button) findViewById(R.id.exitApplication);</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">25</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Get Button object of &lt;Exit Application&gt;</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">26</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// Set the response code to Clicking</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">27</span>             <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">public void onClick(View v) {</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">28</span>                 <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">finish();                  // close main activity</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">29</span>                 <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">Process.killProcess(Process.myPid()); // Exit application process</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">30</span>             <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">}</span></span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">31</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">32</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">33</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">34</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">35         });</span></span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">}</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">@Override</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">public boolean onCreateOptionsMenu(Menu menu) {</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">getMenuInflater().inflate(R.menu.activity_main, menu);</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">return true;</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">}</span>
            </div><div class="Para ParaTypeProgramcode">
              <span class="EmphasisFontCategoryNonProportional">}</span>
            </div><div class="Para">In lines 5 and 6, you remove the unused <span class="EmphasisFontCategoryNonProportional">import</span> statements. You set the response code for the Close Activity button in lines 16‒21 and set the response code for the Exit Application button in lines 22‒28. The only difference is that the latter adds the application-exit code <span class="EmphasisFontCategoryNonProportional">Process.killProcess (Process.myPid ())</span>
              <span class="EmphasisTypeItalic">.</span> Both buttons use the same <span class="EmphasisFontCategoryNonProportional">finish()</span> function of the <span class="EmphasisFontCategoryNonProportional">Activity</span> class to close the activity. The code in lines 7‒10 imports related classes.</div><div class="Para">The application interface is shown in Figure <span class="InternalRef"><a href="#Fig18">8-18</a></span>.<div class="Figure" id="Fig18"><div class="MediaObject" id="MO18"><img src="A978-1-4842-0100-8_8_Fig18_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig18_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-18.</span><div class="SimplePara">The Close Activity and Exit Application interface of the application</div></div></div></div>
            </div><div class="Para">When you click the Close Activity or Exit Application button, the main interface of the application is turned off. The difference is that the application process (<span class="EmphasisFontCategoryNonProportional">com.example.guiexam</span>) does not quit for Close Activity; but for Exit Application, the process closes. This is clearly shown in the Devices pane of the DDMS view in Eclipse, in which you can see a list of processes on the target machine, as shown in Figure <span class="InternalRef"><a href="#Fig19">8-19</a></span>.<div class="Figure" id="Fig19"><div class="MediaObject" id="MO19"><img src="A978-1-4842-0100-8_8_Fig19_HTML.jpg" alt="A978-1-4842-0100-8_8_Fig19_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-19.</span><div class="SimplePara">The process in DDMS when the Close Activity and Exit Application application is running</div></div></div></div>
            </div></div></div><div id="Sec32" class="Section1 RenderAsSection1"><h2 class="Heading">Summary</h2><div class="Para">This chapter introduced Android interface design by having you create a simple application called GuiExam. You learned about the state transitions of activities, the <span class="EmphasisFontCategoryNonProportional">Context</span> class, intent, and the relationship between applications and activities. You also saw how to use the layout as an interface by changing the layout file <span class="EmphasisFontCategoryNonProportional">activity_main.xml</span>, and you saw how the button, event, and inner event listeners work. The next chapter describes how to create an application with multiple activities using the activity-intent mechanism and shows the changes needed in the <span class="EmphasisFontCategoryNonProportional">AndroidManifest.xml</span> file.</div></div></div></body></html>
