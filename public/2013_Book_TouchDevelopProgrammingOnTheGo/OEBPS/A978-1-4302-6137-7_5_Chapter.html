<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><title>Audio</title><link href="springer_epub.css" type="text/css" rel="styleSheet"/></head><body><div class="ChapterContextInformation"><div class="ContextInformation" id="Chap5"><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">R. Nigel Horspool</span> and </span><span class="Author"><span class="AuthorName">Nikolai Tillmann</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" xml:lang="en">TouchDevelop: Programming on the Go</span><span class="BookEdition">Third Edition</span></span><span class="ChapterDOI">10.1007/978-1-4302-6137-7_5</span><span class="ChapterCopyright">© R. Nigel Horspool 2013</span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" xml:lang="en">5. Audio</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">R. Nigel Horspool</span><sup>1 <span class="ContactIcon"/></sup> and </span><span class="Author"><span class="AuthorName">Nikolai Tillmann</span><sup>2 <span class="ContactIcon"/></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff1"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Canada, USA</div></div><div class="Affiliation" id="Aff2"><span class="AffiliationNumber">(2)</span><div class="AffiliationText">TU Berlin, Germany</div></div><div class="ClearBoth"> </div></div></div><div class="ArticleOrChapterToc"><div class="TocLine"><a href="#Sec1">5.1 Music</a></div><div class="TocLine"><a href="#Sec6">5.2 Sounds</a></div><div class="TocLine"><a href="#Sec7">5.3 Microphone</a></div></div><div class="Abstract" id="Abs1" xml:lang="en"><div class="Heading">Abstract</div><div class="Para">A smartphone or tablet can double as a portable music player. It can play music held as MP3 files on the device. It can play audio streamed over the internet, it can record sound using its microphone … and more.</div></div><!--End Abstract--><div class="Fulltext"><div class="Para">A smartphone or tablet can double as a portable music player. It can play music held as MP3 files on the device. It can play audio streamed over the internet, it can record sound using its microphone … and more.</div><div id="Sec1" class="Section1 RenderAsSection1"><h2 class="Heading">5.1 Music</h2><div class="Para">Music files can be copied onto your device by a variety of means. Music can also be purchased and downloaded onto your device from a variety of on-line services. The supported formats for music files are listed in Table <span class="InternalRef"><a href="#Tab1">5-1</a></span>. If your file is in another format, there are programs available to convert it to a supported format. The names used in the ‘container’ column of the table are likely to be the same as the filename extensions used in the filenames on the computer (e.g. “track1.mp3”), but this is not guaranteed to be the case.
<div id="Tab1" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 5-1</span><div class="SimplePara">Supported music formats</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Codec</div></th><th align="left"><div class="SimplePara">Container</div></th><th align="left"><div class="SimplePara">Notes</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">AAC</span>
                      </div></td><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">M4A</span>
                      </div></td><td align="left"><div class="SimplePara">Only unprotected (DRM-free) files are supported</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">MP3</span>
                      </div></td><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">MP3</span>
                      </div></td><td align="left"><div class="SimplePara">Layer III of MPEG-1 to be precise</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">WMA</span>
                      </div></td><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">WMA</span>
                      </div></td><td align="left"><div class="SimplePara">Zune converts lossless WMA to another format</div></td></tr></tbody></table></div>
          </div><div class="Para">The TouchDevelop API provides the media resource. However due to security restrictions, many methods of this resource are available only for use on the Windows Phone and on Android devices. On other devices, it is not possible to access song albums or the entire collection of songs held on the device.</div><div class="Para">On the Windows phone and Android devices, the <span class="EmphasisFontCategoryNonProportional">media</span> resource has methods for retrieving collections of all the songs, all the song albums, and all the playlists held on the phone. TouchDevelop does not provide any mechanism for changing any of these three collections. They are <span class="EmphasisTypeItalic">immutable</span>. It is therefore impossible for a mistake in a TouchDevelop script to cause any music file on the phone to be accidentally deleted. The three media methods are listed in Table <span class="InternalRef"><a href="#Tab2">5-2</a></span>.
<div id="Tab2" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 5-2</span><div class="SimplePara">Accessing media resources (WP8 and Android only)</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">media→songs : Songs</span>
                      </div></td><td align="left"><div class="SimplePara">Gets a collection of all the songs on the phone</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">media→song albums : Song Albums</span>
                      </div></td><td align="left"><div class="SimplePara">Gets a collection of all the song albums on the phone</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">media→playlists : Playlists</span>
                      </div></td><td align="left"><div class="SimplePara">Gets a collection of all the playlists on the phone</div></td></tr></tbody></table></div>
          </div><div id="Sec2" class="Section2 RenderAsSection2"><h3 class="Heading">5.1.1 Working with collections of songs</h3><div class="Para">Although the TouchDevelop documentation and this book use the words ‘music’ and ‘song’, the API calls are of course not restricted to working with music. They will work equally well with recordings made in any of the audio formats listed in Table <span class="InternalRef"><a href="#Tab1">5-1</a></span>.</div><div class="Para">Note that the TouchDevelop API also provides methods for working with audio recordings in the WAV format but these recordings are not usually used for music, they are short in duration, and they are represented in the TouchDevelop API by the <span class="EmphasisFontCategoryNonProportional">Sound</span> datatype. The <span class="EmphasisFontCategoryNonProportional">Sound</span> type is covered later in this chapter.</div><div class="Para">The methods for using songs, song albums, and playlists are listed in Table <span class="InternalRef"><a href="#Tab3">5-3</a></span>. The <span class="EmphasisFontCategoryNonProportional">is invalid</span> and <span class="EmphasisFontCategoryNonProportional">post to wall</span> methods (available for all datatypes) are omitted from the table.
<div id="Tab3" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 5-3</span><div class="SimplePara">Using songs and song albums (WP8 and Android only)</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method of Playlist Datatype</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">duration : Number</span>
                        </div></td><td align="left"><div class="SimplePara">Returns total duration of all songs in the playlist in seconds</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">name : String</span>
                        </div></td><td align="left"><div class="SimplePara">Returns name of the playlist</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">play : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Plays all the songs in the playlist</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">songs : Songs</span>
                        </div></td><td align="left"><div class="SimplePara">Gets all the songs in the playlist as a collection</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisTypeBold">Method of Song Album</span>
                        </div></td><td align="left"><div class="SimplePara">
                          <span class="EmphasisTypeBold">Description</span>
                        </div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">art : Picture</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the album cover art</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">artist : String</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the album artist’s name</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">duration : Number</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the total duration of all songs on the album in seconds</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">genre : String</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the music genre</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">has art : Boolean</span>
                        </div></td><td align="left"><div class="SimplePara">Returns true if cover art is available</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">name : String</span>
                        </div></td><td align="left"><div class="SimplePara">Returns the name of the album</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">play : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Plays all the songs on the album</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">songs : Songs</span>
                        </div></td><td align="left"><div class="SimplePara">Returns a collection of all songs on the album</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">thumbnail : Picture</span>
                        </div></td><td align="left"><div class="SimplePara">Gets a thumbnail picture of the cover art</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">album : Song Album</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the album in which the song appears</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">artist : String</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the song artist’s name</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">duration : Number</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the song duration in seconds</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">genre : String</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the song’s music genre</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">name : String</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the name of the song</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">play : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Plays the song</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">play count : Number</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the number of times song has been played</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisTypeBold">Method of Song Datatype</span>
                        </div></td><td align="left"><div class="SimplePara">
                          <span class="EmphasisTypeBold">Description</span>
                        </div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">protected : Boolean</span>
                        </div></td><td align="left"><div class="SimplePara">Returns true if the song is DRM protected</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">rating : Number</span>
                        </div></td><td align="left"><div class="SimplePara">Gets a rating set by the user; -1 if not rated</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">track: Number</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the track number of song on the album</div></td></tr></tbody></table></div>
            </div><div class="Para">TouchDevelop also provides one event related to songs. This is the active song changed event which is triggered at the moments that its name suggests. For example, an album or a playlist may be in the process of being played, and the event will be triggered whenever the phone advances to the next song in the list.</div></div><div id="Sec3" class="Section2 RenderAsSection2"><h3 class="Heading">5.1.2 Obtaining an individual song, available on all devices</h3><div class="Para">It is possible to import an individual music track into a TouchDevelop script, no matter which platform the script is running on.</div><div class="Para">One possibility is to download a music file from the web. The action</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">song := web → download song(url)</span>
            </div><div class="Para">will load the music into the variable <span class="EmphasisFontCategoryNonProportional">song</span> (with type <span class="EmphasisFontCategoryNonProportional">Song</span>), where <span class="EmphasisFontCategoryNonProportional">url</span> is a string giving a URL for the location of the file.</div><div class="Para">Alternatively, the script can open a choose file dialog where the user can navigate to the music file on their computer or tablet. The usage is as below.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">song := media → choose song</span>
            </div></div><div id="Sec4" class="Section2 RenderAsSection2"><h3 class="Heading">5.1.3 Playing an individual song</h3><div class="Para">The <span class="EmphasisFontCategoryNonProportional">play</span> method of the <span class="EmphasisFontCategoryNonProportional">Song</span>, <span class="EmphasisFontCategoryNonProportional">Song Album</span> or <span class="EmphasisFontCategoryNonProportional">Playlist</span> types will start a song or a sequence of songs playing on the phone. For example:</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">song → play</span>
            </div><div class="Para">More precise control over the playing of songs is provided by the player resource in the API. The methods directly related to playing songs are listed in Table <span class="InternalRef"><a href="#Tab4">5-4</a></span>.
<div id="Tab4" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 5-4</span><div class="SimplePara">Methods of player resource for songs</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method of player resource</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→active song: Song</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the current song, if any</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→is muted : Boolean</span>
                        </div></td><td align="left"><div class="SimplePara">Reports whether the player is muted</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→is paused : Boolean</span>
                        </div></td><td align="left"><div class="SimplePara">Reports whether current song is paused</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→is playing : Boolean</span>
                        </div></td><td align="left"><div class="SimplePara">Reports whether a song is playing</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→is repeating : Boolean</span>
                        </div></td><td align="left"><div class="SimplePara">Reports whether song is in repeat mode</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→is shuffled : Boolean</span>
                        </div></td><td align="left"><div class="SimplePara">Reports whether the songs are shuffled</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→is stopped : Boolean</span>
                        </div></td><td align="left"><div class="SimplePara">Reports if the player is stopped</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→next : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Stops current song and advances to next one in the queue waiting to be played</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→pause : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Pauses the current song</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→play(song : Song): Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Adds a song to the queue of songs</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→play many(songs : Songs) : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Adds all songs in the collection to the queue</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→play position : Number</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the position in seconds within the current song</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→previous : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Stops current song and goes back to the previous one</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→resume : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Resumes a paused song</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→set repeating(repeating : Boolean) : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Sets the repeating mode for the current song</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→set shuffled(shuffled : Boolean) : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Sets shuffling on or off for songs in the queue</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→set sound volume(x : Number) : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Sets the sound volume: 0.0 is silent, 1.0 is the volume when TouchDevelop started</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→sound volume : Number</span>
                        </div></td><td align="left"><div class="SimplePara">Gets the sound volume in the same 0 to 1 scale</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→stop : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Stops playing a song</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">player→volume : Number</span>
                        </div></td><td align="left"><div class="SimplePara">Gets player volume, from 0.0 (silence) to 1.0 (full volume).</div></td></tr></tbody></table></div>
            </div><div class="Para">When an album or a playlist is sent to the player, the player creates a queue of songs to be played. The songs will by default be played in the order that they appear in the album or playlist. However a random order will be used if shuffle is selected. Requesting a new song to be played before the current song is finished causes the current song to be terminated and the queue to be cleared (if it is not empty) before the new song starts.</div><div class="Para">Playing songs occurs in the background. This means that the player is performing its task while the device and, perhaps, the TouchDevelop script is doing other things. When a song or collection of songs is given to the player, the player remembers what it has to play and starts playing. Control is returned to the script for it to carry on executing statements while the music is playing.</div><div class="Para">The playing volume ranges from 0.0 to 1.0. The value of 1.0 does not correspond to the maximum volume which the device is capable of. The value is relative to the volume of the player as set externally to the TouchDevelop script. A script cannot play songs louder than the device’s current setting, but it can play at a quieter level by using a value less than 1.0 for the volume.</div></div><div id="Sec5" class="Section2 RenderAsSection2"><h3 class="Heading">5.1.4 An example script</h3><div class="Para">There are many example programs on the TouchDevelop website which select and play music. One sample program for the Windows Phone and Android platforms is reproduced below in Figure <span class="InternalRef"><a href="#Fig1">5-1</a></span>. It uses several features provided by the API.</div><div class="Para">There is one feature of this script that is not obvious when reading it. When it is run, it will display information about each song on the phone which has never been previously played. If the user scrolls through the list of displayed songs and taps one, it will immediately start playing.
<div class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img src="A978-1-4302-6137-7_5_Fig1_HTML.jpg" alt="A978-1-4302-6137-7_5_Fig1_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 5-1</span><div class="SimplePara">The ‘new songs’ script (WP8 and Android only)</div></div></div></div>
            </div></div></div><div id="Sec6" class="Section1 RenderAsSection1"><h2 class="Heading">5.2 Sounds</h2><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Sound</span> datatype is used for audio recordings in the WAV format. This format is commonly used for uncompressed audio and therefore the files tend to be large. This format should therefore be used only for short sound clips (say 30 seconds or less), such as ring tones, sound effects or warning noises to be played by your script. For longer pieces, the <span class="EmphasisFontCategoryNonProportional">Song</span> datatype and therefore a compressed sound format should be used, if possible.</div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Sound</span> datatype provides many methods for playing the sound clip and altering its properties when played. These are summarized in Table <span class="InternalRef"><a href="#Tab5">5-5</a></span>.</div><div class="Para">Panning refers to the ability to choose whether the sound should be played wholly through the left earpiece or wholly through the right earpiece or through both together in some proportion. The pan value ranges from -1.0 for fully left to 0.0 for center (i.e. both sides equally) to 1.0 for fully right.
<div id="Tab5" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 5-5</span><div class="SimplePara">Methods of Sound datatype</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method of Sounds</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">duration : Number</span>
                      </div></td><td align="left"><div class="SimplePara">Returns the sound clip’s duration in seconds</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">pan : Number</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the pan setting: from -1 for full left to +1 for right</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">play : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Plays the sound clip</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">play special(volume :</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">Number, pitch : Number, pan : Number) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Plays the sound clip with values supplied for the panning, pitch and volume</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">pitch : Number</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the pitch adjustment from -1 to +1</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">set pan(pan : Number) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Sets the pan setting: from -1 for full left to +1 for right</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">set pitch(pitch : Number) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Sets the pitch adjustment from -1 to +1</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">set volume(v : Number) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Sets the volume from 0 (silent) to +1 (full volume)</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">volume : Number</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the volume, in range 0 (silent) to +1 (full volume)</div></td></tr></tbody></table></div>
          </div><div class="Para">The pitch adjustment ranges from -1.0 to 1.0. If -1.0 is selected, the playback speed is slowed down so that the pitch is lowered by one octave. The midpoint value 0.0 plays the sound clip at normal speed. The top value of 1.0 causes playback to speeded up so that the pitch is raised by one octave.</div><div class="Para">As with playing <span class="EmphasisFontCategoryNonProportional">Song</span> values, the volume is a value ranging from 0.0 to 1.0 where 1.0 is the current volume setting for the speakers as set externally of the TouchDevelop script. The script can play sounds at a quieter level than this setting but it cannot play them louder.</div></div><div id="Sec7" class="Section1 RenderAsSection1"><h2 class="Heading">5.3 Microphone</h2><div class="Para">Most devices have a microphone. However, the microphone cannot be accessed from a program running in a browser on a PC, Mac or Linux platform. It can be accessed on the Windows phone and the ability to access it will be supported on iPad, iPhone, iPod Touch and Android platforms in the near future.</div><div class="Para">The TouchDevelop API provides a method for activating the microphone and making a recording.</div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">snd := senses → record microphone</span>
          </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">// snd has the datatype Sound</span></span>
          </div><div class="Para">When the above statement is executed in a script, the word “Recording…” and a stop button are displayed on the screen. Simultaneously, the microphone begins recording. When the user taps the stop button, recording stops and an instance of the <span class="EmphasisFontCategoryNonProportional">Sound</span> datatype is returned.</div><div class="Para">As noted earlier, a <span class="EmphasisFontCategoryNonProportional">Sound</span> value uses the WAV audio format and is not compressed. Therefore the microphone should not be used for long recordings.</div></div></div></body></html>
