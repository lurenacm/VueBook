<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><title>The Scripting Language</title><link href="springer_epub.css" type="text/css" rel="styleSheet"/></head><body><div class="ChapterContextInformation"><div class="ContextInformation" id="Chap2"><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">R. Nigel Horspool</span> and </span><span class="Author"><span class="AuthorName">Nikolai Tillmann</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" xml:lang="en">TouchDevelop: Programming on the Go</span><span class="BookEdition">Third Edition</span></span><span class="ChapterDOI">10.1007/978-1-4302-6137-7_2</span><span class="ChapterCopyright">© R. Nigel Horspool 2013</span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" xml:lang="en">2. The Scripting Language</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">R. Nigel Horspool</span><sup>1 <span class="ContactIcon"/></sup> and </span><span class="Author"><span class="AuthorName">Nikolai Tillmann</span><sup>2 <span class="ContactIcon"/></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff1"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Canada, USA</div></div><div class="Affiliation" id="Aff2"><span class="AffiliationNumber">(2)</span><div class="AffiliationText">TU Berlin, Germany</div></div><div class="ClearBoth"> </div></div></div><div class="ArticleOrChapterToc"><div class="TocLine"><a href="#Sec1">Introduction – the language flavor</a></div><div class="TocLine"><a href="#Sec3">Datatypes and variables</a></div><div class="TocLine"><a href="#Sec17">Expressions</a></div><div class="TocLine"><a href="#Sec29">Statements</a></div><div class="TocLine"><a href="#Sec36">Actions</a></div><div class="TocLine"><a href="#Sec45">Events</a></div><div class="TocLine"><a href="#Sec46">Pages</a></div><div class="TocLine"><a href="#Sec47">Creating library scripts</a></div></div><div class="Abstract" id="Abs1" xml:lang="en"><div class="Heading">Abstract</div><div class="Para">A TouchDevelop script appears to the user as statements in a language which is not unlike many other programming languages. This chapter covers the syntax and semantics of that language. The language is augmented by a powerful and rich API (Application Programming Interface), an API which significantly extends the programming capabilities of the TouchDevelop language. The API is covered in the chapters which follow this one.</div></div><!--End Abstract--><div class="Fulltext"><div class="Para">A TouchDevelop script appears to the user as statements in a language which is not unlike many other programming languages. This chapter covers the syntax and semantics of that language. The language is augmented by a powerful and rich API (Application Programming Interface), an API which significantly extends the programming capabilities of the TouchDevelop language. The API is covered in the chapters which follow this one.</div><div id="Sec1" class="Section1 RenderAsSection1"><h2 class="Heading">Introduction – the language flavor</h2><div class="Para">These introductory paragraphs are written for people who know some of the terminology used to describe programming language semantics, and will allow such readers to fast forward over large chunks of this chapter.</div><div class="Para">The scripting language is statement oriented. Statements are executed in a <span class="EmphasisTypeItalic">sequential</span> manner. Control flow constructs include <span class="EmphasisTypeItalic">if</span>-statements, <span class="EmphasisTypeItalic">for</span> and <span class="EmphasisTypeItalic">while</span> loops, and <span class="EmphasisTypeItalic">functions</span> (which are called <span class="EmphasisTypeItalic">actions</span> in this language).</div><div class="Para">The statements manipulate values. All intermediate values and variables are <span class="EmphasisTypeItalic">statically type checked</span>. Only parameters of actions have explicit type declarations. The datatypes of all other values and variables are inferred through analysis of the code.</div><div class="Para">The language is <span class="EmphasisTypeItalic">strongly typed</span>, in that (with one exception), every operation requires operands of particular datatypes and there is <span class="EmphasisTypeItalic">no automatic coercion</span> to the type required by an operation. The datatypes belong to one of two categories: <span class="EmphasisTypeItalic">value types</span> and <span class="EmphasisTypeItalic">reference types</span>. Value types may have storage on the <span class="EmphasisTypeItalic">stack</span> used for local variables, and their storage is automatically deallocated on exit from an action (i.e. from a function). Reference types have their storage allocated on the <span class="EmphasisTypeItalic">heap</span>.</div><div class="Para">The heap is garbage collected. In addition to parameters and local variables, a script can define globally visible variables in its data section or read-only variables in its art section. Their storage is persistent across script executions.</div><div class="Para">Although the language syntax shows similarities to object-oriented languages, the language does not support the object-oriented paradigm. For example, there is no equivalent of class inheritance or method overloading.</div><div class="Para">To conserve real estate on smaller screens, several symbols are used instead of keywords. These symbols are all available as characters in the Segoe UI Symbol font (a font which is distributed with the Windows 7 and 8 operating systems). The symbols are summarized in Table <span class="InternalRef"><a href="#Tab1">2-1</a></span>.</div><div id="Sec2" class="Section2 RenderAsSection2"><h3 class="Heading">A sample program (/okzc)</h3><div class="Para">This sample program is shown in Figure <span class="InternalRef"><a href="#Fig1">2-1</a></span>. It uses several features provided by the API. They will be explained only briefly. More complete explanations are provided in later chapters. Note that this script runs only on a Windows Phone.</div><div class="Para">The script comprises two actions and two events. The action named <span class="EmphasisFontCategoryNonProportional">main</span> is the entry point for the script. The action named <span class="EmphasisFontCategoryNonProportional">display song</span> is called by <span class="EmphasisFontCategoryNonProportional">main</span>. It has one input parameter named <span class="EmphasisFontCategoryNonProportional">song</span> (with type <span class="EmphasisFontCategoryNonProportional">Song</span>) and has one result parameter named <span class="EmphasisFontCategoryNonProportional">result</span> (with type <span class="EmphasisFontCategoryNonProportional">Number</span>).</div><div class="Para">The main action defines and initializes a local variable named <span class="EmphasisFontCategoryNonProportional">found</span>. No datatype is provided in that definition; it is inferred from the value used for initialization which has type <span class="EmphasisFontCategoryNonProportional">Number</span>. The local variable named <span class="EmphasisFontCategoryNonProportional">songs</span> is, by using the API, initialized with a collection of all songs held on the phone.
<div id="Tab1" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2-1</span><div class="SimplePara">Special symbols used in scripts</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Symbol</div></th><th align="left"><div class="SimplePara">Unicode Value</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">→</div></td><td align="left"><div class="SimplePara">U+2192</div></td><td align="left"><div class="SimplePara">Select a method or field belonging to the value provided on the left</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">▷</div></td><td align="left"><div class="SimplePara">U+25B7</div></td><td align="left"><div class="SimplePara">Call the action named on the right and defined in the current script</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">◳</div></td><td align="left"><div class="SimplePara">U+25F3</div></td><td align="left"><div class="SimplePara">Access a global persistent variable defined in the data section of the script</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">♻</div></td><td align="left"><div class="SimplePara">U+267B</div></td><td align="left"><div class="SimplePara">Call a function defined in another script, which has been published as a library</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">⌹</div></td><td align="left"><div class="SimplePara">U+2339</div></td><td align="left"><div class="SimplePara">Access a datatype or item declared in the record section of the script</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">✿</div></td><td align="left"><div class="SimplePara">U+273F</div></td><td align="left"><div class="SimplePara">Access a value in the art section of the script</div></td></tr></tbody></table></div>
            </div><div class="Para">A <span class="EmphasisTypeBold">for-each</span> loop steps through every value in the collection, assigning the next variable to a new local variable named <span class="EmphasisFontCategoryNonProportional">song</span>. The first statement inside the loop calls an action using the notation ▷<span class="EmphasisFontCategoryNonProportional">display song(song)</span>. It passes a reference to the local variable <span class="EmphasisFontCategoryNonProportional">song</span> and receives a number back as the result, adding that to the <span class="EmphasisFontCategoryNonProportional">found</span> variable.</div><div class="Para">The second statement inside the loop takes a string constant and concatenates the value of the global data item named played. The preceding symbol <span class="EmphasisFontCategoryNonProportional">◳</span> indicates that the variable has global scope and is persistent. The string concatenation operator is <span class="EmphasisFontCategoryNonProportional">||</span> and is the only operator in TouchDevelop which is overloaded – meaning that it accepts operands with any datatypes and those operand values are converted to strings.</div><div class="Para">The resulting string value constructed by the concatenation appears to the left of the arrow operator →. It indicates that the value is to be transmitted to the method shown on the right, whose name is <span class="EmphasisFontCategoryNonProportional">post to wall</span>. Almost every datatype has a <span class="EmphasisFontCategoryNonProportional">post to wall</span> method; it causes a representation of the value to be displayed on the screen.</div><div class="Para">The sample script contains two events. An <span class="EmphasisTypeItalic">event</span> is an action which is executed whenever the specified event occurs. The <span class="EmphasisFontCategoryNonProportional">shake</span> event is caused by physically shaking the phone. When shaking is detected by the phone’s sensors, the code provided for the <span class="EmphasisFontCategoryNonProportional">shake</span> event is executed. Events do not interrupt each other; they are executed in first-come first-served order.
<div class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img src="A978-1-4302-6137-7_2_Fig1_HTML.jpg" alt="A978-1-4302-6137-7_2_Fig1_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 2-1</span><div class="SimplePara">The ‘new songs’ script (/okzc)</div></div></div></div>
            </div><div class="Para">If a script contains one or more events, the main program does not terminate. It waits for events to occur. In this case, the script terminates only if halted by the user (e.g. tapping the phone’s back button) or if it executes a call to a method in the API for that purpose (<span class="EmphasisFontCategoryNonProportional">time</span>→<span class="EmphasisFontCategoryNonProportional">stop</span>).</div></div></div><div id="Sec3" class="Section1 RenderAsSection1"><h2 class="Heading">Datatypes and variables</h2><div class="Para">Each type (except the special type <span class="EmphasisFontCategoryNonProportional">Nothing</span>) belongs to one of two categories: <span class="EmphasisTypeItalic">Value Types</span> or <span class="EmphasisTypeItalic">Reference Types</span>. If a variable has a value type, then storage for an instance of that type is held inside the variable itself. For example, a variable with type Number is allocated storage which is used to hold number values. However, if a variable has a reference type, then storage for its value is allocated on the heap and the variable holds a reference to that heap storage.</div><div id="Sec4" class="Section2 RenderAsSection2"><h3 class="Heading">2.2.1 The Invalid value</h3><div class="Para">Every datatype (except the special type <span class="EmphasisFontCategoryNonProportional">Nothing</span>) has a special value <span class="EmphasisFontCategoryNonProportional">Invalid</span> in addition to all its normal values. This special value is normally used to indicate that a global data variable has not been initialized or that a method in the API was unable to return a value. TouchDevelop provides a method for testing a value of any datatype (except <span class="EmphasisFontCategoryNonProportional">Nothing</span>) to test whether it is the <span class="EmphasisFontCategoryNonProportional">Invalid</span> value. There are also API methods for obtaining the Invalid value for any desired type.</div><div class="Para">If a data structure (such as a tree or linked list) is constructed using <span class="EmphasisFontCategoryNonProportional">Object</span> types declared in the <span class="EmphasisFontCategoryNonProportional">Records</span> section of a script, the <span class="EmphasisFontCategoryNonProportional">Invalid</span> value would usually be used to play the role of a <span class="EmphasisFontCategoryNonProportional">null</span> reference value.</div><div class="Para">Some code to demonstrate the use of <span class="EmphasisFontCategoryNonProportional">Invalid</span> values appears below.</div><div class="Para ParaTypeProgramcode">    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">numUsers := 0</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">…</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
              <span class="EmphasisFontCategoryNonProportional">connection failure detected</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">numUsers := invalid → number</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">else</span></span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">…</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
              <span class="EmphasisFontCategoryNonProportional">numUsers → is invalid</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">“Script is terminating” → post to wall</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">Else</span></span>
            </div></div><div id="Sec5" class="Section2 RenderAsSection2"><h3 class="Heading">The Nothing type</h3><div class="Para">A method or an operation which does not return a usable result, but which otherwise succeeded, actually returns a value of type <span class="EmphasisFontCategoryNonProportional">Nothing</span>. For example, the post to wall method which is provided for every datatype returns a result of type <span class="EmphasisFontCategoryNonProportional">Nothing</span>. In some languages, such as F#, the <span class="EmphasisFontCategoryNonProportional">Unit</span> type is the equivalent of the <span class="EmphasisFontCategoryNonProportional">Nothing</span> type in TouchDevelop. There is a single value with type <span class="EmphasisFontCategoryNonProportional">Nothing</span>. No operations at all are provided for this type; it is similar to the void type in languages like C/C++ and Java.</div><div id="Sec6" class="Section3 RenderAsSection3"><h4 class="Heading">Value types</h4><div class="Para">The basic types or elementary types provided in the TouchDevelop scripting language are <span class="EmphasisFontCategoryNonProportional">Number</span>, <span class="EmphasisFontCategoryNonProportional">Boolean</span>, and <span class="EmphasisFontCategoryNonProportional">String</span>. These are all <span class="EmphasisTypeItalic">Value Types</span>. There are also several composite types which are value types. All the value types are listed in Table <span class="InternalRef"><a href="#Tab2">2-2</a></span>. Here are some further details about the <span class="EmphasisFontCategoryNonProportional">Number</span> and <span class="EmphasisFontCategoryNonProportional">String</span> types.</div></div><div id="Sec7" class="Section3 RenderAsSection3"><h4 class="Heading">Number</h4><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Number</span> type combines the integer and floating-point types found in other languages. Values are held in double-precision floating point format, consistent with the IEEE 754 standard. This implies that the special values <span class="EmphasisTypeItalic">plus infinity</span>, <span class="EmphasisTypeItalic">minus infinity</span> and <span class="EmphasisTypeItalic">NaN</span> (not-a-number) can be computed as the result of a calculation.</div><div class="Para">When a <span class="EmphasisFontCategoryNonProportional">Number</span> value is used in a context where an integer is needed, such as when selecting the <span class="EmphasisTypeItalic">k-</span>th value in a collection, the value is rounded to the closest integer. A value exactly half-way between is rounded up; for example, 1.5 is rounded up to 2 while 1.49 is rounded down to 1.
<div id="Tab2" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2-2</span><div class="SimplePara">The Value types</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/><col align="center"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Value Type</div></th><th align="left"><div class="SimplePara">Description</div></th><th align="center"><div class="SimplePara">Covered in Chapter</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Number</span>
                          </div></td><td align="left"><div class="SimplePara">An integer or floating-point number</div></td><td align="center"><div class="SimplePara">2</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Boolean</span>
                          </div></td><td align="left"><div class="SimplePara">The type whose constants are true and false</div></td><td align="center"><div class="SimplePara">2</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">String</span>
                          </div></td><td align="left"><div class="SimplePara">A sequence of zero or more Unicode characters</div></td><td align="center"><div class="SimplePara">2</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Color</span>
                          </div></td><td align="left"><div class="SimplePara">Used for colors displayed on the screen. Values are compatible with 4 byte ARGB (alpha, red, green, blue) color representations. Many standard colors are provided as constants of the Color datatype.</div></td><td align="center"><div class="SimplePara">6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">DateTime</span>
                          </div></td><td align="left"><div class="SimplePara">Holds any date from 0001 CE (Common Era) to 9999 CE, combined with a time of day. The time of day is recorded with 100 nanosecond accuracy.</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Location</span>
                          </div></td><td align="left"><div class="SimplePara">Holds a combination of latitude, longitude and altitude values plus a course direction and a speed in two-dimensional space.</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Motion</span>
                          </div></td><td align="left"><div class="SimplePara">A combination of sensor readings which describe motion of the phone in 3D space plus a time-stamp which specifies when the readings were taken. The motion information includes speed, acceleration and angular velocity.</div></td><td align="center"><div class="SimplePara">7</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Vector3</span>
                          </div></td><td align="left"><div class="SimplePara">A triple of three numbers used to hold a velocity or acceleration in the three spatial dimensions or an angular velocity about the three axes in 3D space.</div></td><td align="center"><div class="SimplePara">7</div></td></tr></tbody></table></div>
              </div></div><div id="Sec8" class="Section3 RenderAsSection3"><h4 class="Heading">String</h4><div class="Para">A string may contain zero or more Unicode characters. When a string constant is shown as part of a TouchDevelop script, double-quote characters are used to enclose the string and a backslash character is used to escape a double-quote character or a special character which appears inside the string. However, when using the editor to enter a string constant, no backslash characters should be entered (unless a backslash character itself is wanted inside the string constant).</div><div class="Para">It should be noted that TouchDevelop does not provide the <span class="EmphasisFontCategoryNonProportional">char</span> type for working with single characters. Instead a string of length one should be used.</div></div></div><div id="Sec9" class="Section2 RenderAsSection2"><h3 class="Heading">Reference types</h3><div class="Para">Storage for an instance of a reference type is allocated in a different place from a variable declared with that type. A local variable with a reference type is implemented as a pointer (a reference) to the actual value which is stored elsewhere.</div><div class="Para">In TouchDevelop, two kinds of reference types are provided. If the value represents an entity which exists outside TouchDevelop, such as a song on a Windows phone, then storage is allocated outside the TouchDevelop application. Otherwise the storage is allocated within an area of memory controlled by TouchDevelop which is called the <span class="EmphasisTypeItalic">heap</span>. When there are no more references to a value on the heap, the storage used by that value is automatically reclaimed. It is <span class="EmphasisTypeItalic">garbage collected</span>. The language facilities and the operations which can be performed on reference types in a TouchDevelop script depend on whether the values are external to the script or are internal.</div><div class="Para">When one variable with a reference type is assigned to another variable, both variables will become references to the same instance. A simple example to illustrate this sharing of one instance between two variables is provided by the following code.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">// Set x to refer to a value of type Contact</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">x := social → choose contacts</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">y := x</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">x → set title(“His Excellency”)</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">y → title → post to wall</span>
            </div><div class="Para">In this example, the title displayed on the screen by the last statement will always be ‘His Excellency’ because <span class="EmphasisFontCategoryNonProportional">x</span> and <span class="EmphasisFontCategoryNonProportional">y</span> are both references to the same instance on the heap, in which the title field of an instance of the <span class="EmphasisFontCategoryNonProportional">Contact</span> type has been set to that string.</div><div id="Sec10" class="Section3 RenderAsSection3"><h4 class="Heading">Reference types provided by the API</h4><div class="Para">Excluding the collection types (which are covered in the next subsection of this chapter below), Table <span class="InternalRef"><a href="#Tab3">2-3</a></span> lists the reference types implemented by the API and available to TouchDevelop scripts. The table explicitly indicates whether storage for an instance of each type is allocated on the heap or is external to the TouchDevelop script.
<div id="Tab3" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2-3</span><div class="SimplePara">Reference types provided by the API</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="center"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Reference Type</div></th><th align="left"><div class="SimplePara">Description</div></th><th align="left"><div class="SimplePara">Storage</div></th><th align="center"><div class="SimplePara">Covered in Chapter</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Appointment</span>
                          </div></td><td align="left"><div class="SimplePara">A calendar appointment</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Board</span>
                          </div></td><td align="left"><div class="SimplePara">A 2D canvas on which sprites can be drawn and moved</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">9</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Camera</span>
                          </div></td><td align="left"><div class="SimplePara">The front or back camera</div></td><td align="left"><div class="SimplePara">External</div></td><td align="center"><div class="SimplePara">6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Contact</span>
                          </div></td><td align="left"><div class="SimplePara">Contact information and details about a person or company</div></td><td align="left"><div class="SimplePara">External</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Form Builder</span>
                          </div></td><td align="left"><div class="SimplePara">Used to create HTML form data</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">--</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Json Builder</span>
                          </div></td><td align="left"><div class="SimplePara">A JSON data structure builder</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">--</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Json Object</span>
                          </div></td><td align="left"><div class="SimplePara">A JSON data structure (obtained from a website)</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">4</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Link</span>
                          </div></td><td align="left"><div class="SimplePara">A link to a video, image, e-mail or phone number</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">5,6,8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Location</span>
                          </div></td><td align="left"><div class="SimplePara">A geographic location</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">7,8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Map</span>
                          </div></td><td align="left"><div class="SimplePara">A BING map</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Matrix</span>
                          </div></td><td align="left"><div class="SimplePara">a 2-D matrix of numbers</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">--</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Media Link</span>
                          </div></td><td align="left"><div class="SimplePara">A media file on the home network</div></td><td align="left"><div class="SimplePara">External</div></td><td align="center"><div class="SimplePara">5,6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Message</span>
                          </div></td><td align="left"><div class="SimplePara">A posting on a message board</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">OAuth Response</span>
                          </div></td><td align="left"><div class="SimplePara">OAuth 2.0 access token or error</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">11</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Page</span>
                          </div></td><td align="left"><div class="SimplePara">A page on the wall</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">3</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Page Button</span>
                          </div></td><td align="left"><div class="SimplePara">A button on the wall which can be tapped</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">3</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Picture</span>
                          </div></td><td align="left"><div class="SimplePara">A rectangular picture containing graphics or a photograph</div></td><td align="left"><div class="SimplePara">External</div></td><td align="center"><div class="SimplePara">6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Picture Album</span>
                          </div></td><td align="left"><div class="SimplePara">A named album of pictures</div></td><td align="left"><div class="SimplePara">External</div></td><td align="center"><div class="SimplePara">6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Place</span>
                          </div></td><td align="left"><div class="SimplePara">A named location</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Playlist</span>
                          </div></td><td align="left"><div class="SimplePara">A song playlist</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">5</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Song</span>
                          </div></td><td align="left"><div class="SimplePara">A song</div></td><td align="left"><div class="SimplePara">External</div></td><td align="center"><div class="SimplePara">5</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Song Album</span>
                          </div></td><td align="left"><div class="SimplePara">A song album</div></td><td align="left"><div class="SimplePara">External</div></td><td align="center"><div class="SimplePara">5</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Sound</span>
                          </div></td><td align="left"><div class="SimplePara">A sound clip</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">5</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Sprite</span>
                          </div></td><td align="left"><div class="SimplePara">A graphical object which can be displayed on a Board instance</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">9</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">TextBox</span>
                          </div></td><td align="left"><div class="SimplePara">A box used to display text on the screen</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Web Request</span>
                          </div></td><td align="left"><div class="SimplePara">A HTTP web request</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">4</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Web Response</span>
                          </div></td><td align="left"><div class="SimplePara">A HTTP web response</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">4</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                            <span class="EmphasisFontCategoryNonProportional">Xml Object</span>
                          </div></td><td align="left"><div class="SimplePara">A XML element or collection of elements</div></td><td align="left"><div class="SimplePara">Heap</div></td><td align="center"><div class="SimplePara">4</div></td></tr></tbody></table></div>
              </div></div><div id="Sec11" class="Section3 RenderAsSection3"><h4 class="Heading">Collection types</h4><div class="Para">The API also provides homogeneous collections. A collection contains zero or more elements whose type is one of the value types or one of the reference types listed in Table <span class="InternalRef"><a href="#Tab2">2-2</a></span>. Collections are provided for many of the possible element types. When a collection type has not been provided, an equivalent list type can be defined instead using an <span class="EmphasisTypeItalic">Object</span> declaration (see <span class="EmphasisFontCategoryNonProportional">Objects</span> and <span class="EmphasisFontCategoryNonProportional">Decorators</span>, below).</div><div class="Para">Some collections correspond to resources provided on a Windows Phone (and therefore may not be supported on other platforms), such as a collection of stored songs, and such collections are immutable. Other collections are mutable, meaning that new elements can be inserted into the collection and/or elements may be deleted.</div><div class="Para">The collection types provided by the API are listed in Table <span class="InternalRef"><a href="#Tab4">2-4</a></span> and Table <span class="InternalRef"><a href="#Tab5">2-5</a></span>. Three of the collection types have been tagged as special and are listed separately in Table <span class="InternalRef"><a href="#Tab5">2-5</a></span>. These three collection types have some special properties not possessed by the other collection types and need some additional explanation.</div></div></div><div id="Sec12" class="Section2 RenderAsSection2"><h3 class="Heading">Tables and indexes</h3><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Records</span> section of a TouchDevelop script can contain definitions of <span class="EmphasisFontCategoryNonProportional">Tables</span>. Each <span class="EmphasisTypeItalic">Table type</span> is a datatype with a single instance and is globally visible. It corresponds to a database table which consists of rows and whose fields are organized into columns. The <span class="EmphasisFontCategoryNonProportional">Records</span> section can also contain definitions for <span class="EmphasisFontCategoryNonProportional">Index</span> types.</div></div><div id="Sec13" class="Section2 RenderAsSection2"><h3 class="Heading">Objects</h3><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Records</span> section of a script can include declarations for <span class="EmphasisFontCategoryNonProportional">Object</span> types. Each <span class="EmphasisFontCategoryNonProportional">Object</span> type is a new datatype which is composed from named fields, similar to a <span class="EmphasisFontCategoryNonProportional">struct</span> or <span class="EmphasisFontCategoryNonProportional">class</span> type in other languages. Storage for instances of <span class="EmphasisFontCategoryNonProportional">Object</span> types is allocated on the heap and is garbage collected. Since it is heap allocated, every <span class="EmphasisFontCategoryNonProportional">Object</span> type is a <span class="EmphasisTypeItalic">Reference type</span>.
<div id="Tab4" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2-4</span><div class="SimplePara">Regular collection types</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="center"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Collection Type</div></th><th align="left"><div class="SimplePara">Element Type</div></th><th align="left"><div class="SimplePara">Mutable?</div></th><th align="center"><div class="SimplePara">Covered in Chapter</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Appointment Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Appointment</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Contact Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Contact</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Link Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Link</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Location Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Location</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">7,8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Media Link Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Media Link</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">5,6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Message Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Message</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Number Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">2</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Page Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Page</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">3</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Picture Albums</span>
                        </div></td><td align="left"><div class="SimplePara">Picture Album</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Pictures</span>
                        </div></td><td align="left"><div class="SimplePara">Picture</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">6</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Place Collection</span>
                        </div></td><td align="left"><div class="SimplePara">Place</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">8</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Playlists</span>
                        </div></td><td align="left"><div class="SimplePara">Playlist</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">5</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Song Albums</span>
                        </div></td><td align="left"><div class="SimplePara">Song Album</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">5</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">Songs</span>
                        </div></td><td align="left"><div class="SimplePara">Song</div></td><td align="left"><div class="SimplePara">No</div></td><td align="center"><div class="SimplePara">5</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">String Collection</span>
                        </div></td><td align="left"><div class="SimplePara">String</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">2</div></td></tr></tbody></table></div>
              <div id="Tab5" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2-5</span><div class="SimplePara">Special collection types</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="center"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Collection Type</div></th><th align="left"><div class="SimplePara">Element Type</div></th><th align="left"><div class="SimplePara">Mutable?</div></th><th align="center"><div class="SimplePara">Covered in Chapter</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">Number Map</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">2</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">String Map</div></td><td align="left"><div class="SimplePara">String</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">2</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">Sprite Set</div></td><td align="left"><div class="SimplePara">Sprite</div></td><td align="left"><div class="SimplePara">Yes</div></td><td align="center"><div class="SimplePara">9</div></td></tr></tbody></table></div>
            </div></div><div id="Sec14" class="Section2 RenderAsSection2"><h3 class="Heading">Decorators</h3><div class="Para">Decorators may be declared in the Records section of a script. A decorator is used to associate extra information with instances of some reference types. The types which can be decorated are <span class="EmphasisFontCategoryNonProportional">Appointment</span>, <span class="EmphasisFontCategoryNonProportional">Board</span>, <span class="EmphasisFontCategoryNonProportional">Json Object</span>, Link, <span class="EmphasisFontCategoryNonProportional">Map</span>, <span class="EmphasisFontCategoryNonProportional">Message</span>, <span class="EmphasisFontCategoryNonProportional">Page</span>, <span class="EmphasisFontCategoryNonProportional">Page Button</span>, <span class="EmphasisFontCategoryNonProportional">Place</span>, <span class="EmphasisFontCategoryNonProportional">Sound</span>, <span class="EmphasisFontCategoryNonProportional">Sprite</span>, <span class="EmphasisFontCategoryNonProportional">TextBox</span>, <span class="EmphasisFontCategoryNonProportional">Tile</span>, <span class="EmphasisFontCategoryNonProportional">Web Request</span>, <span class="EmphasisFontCategoryNonProportional">Web Response</span>, <span class="EmphasisFontCategoryNonProportional">Xml Object</span> and <span class="EmphasisFontCategoryNonProportional">Sprite Set</span>. User-defined objects can be decorated as well.</div></div><div id="Sec15" class="Section2 RenderAsSection2"><h3 class="Heading">Global persistent data</h3><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Data</span> section of a TouchDevelop script may contain declarations for global variables. Each of these variables has a datatype which must be one of the types provided in the language or API or one of the <span class="EmphasisTypeItalic">Object</span> types declared in the <span class="EmphasisFontCategoryNonProportional">Records</span> section of the script.</div><div class="Para">Any global variable declared to have a simple type or the <span class="EmphasisFontCategoryNonProportional">DateTime</span> type is initialized to a neutral value. The neutral values are <span class="EmphasisFontCategoryNonProportional">0</span> for a <span class="EmphasisFontCategoryNonProportional">Number</span>, <span class="EmphasisFontCategoryNonProportional">false</span> for a <span class="EmphasisFontCategoryNonProportional">Boolean</span>, <span class="EmphasisFontCategoryNonProportional">“”</span> for a <span class="EmphasisFontCategoryNonProportional">String</span>, and 1/1/0001 12:00:00 AM for a <span class="EmphasisFontCategoryNonProportional">DateTime</span> variable. A variable with any other type is initialized to a special <span class="EmphasisTypeItalic">invalid value</span>.</div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">is invalid</span> method is provided for every datatype and may be used to test whether a global variable has not yet been initialized or a value was unobtainable. For example, if the <span class="EmphasisFontCategoryNonProportional">Data</span> section of the script contains a declaration for the global variable <span class="EmphasisFontCategoryNonProportional">MyFriends</span> with the type <span class="EmphasisFontCategoryNonProportional">String Collection</span>, then this script might contain statements like the following to check whether the variable needs to be initialized.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
              <span class="EmphasisFontCategoryNonProportional">◳MyFriends → is invalid</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
            </div><div class="Para ParaTypeProgramcode">          <span class="EmphasisFontCategoryNonProportional">// it’s the first use of this script, initialize the global variable</span>
            </div><div class="Para ParaTypeProgramcode">          <span class="EmphasisFontCategoryNonProportional">◳MyFriends := collections → create string collection</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">else</span></span>
            </div><div class="Para ParaTypeProgramcode">          <span class="EmphasisFontCategoryNonProportional">// do nothing</span>
            </div><div class="Para">The values held by many of the global variables persist from one execution of the script to the next because they are held in the phone’s memory. The only ways to ‘forget’ these values are to uninstall the script or edit the script and delete the global variables.</div></div><div id="Sec16" class="Section2 RenderAsSection2"><h3 class="Heading">Art items</h3><div class="Para">Some scripts need to display pictures or to produce sounds. These pictures or sounds can be added to the script as global constants and become part of the script. Such items are held in the <span class="EmphasisFontCategoryNonProportional">Art</span> section of the script. In addition, the <span class="EmphasisFontCategoryNonProportional">Art</span> section can contain definitions for particular colors which will be needed by the script.</div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Art</span> section of the script is similar to the <span class="EmphasisFontCategoryNonProportional">Data</span> section except that the items are restricted to having one of the datatypes <span class="EmphasisFontCategoryNonProportional">Color</span>, <span class="EmphasisFontCategoryNonProportional">Picture</span> or <span class="EmphasisFontCategoryNonProportional">Sound</span>, and these items are initialized. Initialization for a <span class="EmphasisFontCategoryNonProportional">Color</span> value is provided via an ARGB (alpha, red, green, blue) value; initialization for <span class="EmphasisFontCategoryNonProportional">Picture</span> or <span class="EmphasisFontCategoryNonProportional">Sound</span> values is obtained by downloading the desired value from a web site.</div></div></div><div id="Sec17" class="Section1 RenderAsSection1"><h2 class="Heading">Expressions</h2><div id="Sec18" class="Section2 RenderAsSection2"><h3 class="Heading">Constants</h3><div class="Para">Explicit constants of type <span class="EmphasisFontCategoryNonProportional">Number</span>, <span class="EmphasisFontCategoryNonProportional">String</span> and <span class="EmphasisFontCategoryNonProportional">Boolean</span> can be directly entered into scripts using the editor. Named constants with the types <span class="EmphasisFontCategoryNonProportional">Color</span>, <span class="EmphasisFontCategoryNonProportional">Picture</span> and <span class="EmphasisFontCategoryNonProportional">Sound</span> can also be incorporated into a script, but their values have to be specified through special mechanisms and these values are accessed through the use of entries in the <span class="EmphasisFontCategoryNonProportional">Art</span> section of a script. Finally, there is a special kind of constant, <span class="EmphasisFontCategoryNonProportional">invalid</span>, which is provided for every datatype.</div><div id="Sec19" class="Section3 RenderAsSection3"><h4 class="Heading">Explicit Constants</h4><div class="Para">
                <span class="EmphasisFontCategoryNonProportional">Number</span> constants are written in the usual formats for non-negative decimal integers and non-negative decimal fixed-point constants. The maximum value, minimum value and precision correspond to the IEEE 754 standard for 64 bit floating point numbers. Integers with magnitudes up to approximately 10<sup>14</sup> are represented exactly. Larger values are subject to round-off error. These are some examples of valid <span class="EmphasisFontCategoryNonProportional">Number</span> constants.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">0  23  001  3.14159  100000.99</span>
              </div><div class="Para">Note that it is not possible to write a negative numeric constant. Thus, the parentheses are necessary in the following statement.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">(- 3) → post to wall</span>
              </div><div class="Para">The value being printed is an expression composed of the unary negation operator applied to the positive constant 3. If the parentheses are omitted, a semantic error is reported.</div><div class="Para">
                <span class="EmphasisFontCategoryNonProportional">String</span> constants can be entered with the TouchDevelop editor and can directly contain any characters provided on the keyboard. Although strings are implemented as sequences of Unicode characters, no mechanism is provided for including an arbitrary Unicode character in a string constant. (The full complement of Unicode characters is available only through the <span class="EmphasisFontCategoryNonProportional">to character</span> method of the <span class="EmphasisFontCategoryNonProportional">Number</span> type.) Some examples of <span class="EmphasisFontCategoryNonProportional">String</span> constants are as follows.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">“”  “abc”  “hello there”</span>
              </div><div class="Para">The two <span class="EmphasisFontCategoryNonProportional">Boolean</span> constants can be entered directly using the editor. They appear in scripts as follows.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">true  false</span>
              </div></div><div id="Sec20" class="Section3 RenderAsSection3"><h4 class="Heading">Named constants</h4><div class="Para">The TouchDevelop WebApp editor provides a mechanism to add named constants of type <span class="EmphasisFontCategoryNonProportional">Color Sound Picture String</span> and <span class="EmphasisFontCategoryNonProportional">Number</span> to the <span class="EmphasisTypeBold">art</span> section of a script. Tapping the plus symbol below the <span class="EmphasisTypeItalic">art</span> heading in the editor window and choosing Color as the type of the new resource brings up a window to select a new color. Four sliders allow the alpha, red, green and blue components of the color to be independently varied, with the effect shown on the screen.</div><div class="Para">Several predefined color constants can also be accessed via the <span class="EmphasisFontCategoryNonProportional">colors</span> resource in the API. For example, the name <span class="EmphasisFontCategoryNonProportional">colors</span> → <span class="EmphasisFontCategoryNonProportional">blue</span> refers to the color blue which has the ARGB encoding <span class="EmphasisFontCategoryNonProportional">#FF0000FF</span>. A complete list of the predefined colors which can be accessed via the <span class="EmphasisFontCategoryNonProportional">colors</span> resource is given in Appendix B.</div><div class="Para">Selecting Picture as the type for the <span class="EmphasisTypeItalic">art</span> resource causes a menu of choices to be displayed. One choice, labeled upload, allows you to select an image on your device and upload it to a Microsoft website where it is accessible via its URL. Other choices allow images already available on the web to be selected. The image is then added to the Art section of the current script.</div><div class="Para">Selecting Sound as the type leads to similar choices as for an image.</div><div class="Para">Named constants of type Number and String are equally as accessible in a script as global data variables with these types. However data variables require initialization when the script is run, and they are not protected against being modified. A named constant, on the other hand, is initialized when the script is created and cannot be modified by assignments performed in the script.</div></div><div id="Sec21" class="Section3 RenderAsSection3"><h4 class="Heading">The invalid value</h4><div class="Para">The resource named <span class="EmphasisFontCategoryNonProportional">invalid</span> provides an invalid value specific to each datatype. For example, the following statement assigns the invalid value of type <span class="EmphasisFontCategoryNonProportional">DateTime</span> to variable <span class="EmphasisFontCategoryNonProportional">x</span>.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">x := invalid → datetime</span>
              </div><div class="Para">A complete list of the possible invalid values provided by the <span class="EmphasisFontCategoryNonProportional">invalid</span> resource appears in Appendix B.</div></div></div><div id="Sec22" class="Section2 RenderAsSection2"><h3 class="Heading">Variables</h3><div class="Para">A script can access and assign to local variables, global data variables and parameters of the current action.</div><div id="Sec23" class="Section3 RenderAsSection3"><h4 class="Heading">Local variables</h4><div class="Para">Local variables follow the usual visibility rules and lifetime rules for block structured languages. The name of the variable is visible from the point of declaration down to the end of the block in which the declaration appears. Storage for the variable’s value, if the type is a value type, is provided only while the block is active. If the type is a reference type, then storage for the reference is only provided while the block is active.</div><div class="Para">A local variable must be declared and initialized before it can be used. A declaration statement serves both purposes. For example, the following statement declares and initializes a <span class="EmphasisFontCategoryNonProportional">String</span> variable.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
                <span class="EmphasisFontCategoryNonProportional">s1 := “Hello!”</span>
              </div><div class="Para">Following that declaration and down to the end of the enclosing block, the name <span class="EmphasisFontCategoryNonProportional">s1</span> can be used to reference the local variable’s current value.</div><div class="Para">Unlike most programming languages, the name <span class="EmphasisFontCategoryNonProportional">s1</span>
                <span class="EmphasisTypeItalic">cannot be hidden</span> by a declaration for another variable named <span class="EmphasisFontCategoryNonProportional">s1</span> inside a nested block. The TouchDevelop editor simply does not permit two variables with the same name to be declared inside an action; it forces all the parameters and local variables in an action to have distinct names.</div></div><div id="Sec24" class="Section3 RenderAsSection3"><h4 class="Heading">Global data variables</h4><div class="Para">The <span class="EmphasisTypeBold">data</span> section of a script contains declarations for variables which are accessible by all actions within the script. Storage for these variables is permanently allocated in most cases, and would therefore persist between invocations of the script. However, variables which require significant storage and which are normally recomputed whenever the script is executed, such as an instance of the Board type, do not persist between uses of the script.</div><div class="Para">A global data variable is created either by tapping the <span class="EmphasisTypeItalic">plus</span> button underneath the heading for the <span class="EmphasisTypeBold">data</span> section of the script or by declaring a local variable in an action or event and then using the ‘promote to global’ feature of the TouchDevelop editor.</div><div class="Para">A global data variable may be created with any datatype. If the type is <span class="EmphasisFontCategoryNonProportional">Number</span>, <span class="EmphasisFontCategoryNonProportional">Boolean</span>, <span class="EmphasisFontCategoryNonProportional">String</span> or <span class="EmphasisFontCategoryNonProportional">DateTime</span>, the variable has a neutral initial value. The value is <span class="EmphasisFontCategoryNonProportional">0, false</span>, <span class="EmphasisFontCategoryNonProportional">“”</span> or <span class="EmphasisFontCategoryNonProportional">1 January 0001 12:00 am</span> respectively. For any other datatype, the initial value is <span class="EmphasisFontCategoryNonProportional">invalid</span>.</div><div class="Para">An access to a global data variable inside a script is indicated by the special symbol <span class="EmphasisFontCategoryNonProportional">◳</span>. For example, the following statement assigns a value to a global variable of type <span class="EmphasisFontCategoryNonProportional">Board</span>.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">◳game := media → create board(480)</span>
              </div><div class="Para">A reference to a global data variable is inserted into the script by tapping the keypad tile labeled <span class="EmphasisFontCategoryNonProportional">◳data</span> and then a tile labeled with the variable’s name.</div></div><div id="Sec25" class="Section3 RenderAsSection3"><h4 class="Heading">Action parameters</h4><div class="Para">Parameters of an action are variables but with special properties. Zero or more input parameters and zero or more result parameters can be associated with the action by editing its properties. An input parameter can be added to an action by first displaying the code for the action, then tapping the first line of the action (where its name appears) to display information about the action. A plus button labeled “add input parameter” is displayed beneath that information. An input parameter can have any datatype except the <span class="EmphasisFontCategoryNonProportional">Nothing</span> type. A <span class="EmphasisFontCategoryNonProportional">result</span> parameter is similarly created by tapping the plus button labeled “add output parameter”. It too can have any type other than <span class="EmphasisFontCategoryNonProportional">Nothing</span>.</div><div class="Para">A result parameter is special in that it has an initial value of <span class="EmphasisFontCategoryNonProportional">invalid</span> and that every execution path through the action must assign a value to it.</div><div class="Para">Other than that special requirement, the input parameters and the output parameters can be used within the action as though they were local variables.</div></div></div><div id="Sec26" class="Section2 RenderAsSection2"><h3 class="Heading">Operators</h3><div class="Para">With the exception of string concatenation, there are no implicit conversions; and none of the operators is overloaded. Therefore, except for string concatenation, each operator can be applied only to particular datatypes. The operators and the associated datatypes for the operands and result are summarized in Table <span class="InternalRef"><a href="#Tab6">2-6</a></span>.
<div id="Tab6" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2-6</span><div class="SimplePara">Operators</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Operator</div></th><th align="left"><div class="SimplePara">Operand Types</div></th><th align="left"><div class="SimplePara">Result Type</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">+</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">prefix unary plus</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">-</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">prefix unary minus</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">+</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">addition</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">-</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">subtraction</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">*</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">multiplication</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">/</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Number</div></td><td align="left"><div class="SimplePara">division</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">&lt;</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">less-than comparison</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">≤</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">less-than-or-equal comparison</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">&gt;</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">greater-than comparison</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">≥</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">greater-than-or-equal comparison</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">=</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">equals comparison</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">≠</div></td><td align="left"><div class="SimplePara">Number Number</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">not equals comparison</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">not</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">logical negation</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">and</div></td><td align="left"><div class="SimplePara">Boolean Boolean</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">logical and</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">or</div></td><td align="left"><div class="SimplePara">Boolean Boolean</div></td><td align="left"><div class="SimplePara">Boolean</div></td><td align="left"><div class="SimplePara">logical or</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">||</div></td><td align="left"><div class="SimplePara">any any</div></td><td align="left"><div class="SimplePara">String</div></td><td align="left"><div class="SimplePara">string concatenation</div></td></tr></tbody></table></div>
            </div><div class="Para">The operands of the string concatenation operand may have <span class="EmphasisTypeItalic">almost</span> any datatype. The values of the two operands are converted to type <span class="EmphasisFontCategoryNonProportional">String</span> before concatenation proceeds.</div></div><div id="Sec27" class="Section2 RenderAsSection2"><h3 class="Heading">Calling an action</h3><div class="Para">An action which has a single result parameter can be used in any context where an expression is permitted. Actions are covered in detail in section 2.5, below.</div></div><div id="Sec28" class="Section2 RenderAsSection2"><h3 class="Heading">Calling an API method</h3><div class="Para">The API provides many methods which return single results. An invocation of any of these methods can be used in a context where an expression is permitted. The methods may be associated with resources, such as <span class="EmphasisFontCategoryNonProportional">media</span> or <span class="EmphasisFontCategoryNonProportional">languages</span>, or they may be methods of datatypes defined in the API such as <span class="EmphasisFontCategoryNonProportional">Contact</span> or <span class="EmphasisFontCategoryNonProportional">Link Collection</span>.</div></div></div><div id="Sec29" class="Section1 RenderAsSection1"><h2 class="Heading">Statements</h2><div id="Sec30" class="Section2 RenderAsSection2"><h3 class="Heading">Expression</h3><div class="Para">Any expression may be used as a statement. For example, this is a valid statement:</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">“Hello “ || “ there!”</span>
            </div><div class="Para">However, this particular statement is useless. The value of the expression is simply discarded. The use of an expression as a statement is only useful if evaluation of the statement has a side-effect. For example,</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">(“Hello “ || “ there!”) → post to wall</span>
            </div><div class="Para">This expression evaluates to the special value nothing. However evaluation also has the side-effect of displaying a string on the screen.</div><div class="Para">An invocation of any action or API method which returns results can be used as a statement; the results are simply discarded.</div></div><div id="Sec31" class="Section2 RenderAsSection2"><h3 class="Heading">Declaration and assignment</h3><div class="Para">A declaration of a local variable is combined with an assignment to initialize the variable. The datatype of the initialization expression determines the datatype of the variable. For example, the following statement creates a local variable whose type is <span class="EmphasisFontCategoryNonProportional">Location Collection</span>.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">places := collections → create location collection</span>
            </div><div class="Para">Assignments may also assign values to existing variables. For example, the script can replace the value of the places variable declared above. A possible statement which does that is the following.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">places := invalid → location collection</span>
            </div><div class="Para">If an action has more than one return parameter, an assignment statement can be used to assign all the results simultaneously. For example, if the script contains an action named <span class="EmphasisFontCategoryNonProportional">Get Address Info</span> which returns a <span class="EmphasisFontCategoryNonProportional">String</span> and a <span class="EmphasisFontCategoryNonProportional">Number</span> as its two results, the action can be invoked with code like the following.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">street name := “”</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">street number := 0</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">street name, street number := ▷Get Address Info(“Joanie”)</span>
            </div><div class="Para">Either all the results or none of the results must be assigned. It is not possible to assign some results and discard the other results.</div></div><div id="Sec32" class="Section2 RenderAsSection2"><h3 class="Heading">If statement</h3><div class="Para">The TouchDevelop editor always generates the <span class="EmphasisFontCategoryNonProportional">if-then-else</span> form for an <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span> statement, supplying empty bodies for the <span class="EmphasisFontCategoryNonProportional">then</span> clause and the <span class="EmphasisFontCategoryNonProportional">else</span> clause. Either or both of these clauses may subsequently be replaced with statement lists. The expression following the keyword <span class="EmphasisFontCategoryNonProportional">if</span> is an expression which must evaluate to a <span class="EmphasisFontCategoryNonProportional">Boolean</span> value. As usual, if the expression evaluates to <span class="EmphasisFontCategoryNonProportional">true</span>, the <span class="EmphasisFontCategoryNonProportional">then</span> clause is executed next and the <span class="EmphasisFontCategoryNonProportional">else</span> clause is skipped. Otherwise the reverse happens, the <span class="EmphasisFontCategoryNonProportional">then</span> clause is skipped and the <span class="EmphasisFontCategoryNonProportional">else</span> clause is executed.</div><div class="Para">For example, the following code determines the minimum of three values a, b and c.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
              <span class="EmphasisFontCategoryNonProportional">a &lt; b</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
              <span class="EmphasisFontCategoryNonProportional">a &lt; c</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
            </div><div class="Para ParaTypeProgramcode">                     <span class="EmphasisFontCategoryNonProportional">min := a</span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">else</span></span>
            </div><div class="Para ParaTypeProgramcode">                     <span class="EmphasisFontCategoryNonProportional">min := c</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">else</span></span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
              <span class="EmphasisFontCategoryNonProportional">b &lt; c</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
            </div><div class="Para ParaTypeProgramcode">                     <span class="EmphasisFontCategoryNonProportional">min := b</span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">else</span></span>
            </div><div class="Para ParaTypeProgramcode">                     <span class="EmphasisFontCategoryNonProportional">min := c</span>
            </div></div><div id="Sec33" class="Section2 RenderAsSection2"><h3 class="Heading">While loop</h3><div class="Para">A <span class="EmphasisTypeBold">while</span> loop has a controlling expression which must evaluate to a <span class="EmphasisFontCategoryNonProportional">Boolean</span> value. The loop body is repeatedly executed as long as the controlling expression evaluates to true.</div><div class="Para">For example, the following code searches for any song stored on a Windows phone whose duration exceeds 10 minutes.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">long song := invalid → song</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">my music := media → songs</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">num songs := my music → count</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">i := 0</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">while</span></span>
              <span class="EmphasisFontCategoryNonProportional">i &lt; num songs</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">and</span></span>
              <span class="EmphasisFontCategoryNonProportional">long song → is invalid</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">do</span></span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">sng := my music → at(i)</span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
              <span class="EmphasisFontCategoryNonProportional">sng→ duration &gt; 10*60</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
            </div><div class="Para ParaTypeProgramcode">                  <span class="EmphasisFontCategoryNonProportional">long song := sng</span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">else</span></span>
            </div><div class="Para ParaTypeProgramcode">                  <span class="EmphasisFontCategoryNonProportional">// do nothing</span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisFontCategoryNonProportional">i := i + 1</span>
            </div></div><div id="Sec34" class="Section2 RenderAsSection2"><h3 class="Heading">For loop</h3><div class="Para">The <span class="EmphasisTypeBold">for</span> loop in TouchDevelop is similar to <span class="EmphasisTypeBold">for</span> loops in other programming languages, but with some added constraints. The index variable must be a <span class="EmphasisFontCategoryNonProportional">Number</span>; it must be initialized to zero for the first iteration and it must be incremented in steps of one.</div><div class="Para">An example <span class="EmphasisTypeBold">for</span> loop which sums the integers from 0 to 99 would be as follows.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">sum := 0</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">for</span></span>
              <span class="EmphasisFontCategoryNonProportional">0 ≤ i &lt; 100</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">do</span></span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisFontCategoryNonProportional">sum := sum + i</span>
            </div><div class="Para">The index variable, <span class="EmphasisFontCategoryNonProportional">i</span>, in the example is a new local variable whose visibility is restricted to the <span class="EmphasisTypeBold">for</span> loop. It must be a uniquely named variable in the enclosing action. No assignments to the index variable are permitted within the loop body; this variable is restricted to being <span class="EmphasisTypeItalic">read-only</span>.</div></div><div id="Sec35" class="Section2 RenderAsSection2"><h3 class="Heading">For each loop</h3><div class="Para">A <span class="EmphasisTypeBold">for each</span> loop is used for iterating through all the elements of a collection. For example, this loop adds up the playing times of all songs stored on a Windows phone.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">total := 0</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">for each</span></span>
              <span class="EmphasisFontCategoryNonProportional">sng</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">in</span></span>
              <span class="EmphasisFontCategoryNonProportional">media→songs</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">where</span></span>
              <span class="EmphasisFontCategoryNonProportional">true</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">do</span></span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisFontCategoryNonProportional">total := total + sng → duration</span>
            </div><div class="Para ParaTypeProgramcode">    <span class="EmphasisFontCategoryNonProportional">(“Total playing time = “ || total/60 || “ minutes”) → post to wall</span>
            </div><div class="Para">Note that there is a <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">where</span></span> clause which may be used to select only some of the values in the collection. The TouchDevelop editor supplies a default value of true for the <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">where</span></span> clause, but it can be replaced by any expression which evaluates to a <span class="EmphasisFontCategoryNonProportional">Boolean</span> value.</div><div class="Para">As with a <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">for</span></span> loop, the index variable is a read-only variable and it is a new local variable whose visibility is restricted to the <span class="EmphasisFontCategoryNonProportional">for each</span> loop.</div></div></div><div id="Sec36" class="Section1 RenderAsSection1"><h2 class="Heading">Actions</h2><div id="Sec37" class="Section2 RenderAsSection2"><h3 class="Heading">Defining an action</h3><div class="Para">An action can have zero or more input parameters and zero or more result parameters. When there are zero result parameters, the action can be called only for its side effects. There is no value returned by the call in this case. When the action has two or more result parameters, the invocation can be used on the right-hand side of a multiple assignment statement or the invocation can be made for its side effects only (and any returned results are ignored). When the action has exactly one result parameter, an invocation returns a single value as the result and that value may be used in any context where an expression can occur.</div><div class="Para">For example, consider the action <span class="EmphasisFontCategoryNonProportional">Replicate</span> defined as follows.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">action</span></span>
              <span class="EmphasisFontCategoryNonProportional">Replicate( s: String, n: Number )</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">returns</span></span>
              <span class="EmphasisFontCategoryNonProportional">r: String</span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisFontCategoryNonProportional">r := “”</span>
            </div><div class="Para ParaTypeProgramcode">                <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">while</span></span>
              <span class="EmphasisFontCategoryNonProportional">n &gt; 0</span>
              <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">do</span></span>
            </div><div class="Para ParaTypeProgramcode">      <span class="EmphasisFontCategoryNonProportional">r := r || s</span>
            </div><div class="Para ParaTypeProgramcode">                  <span class="EmphasisFontCategoryNonProportional">n := n – 1</span>
            </div><div class="Para">The action can be invoked and its resulting value used in a statement like the following.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">(“The answer is “ || ▷Replicate(“NO! “, 10) || “forever!”)       → post to wall</span>
            </div><div class="Para">Immediately before the statements of the <span class="EmphasisFontCategoryNonProportional">Replicate</span> action are executed, the string <span class="EmphasisFontCategoryNonProportional">“NO!”</span> is copied into parameter <span class="EmphasisFontCategoryNonProportional">s</span>, 10 is copied into parameter <span class="EmphasisFontCategoryNonProportional">n</span> and the result parameter <span class="EmphasisFontCategoryNonProportional">r</span> is initialized to <span class="EmphasisFontCategoryNonProportional">invalid</span>. When the action has finished its execution, the final value of <span class="EmphasisFontCategoryNonProportional">r</span> is returned as the result.</div><div id="Sec38" class="Section3 RenderAsSection3"><h4 class="Heading">Public versus private</h4><div class="Para">When the properties of an action are accessed with the editor, the editor provides the ability to specify the input parameters, the result parameters, and to change the name of the action. There is also a checkbox which is labeled “<span class="EmphasisTypeItalic">private action</span>”. Leaving that box unchecked allows the action to be invoked directly. If a script has two or more actions (or <span class="EmphasisTypeItalic">pages</span>, as discussed in <span class="ExternalRef"><a href="A978-1-4302-6137-7_10_Chapter.html"><span class="RefSource">Chapter 10</span></a></span>) not tagged as private, the script has multiple entry points.</div><div class="Para">Another consequence of leaving the checkbox unticked is that the action can be invoked from another script when the script is published as a library. (See the subsection below on Library Scripts.)</div><div class="Para">Ticking the ‘private action’ checkbox restricts the action to being accessible only from other actions within the same script.</div></div></div><div id="Sec39" class="Section2 RenderAsSection2"><h3 class="Heading">Call and return</h3><div class="Para">An invocation of an action causes any arguments to be evaluated and copied to corresponding input parameters of the action, then the statements of the action are executed, and finally the values of any result parameters are copied back to the caller and made available as the value of the action.</div><div class="Para">A call to an action located in the same script is indicated by the code symbol, ▷.</div></div><div id="Sec40" class="Section2 RenderAsSection2"><h3 class="Heading">Input parameters</h3><div class="Para">The call by value parameter passing mechanism is used for input parameters. Each argument expression supplied by the caller is evaluated and assigned as an initial value to the corresponding parameter. In the case where the argument and parameter have a value type, a duplicate of the value is assigned to the parameter. When the argument and parameter have a reference type, it is the reference which is duplicated, so that the parameter references the same instance on the heap as supplied by the caller.</div></div><div id="Sec41" class="Section2 RenderAsSection2"><h3 class="Heading">Result parameters</h3><div class="Para">When an action is invoked, each result parameter is initialized to an <span class="EmphasisFontCategoryNonProportional">invalid</span> value of the correct type. There must be at least one assignment to each result parameter on every execution path which can be taken through the action. When control reaches the end of the action, the final values of the result parameters are returned as the results of the call.</div></div><div id="Sec42" class="Section2 RenderAsSection2"><h3 class="Heading">Calling a library action</h3><div class="Para">It is possible to invoke actions in a script which has been declared as a library. Each such library script must be added to the library section of the script. An imported script is given a name by the TouchDevelop editor (a name which is copied from the original script but can be changed later).</div><div class="Para">When editing code in the script, the editor provides a button labeled <span class="EmphasisFontCategoryNonProportional">♻libs</span>. Tapping this key inserts the symbol <span class="EmphasisFontCategoryNonProportional">♻</span> into the code and the editor then provides a choice between the various names used for the imported library scripts. Once a name has been selected, the editor allows any action in that library script, other than those marked as private, to be called.</div><div class="Para">For example, the library script turtle, published as <span class="EmphasisFontCategoryNonProportional">/sicm</span> on the TouchDevelop website, provides actions for drawing colored lines using a virtual pen (a scheme known as ‘turtle graphics’). To use this library in our own script S, one first adds the turtle script to the library section of S. The editor will use the name <span class="EmphasisFontCategoryNonProportional">turtle</span> for that library. Subsequently, actions and events defined in S can contain code like the following.</div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">♻turtle→initialize</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">♻turtle→pen down</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">♻turtle→pen color(colors→red)</span>
            </div><div class="Para ParaTypeProgramcode">        <span class="EmphasisFontCategoryNonProportional">♻turtle→forward(100)</span>
            </div><div id="Sec43" class="Section3 RenderAsSection3"><h4 class="Heading">Rebinding libraries</h4><div class="Para">If script S uses some actions in library L1 but another library L2 which implements the same actions becomes available, the editor provides the possibility to rebind S to use L2 instead of L1. A more complicated example of rebinding is possible if our script S uses library L1 and L1 in turns uses library L2. The libraries section of S can be edited so that references from L1 to actions in L2 can be bound instead to actions in another library L3 or to actions (with the correct signature) in S itself.</div></div><div id="Sec44" class="Section3 RenderAsSection3"><h4 class="Heading">Visibility</h4><div class="Para">Although the non-private actions of a library script are all visible, nothing else is visible. There is no direct access to any global data items or art items declared in the script. If the developer of the library wishes to permit such access, <span class="EmphasisTypeItalic">get</span> and <span class="EmphasisTypeItalic">set</span> actions must be provided in the library for returning or replacing the values of these items.</div></div></div></div><div id="Sec45" class="Section1 RenderAsSection1"><h2 class="Heading">Events</h2><div class="Para">In some respects, events are like actions. They contain code and some kinds of events take input parameters. However events cannot be called. They can only be invoked when something external to the script occurs. For example, shaking the phone is detected by the phone’s sensors and can cause the code for the shake event in the TouchDevelop script to be executed.</div><div class="Para">An event interrupts the normal execution of a script. However an event will never interrupt the code for another event. Instead, execution of the second event will wait until the executing event has finished.</div><div class="Para">If a script contains code for one or more events, the script will not terminate execution when it reaches the end of the action which was initially invoked. The script enters an internal wait loop where it waits for events to occur and to be executed. To force a script to stop execution, it is necessary to use one of the API methods <span class="EmphasisFontCategoryNonProportional">time</span>→<span class="EmphasisFontCategoryNonProportional">stop</span>, <span class="EmphasisFontCategoryNonProportional">time</span>→<span class="EmphasisFontCategoryNonProportional">stop</span> and <span class="EmphasisFontCategoryNonProportional">close or time</span>→<span class="EmphasisFontCategoryNonProportional">fail if not</span>.</div><div class="Para">The kinds of events and brief descriptions are listed in Table <span class="InternalRef"><a href="#Tab7">2-7</a></span>. There are additional events, described in Table <span class="InternalRef"><a href="#Tab8">2-8</a></span> which become available, if global data items of type <span class="EmphasisFontCategoryNonProportional">Board</span> and type <span class="EmphasisFontCategoryNonProportional">Sprite Set</span> have been declared. They are intended for use in games programs, and capture user interactions with the gameboard.
<div id="Tab7" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2-7</span><div class="SimplePara">Events</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Event</div></th><th align="left"><div class="SimplePara">Description of when invoked</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">gameloop</span>
                      </div></td><td align="left"><div class="SimplePara">Invoked every 50 milliseconds. Intended for updating a game display, but usable for other purposes.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">shake</span>
                      </div></td><td align="left"><div class="SimplePara">Device is shaken</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone face up</span>
                      </div></td><td align="left"><div class="SimplePara">Device is turned to be flat and face up</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone face down</span>
                      </div></td><td align="left"><div class="SimplePara">Device is turned to be flat and face down</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone portrait</span>
                      </div></td><td align="left"><div class="SimplePara">Device is turned upright</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone landscape left</span>
                      </div></td><td align="left"><div class="SimplePara">Device is placed on its left side</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone landscape right</span>
                      </div></td><td align="left"><div class="SimplePara">Device is placed on its right side</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">empty space on wall</span>
                      </div></td><td align="left"><div class="SimplePara">The user has scrolled to the bottom of the wall and/or space to display new output has become available</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">page navigated from</span>
                      </div></td><td align="left"><div class="SimplePara">The page displayed on the screen has been popped</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">active song changed</span>
                      </div></td><td align="left"><div class="SimplePara">The song being played by the phone has changed</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">player state changed</span>
                      </div></td><td align="left"><div class="SimplePara">The media player starts playing</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">camera button pressed</span>
                      </div></td><td align="left"><div class="SimplePara">Camera button on phone is pressed</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">camera button half pressed</span>
                      </div></td><td align="left"><div class="SimplePara">Camera button on phone is halfway pressed</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">camera button released</span>
                      </div></td><td align="left"><div class="SimplePara">Camera button on phone is released</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">tap wall</span>
                        <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">XXX</span></span>
                        <span class="EmphasisFontCategoryNonProportional">(item:</span>
                        <span class="EmphasisTypeItalic"><span class="EmphasisFontCategoryNonProportional">XXX</span></span>
                        <span class="EmphasisFontCategoryNonProportional">)</span>
                      </div></td><td align="left"><div class="SimplePara">A value of type <span class="EmphasisTypeItalic">XXX</span> displayed on the wall is tapped; this value is received as the input parameter. There is a different tap wall event for various types, represented by XXX.</div></td></tr></tbody></table></div>
          </div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">tap wall</span>
            <span class="EmphasisFontCategoryNonProportional">XXX</span> event in Table <span class="InternalRef"><a href="#Tab7">2-7</a></span> represents many events, where XXX can be any of the types <span class="EmphasisFontCategoryNonProportional">Appointment</span>, <span class="EmphasisFontCategoryNonProportional">Camera</span>, <span class="EmphasisFontCategoryNonProportional">Color</span>, <span class="EmphasisFontCategoryNonProportional">Contact</span>, <span class="EmphasisFontCategoryNonProportional">Device</span>, <span class="EmphasisFontCategoryNonProportional">Link</span>, <span class="EmphasisFontCategoryNonProportional">Media Player</span>, <span class="EmphasisFontCategoryNonProportional">Message</span>, <span class="EmphasisFontCategoryNonProportional">Page Button</span>, <span class="EmphasisFontCategoryNonProportional">Picture</span>, <span class="EmphasisFontCategoryNonProportional">Picture Album</span>, <span class="EmphasisFontCategoryNonProportional">Place</span>, <span class="EmphasisFontCategoryNonProportional">Playlist</span>, <span class="EmphasisFontCategoryNonProportional">Printer</span>, <span class="EmphasisFontCategoryNonProportional">Song</span>, <span class="EmphasisFontCategoryNonProportional">Sound</span>, <span class="EmphasisFontCategoryNonProportional">String</span>, <span class="EmphasisFontCategoryNonProportional">TextBox</span>, <span class="EmphasisFontCategoryNonProportional">Tile</span>, <span class="EmphasisFontCategoryNonProportional">Vector3</span> or any object type defined in the Records section of the script.
<div id="Tab8" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2-8</span><div class="SimplePara">Gameboard events</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Event</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">tap board(x: Number, y: Number)</span>
                      </div></td><td align="left"><div class="SimplePara">The gameboard has been tapped at coordinates x, y.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">swipe board(x: Number, y: Number, delta x: Number, delta y: Number)</span>
                      </div></td><td align="left"><div class="SimplePara">The gameboard has been swiped, starting at coordinates x, y and continuing along the vector delta x, delta y.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">tap sprite in sprite set(</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">sprite: Sprite, index in set: Number, x: Number, y: Number)</span>
                      </div></td><td align="left"><div class="SimplePara">A sprite in the sprite set has been tapped; the first two parameters specify which sprite and the last two give the x, y coordinates of the sprite.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">swipe sprite in sprite set(sprite: Sprite, index in set: Number, x: Number, y: Number, delta x: Number, delta y: Number)</span>
                      </div></td><td align="left"><div class="SimplePara">A sprite in the sprite set has been swiped; the first two parameters specify which sprite, the next two give the x, y coordinates of the sprite, and the last two give the vector describing the swipe motion.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">drag sprite in sprite set(sprite: Sprite, index in set: Number, x: Number, y: Number, delta x: Number, delta y: Number)</span>
                      </div></td><td align="left"><div class="SimplePara">A sprite in the sprite set has been dragged; the first two parameters specify which sprite, the next two give the x, y coordinates of the sprite, and the last two give the vector describing the dragging motion.</div></td></tr></tbody></table></div>
          </div></div><div id="Sec46" class="Section1 RenderAsSection1"><h2 class="Heading">Pages</h2><div class="Para">Pages are a recent addition to the TouchDevelop language. They provide the script writer with the tools to develop sophisticated user interfaces. Pages are added to a script in a similar way to actions or events and, like them, contain statements to be executed.</div><div class="Para">A syntactic construct <span class="EmphasisTypeBold">boxed</span> is used as a wrapper for statement lists inside a page, where those statements create the content and style of a rectangular region of the screen display.</div><div class="Para">Pages and the <span class="EmphasisTypeBold">boxed</span> construct are covered in detail in <span class="ExternalRef"><a href="A978-1-4302-6137-7_10_Chapter.html"><span class="RefSource">Chapter 10</span></a></span>.</div></div><div id="Sec47" class="Section1 RenderAsSection1"><h2 class="Heading">Creating library scripts</h2><div class="Para">When a script’s properties are edited, there is an opportunity to tick a box labeled ‘this script is a library’. This enables all actions not flagged as private to be callable from other scripts on your phone. Publishing the script on the TouchDevelop website will allow other users to access the public actions included in the script.</div><div id="Sec48" class="Section2 RenderAsSection2"><h3 class="Heading">Implementation restrictions on libraries</h3><div class="Para">A library script cannot define any entries in its Events or Records sections. Items in the <span class="EmphasisFontCategoryNonProportional">Data</span> or <span class="EmphasisFontCategoryNonProportional">Art</span> sections of the library script can be directly accessed from other scripts. If such access is desirable, then additional actions to provide the desired form of access must be defined.</div></div></div></div></body></html>
