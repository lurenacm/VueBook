<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><title>Sensors</title><link href="springer_epub.css" type="text/css" rel="styleSheet"/></head><body><div class="ChapterContextInformation"><div class="ContextInformation" id="Chap7"><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">R. Nigel Horspool</span> and </span><span class="Author"><span class="AuthorName">Nikolai Tillmann</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" xml:lang="en">TouchDevelop: Programming on the Go</span><span class="BookEdition">Third Edition</span></span><span class="ChapterDOI">10.1007/978-1-4302-6137-7_7</span><span class="ChapterCopyright">© R. Nigel Horspool 2013</span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" xml:lang="en">7. Sensors</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">R. Nigel Horspool</span><sup>1 <span class="ContactIcon"/></sup> and </span><span class="Author"><span class="AuthorName">Nikolai Tillmann</span><sup>2 <span class="ContactIcon"/></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff1"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Canada, USA</div></div><div class="Affiliation" id="Aff2"><span class="AffiliationNumber">(2)</span><div class="AffiliationText">TU Berlin, Germany</div></div><div class="ClearBoth"> </div></div></div><div class="ArticleOrChapterToc"><div class="TocLine"><a href="#Sec1">7.1 The sensors</a></div><div class="TocLine"><a href="#Sec2">7.2 Sensor-driven events</a></div><div class="TocLine"><a href="#Sec4">7.3 Accelerometer</a></div><div class="TocLine"><a href="#Sec7">7.4 Compass</a></div><div class="TocLine"><a href="#Sec9">7.5 Gyroscope</a></div><div class="TocLine"><a href="#Sec10">7.6 Motion</a></div></div><div class="Abstract" id="Abs1" xml:lang="en"><div class="Heading">Abstract</div><div class="Para">A typical smartphone or tablet contains sensors which track the device’s location, movement and orientation. Scripts can use these sensors in many ways. Sensors can provide input for navigation aids, they can be an integral part of a game, and they can provide simple input to scripts. The possibilities are endless. These sensors are probably absent from laptops and computers, however.</div></div><!--End Abstract--><div class="Fulltext"><div class="Para">A typical smartphone or tablet contains sensors which track the device’s location, movement and orientation. Scripts can use these sensors in many ways. Sensors can provide input for navigation aids, they can be an integral part of a game, and they can provide simple input to scripts. The possibilities are endless. These sensors are probably absent from laptops and computers, however.</div><div id="Sec1" class="Section1 RenderAsSection1"><h2 class="Heading">7.1 The sensors</h2><div class="Para">The full complement of sensors supported by TouchDevelop may not be available on your device. The possible sensors are as follows.
<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">
                  <span class="EmphasisTypeItalic">GPS</span> (Global Positioning System), which obtains the phone’s current location on the map.</div></li><li><div class="Para">
                  <span class="EmphasisTypeItalic">Accelerometer</span>, which measures gravitational and acceleration forces experienced by the phone.</div></li><li><div class="Para">
                  <span class="EmphasisTypeItalic">Compass</span>, which returns the direction of magnetic north.</div></li><li><div class="Para">
                  <span class="EmphasisTypeItalic">Gyroscope</span>, which measures the phone’s orientation in 3D space.</div></li></ul></div>
          </div><div class="Para">A script’s access to the sensors is provided by calls to a variety of API methods and by events associated with the gyroscope and accelerometer. The API methods are listed in Table <span class="InternalRef"><a href="#Tab1">7-1</a></span>; the events are listed in Table <span class="InternalRef"><a href="#Tab2">7-2</a></span>.
<div id="Tab1" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 7-1</span><div class="SimplePara">Sensing methods of the senses service</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Accelerometer Methods</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">acceleration quick : Vector3</span>
                      </div></td><td align="left"><div class="SimplePara">Returns an acceleration averaged over a short time interval</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">acceleration smooth : Vector3</span>
                      </div></td><td align="left"><div class="SimplePara">Returns an acceleration averaged over a moderate time interval</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">acceleration stable : Vector3</span>
                      </div></td><td align="left"><div class="SimplePara">Returns an acceleration averaged over a time interval of about 0.5 seconds</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">is device stable : Boolean</span>
                      </div></td><td align="left"><div class="SimplePara">Returns true if the phone has not moved for about 0.5 seconds</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisTypeBold">Compass Methods</span>
                      </div></td><td align="left"><div class="SimplePara">
                        <span class="EmphasisTypeBold">Description</span>
                      </div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">heading : Number</span>
                      </div></td><td align="left"><div class="SimplePara">Returns the angle in degrees of magnetic north compared to the direction that the phone is facing</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisTypeBold">Gyroscope Methods</span>
                      </div></td><td align="left"><div class="SimplePara">
                        <span class="EmphasisTypeBold">Description</span>
                      </div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">has gyroscope : Boolean</span>
                      </div></td><td align="left"><div class="SimplePara">Returns true if the phone has a gyroscope</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">orientation : Vector3</span>
                      </div></td><td align="left"><div class="SimplePara">Obtains the current orientation in degrees with respect to the X, Y, Z axes, if available.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">rotation speed : Vector3</span>
                      </div></td><td align="left"><div class="SimplePara">Returns the rotational speed in degrees per second about each of the X, Y, Z axes</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisTypeBold">Motion Methods</span>
                      </div></td><td align="left"><div class="SimplePara">
                        <span class="EmphasisTypeBold">Description</span>
                      </div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">senses</span> → <span class="EmphasisFontCategoryNonProportional">motion : Boolean</span>
                      </div></td><td align="left"><div class="SimplePara">Returns the phone’s current motion, combining readings from accelerometer, compass and gyroscope</div></td></tr></tbody></table></div>
          </div></div><div id="Sec2" class="Section1 RenderAsSection1"><h2 class="Heading">7.2 Sensor-driven events</h2><div class="Para">If the device is shaken, the accelerometer records some rapidly changing readings. If the amplitude of the shaking exceeds a certain threshold, a shake event is triggered. A script can use the event to effect an action, such as pausing the playback of an audio recording.</div><div class="Para">The device’s software may be using the gyroscope to determine the screen’s orientation, and so to choose between portrait mode or landscape mode for presentation of information. Several possibilities for the orientation can be transmitted to a TouchDevelop script via the event mechanism.</div><div class="Para">The shake event and the phone orientation events are listed in Table <span class="InternalRef"><a href="#Tab2">7-2</a></span>.
<div id="Tab2" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 7-2</span><div class="SimplePara">Sensor events</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Event</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">shake</span>
                      </div></td><td align="left"><div class="SimplePara">Triggered when the phone is shaken</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone face up</span>
                      </div></td><td align="left"><div class="SimplePara">Triggered when the device is turned so that it is face up</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone face down</span>
                      </div></td><td align="left"><div class="SimplePara">Triggered when the device is turned so that it is face down</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone portrait</span>
                      </div></td><td align="left"><div class="SimplePara">Triggered when the device is turned so the screen in portrait mode (such as when the device is vertical)</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone landscape left</span>
                      </div></td><td align="left"><div class="SimplePara">Triggered when the device is turned so that its left side is facing down</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone landscape right</span>
                      </div></td><td align="left"><div class="SimplePara">Triggered when the device is turned so that its right side is facing down</div></td></tr></tbody></table></div>
          </div><div id="Sec3" class="Section2 RenderAsSection2"><h3 class="Heading">7.2.1 Example script: A pedometer (/jbpv)</h3><div class="Para">If you carry your smartphone with you when jogging or walking briskly, the phone’s sensors should trigger a <span class="EmphasisFontCategoryNonProportional">shake</span> event for each step taken. A simple script can record how many steps are taken, from which the number of steps per minute can be computed. By accessing the GPS location, the average speed can be determined too. However the script cannot simply use the starting location and ending location to determine the distance traveled, because that would give only the straight line distance between the two points. Determining the actual distance traveled requires checking the GPS location more frequently and summing lots of little distances.</div><div class="Para">The code for a simple Pedometer program is shown in Figure <span class="InternalRef"><a href="#Fig1">7-1</a></span>. Note that you will need to enable <span class="EmphasisTypeItalic">Location Services</span> in TouchDevelop’s settings for the script to work.</div></div></div><div id="Sec4" class="Section1 RenderAsSection1"><h2 class="Heading">7.3 Accelerometer</h2><div class="Para">Most Windows phones possess a device which measures the forces on a small mass. When the phone is held perfectly still, the only force will be gravity. If the phone is shaken or moved, the forces which are measured will combine acceleration with gravity. The measuring device is therefore known as an <span class="EmphasisTypeItalic">accelerometer</span>.</div><div class="Para">Gravitational force is always down, towards the ground. However, acceleration can be in any direction in three dimensional space. The accelerometer therefore returns a vector to show the current force in each of the three dimensions. In the TouchDevelop API, that vector is provided as a value with the <span class="EmphasisFontCategoryNonProportional">Vector3</span> datatype.
<div class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img src="A978-1-4302-6137-7_7_Fig1_HTML.jpg" alt="A978-1-4302-6137-7_7_Fig1_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-1</span><div class="SimplePara">A simple pedometer program (/jbpv)</div></div></div></div>
          </div><div class="Para">The senses methods which access the accelerometer are listed in Table <span class="InternalRef"><a href="#Tab1">7-1</a></span>. Three methods are provided for finding the phone’s acceleration. They are necessary because nothing in real life is perfectly motionless. Any sound or vibration induces small high frequency accelerations in an object. Obtaining steady repeatable readings requires averaging out the measurements over a period of time. Longer periods of time will yield very consistent measurements, but the script has to wait until that period has elapsed before a reading is available.</div><div class="Para">Long waits would be inappropriate for a game where the player is controlling the actions by moving the phone. Note that the accelerations measured by these three methods include gravitational force. A value of (0.0, 0.0, 0.0) for the acceleration vector could only mean that the phone is in free fall.</div><div id="Sec5" class="Section2 RenderAsSection2"><h3 class="Heading">7.3.1 Direction of acceleration forces</h3><div class="Para">The three components of a <span class="EmphasisFontCategoryNonProportional">Vector3</span> value are accessed via the three methods <span class="EmphasisFontCategoryNonProportional">x</span>, <span class="EmphasisFontCategoryNonProportional">y</span> and <span class="EmphasisFontCategoryNonProportional">z</span>. They correspond to the X, Y and Z dimensions, as in Figure <span class="InternalRef"><a href="#Fig2">7-2</a></span>.</div><div class="Para">As can be seen in the figure, when the phone is lying flat on the table, the vector has a value of the form (0.0, 0.0, k) where k is some negative number. The value of k depends on what units are used for measuring a force. The TouchDevelop API reports the force in g (gravitational) units. Any object which is perfectly stationary is subjected to a force of 1g in the downwards direction. In other words, the Vector3 value returned by the accelerometer should be exactly (0.0, 0.0, -1.0) when the phone is kept still and lying flat on a table with the screen facing up.</div><div class="Para">When the phone is held vertically with its bottom edge on the table, the Vector3 value should be (0.0, -1.0, 0.0). If we turn the phone upside-down so that the top edge is on the table, the value should be (0.0, 1.0, 0.0).</div><div class="Para">A short script to show the values of these components is the following.</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">action</span></span>
              <span class="EmphasisFontCategoryNonProportional">main( )</span>
            </div><div class="Para ParaTypeProgramcode">                    <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">acc := senses</span> → <span class="EmphasisFontCategoryNonProportional">acceleration quick</span>
            </div><div class="Para ParaTypeProgramcode">                    <span class="EmphasisFontCategoryNonProportional">("Z component = " || acc</span> → <span class="EmphasisFontCategoryNonProportional">z)</span> → <span class="EmphasisFontCategoryNonProportional">post to wall</span>
            </div><div class="Para ParaTypeProgramcode">                    <span class="EmphasisFontCategoryNonProportional">("Y component = " || acc</span> → <span class="EmphasisFontCategoryNonProportional">y)</span> → <span class="EmphasisFontCategoryNonProportional">post to wall</span>
            </div><div class="Para ParaTypeProgramcode">                    <span class="EmphasisFontCategoryNonProportional">("X component = " || acc</span> → <span class="EmphasisFontCategoryNonProportional">x)</span> → <span class="EmphasisFontCategoryNonProportional">post to wall</span>
            </div><div class="Para">
              <div class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img src="A978-1-4302-6137-7_7_Fig2_HTML.jpg" alt="A978-1-4302-6137-7_7_Fig2_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-2</span><div class="SimplePara">Accelerometer orientation</div></div></div></div>
            </div><div class="Para">Typical output from the script looks similar to the following:</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">X component = 0.0092241987586021423</span>
            </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">Y component = -0.03411596268415451</span>
            </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">Z component = -0.99446910619735718</span>
            </div><div class="Para">The values are close to 0.0, 0.0 and -1.0. The discrepancies show that the accelerometer may have some measuring error and that the phone is probably not located on a perfectly horizontal surface.</div></div><div id="Sec6" class="Section2 RenderAsSection2"><h3 class="Heading">7.3.2 Example script: a light show (/tbcb)</h3><div class="Para">This script simply converts movements of the phone into colors, and these colors are applied to the entire screen. The script is shown in Figure <span class="InternalRef"><a href="#Fig3">7-3</a></span>.</div><div class="Para">The script maps the X, Y and Z components of an acceleration reading to three color components. However it is not a simple mapping. The script needs to ensure that the three color components are kept within the 0.0 to 1.0 range. Secondly, the RGB components of a color do not have equal importance to the human eye. A normal eye is much less responsive to the color blue than to red or green. To distribute the perceived colors out a bit more evenly among the possibilities, an alternative color representation known as HSB (short for <span class="EmphasisTypeItalic">hue</span>, <span class="EmphasisTypeItalic">saturation</span> and <span class="EmphasisTypeItalic">brightness</span>) is used.</div><div class="Para">The script takes a reading from the accelerometer every 0.1 seconds and uses it to set the screen’s color.</div><div class="Para">An equivalent version of this script is published on the TouchDevelop website as /wnny. The wnny script uses the gameloop event to trigger a reading of the accelerometer every 50 milliseconds, and it calls an action in a library script to convert a Vector3 value into a Color value.</div><div class="Para">Another sample script which uses the accelerometer is the simplified airplane attitude indicator, published as /akgk. The current orientation of the phone with respect to gravity is determined by checking the result from the accelerometer. That is used to display an artificial horizon on the screen, simulating what a pilot would see with an attitude indicator in an airplane.
<div class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img src="A978-1-4302-6137-7_7_Fig3_HTML.jpg" alt="A978-1-4302-6137-7_7_Fig3_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-3</span><div class="SimplePara">Accelerometer colors simplified (script /tbcb)</div></div></div></div>
            </div></div></div><div id="Sec7" class="Section1 RenderAsSection1"><h2 class="Heading">7.4 Compass</h2><div class="Para">Most smartphones contain a built-in compass which reports the phone’s orientation with respect to magnetic north. The methods of the senses resource which directly use the compass are listed in Table <span class="InternalRef"><a href="#Tab1">7-1</a></span>.</div><div id="Sec8" class="Section2 RenderAsSection2"><h3 class="Heading">7.4.1 Example script: a magnetic compass (/drvu)</h3><div class="Para">As a demonstration of the usage of the compass sensor, the script provided below simulates an old-fashioned magnetic compass, where the compass’s needle always points north.</div><div class="Para">Most of the script is concerned with displaying an arrow, which represents the needle, on top of a solid circle which represents the dial. The important statement in the script concerned with the sensor is the following.</div><div class="Para ParaTypeProgramcode">          <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">angle := senses</span> → <span class="EmphasisFontCategoryNonProportional">heading</span>  // get heading in degrees</div><div class="Para">The value returned by <span class="EmphasisFontCategoryNonProportional">senses</span>→<span class="EmphasisFontCategoryNonProportional">heading</span> is, as the API documentation says, “the compass heading, in degrees, measured clockwise from the Earth’s magnetic north”. A value of 15, say, means that the magnetic north should be 15 degrees to the left of the direction in which the phone is currently pointing.</div><div class="Para">The script is shown in Figure <span class="InternalRef"><a href="#Fig4">7-4</a></span>. Most of the code is concerned with drawing a representation of a large arrow.</div></div></div><div id="Sec9" class="Section1 RenderAsSection1"><h2 class="Heading">7.5 Gyroscope</h2><div class="Para">Many Windows phones also possess a gyroscope. This is a device which reports on whether the phone is being rotated – rotated in absolutely any orientation. Rotation is measured as an angular velocity, which is rotation speed in degrees per second about an axis in three dimensional space. The API methods to access the gyroscope are listed in Table <span class="InternalRef"><a href="#Tab1">7-1</a></span>.</div><div class="Para">The angular velocity is reported by the TouchDevelop API as a <span class="EmphasisFontCategoryNonProportional">Vector3</span> value reporting rotation in three dimensional space. A value of (360, 0, 0) indicates a rotational speed of one revolution per second about the X axis in a clockwise direction, and similarly for the Y and Z axes. Given a reading of (<span class="EmphasisTypeItalic">a</span>, <span class="EmphasisTypeItalic">b</span>, <span class="EmphasisTypeItalic">c</span>), the combined rotational speed can be computed as √(<span class="EmphasisTypeItalic">a</span>
            <sup>2</sup> + <span class="EmphasisTypeItalic">b</span>
            <sup>2</sup> + <span class="EmphasisTypeItalic">c</span>
            <sup>2</sup>) measured about some axis in 3D space.</div><div class="Para">The value returned by the <span class="EmphasisFontCategoryNonProportional">rotation speed</span> method measures which axis the phone is being rotated about, and how fast. For example, if the X and Y components of the angular velocity are much smaller than the Z component, then the phone is likely to be lying flat on a table and being spun around (because the Z axis is perpendicular to the phone’s screen).
<div class="Figure" id="Fig4"><div class="MediaObject" id="MO4"><img src="A978-1-4302-6137-7_7_Fig4_HTML.jpg" alt="A978-1-4302-6137-7_7_Fig4_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-4</span><div class="SimplePara">Magnetic compass script (script /drvu)</div></div></div></div>
          </div></div><div id="Sec10" class="Section1 RenderAsSection1"><h2 class="Heading">7.6 Motion</h2><div class="Para">Perhaps there is a use for gyroscope readings in a game which requires spinning the device around? However, it is much more likely that the gyroscope is useful when used in combination with the accelerometer and compass. The following code snippet extracts a combined reading from all three sensors.</div><div class="Para ParaTypeProgramcode">          <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">motion := senses</span> → <span class="EmphasisFontCategoryNonProportional">motion</span>
          </div><div class="Para ParaTypeProgramcode">          <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
            <span class="EmphasisFontCategoryNonProportional">motion</span> → <span class="EmphasisFontCategoryNonProportional">is invalid</span>
            <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
          </div><div class="Para ParaTypeProgramcode">                    <span class="EmphasisFontCategoryNonProportional">"Your device does not have motion capability!"</span> → <span class="EmphasisFontCategoryNonProportional">post to wall</span>
          </div><div class="Para ParaTypeProgramcode">                    <span class="EmphasisFontCategoryNonProportional">time</span> →<span class="EmphasisFontCategoryNonProportional">stop</span>
          </div><div class="Para ParaTypeProgramcode">          <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">else</span></span>  // do nothing</div><div class="Para">The value obtained in the first statement has the <span class="EmphasisFontCategoryNonProportional">Motion</span> datatype. Methods associated with the <span class="EmphasisFontCategoryNonProportional">Motion</span> datatype allow various component readingsto be extracted. The methods provided by the <span class="EmphasisFontCategoryNonProportional">Motion</span> type are summarized in Figure <span class="InternalRef"><a href="#Fig5">7-5</a></span> (The <span class="EmphasisFontCategoryNonProportional">is invalid</span> and post to wall methods are omitted).</div><div class="Para">One very important feature is that the software can separate the force on the accelerometer into the force caused by gravity and the additional force caused by acceleration. In other words, the acceleration method returns a true acceleration and does not include a gravitational force component. The force of gravity should always be equal to 1g but its direction depends on which way the device is oriented.</div><div class="Para">Another important feature of a Motion value is that an accurate value for the device’s orientation can be obtained for the time when the value was captured. The direction of the <span class="EmphasisFontCategoryNonProportional">Vector3</span> value returned by <span class="EmphasisFontCategoryNonProportional">senses</span>→<span class="EmphasisFontCategoryNonProportional">acceleration quick</span> would usually be adequate, but it can be disturbed by waving the device around. The true orientation of the device is known as its <span class="EmphasisTypeItalic">attitude</span>. The three methods named <span class="EmphasisFontCategoryNonProportional">pitch</span>, <span class="EmphasisFontCategoryNonProportional">roll</span> and <span class="EmphasisFontCategoryNonProportional">yaw</span> report the phone’s attitude measured in degrees, respectively relative to three orthogonal axes. These axes are diagrammed in Figure <span class="InternalRef"><a href="#Fig6">7-6</a></span> if your smartphone is substituted for the plane. If the phone is held vertically and facing magnetic north, the values for the yaw, pitch and roll should all be zero. Any rotations relative to that starting position will cause the values to become non-zero.
<div class="Figure" id="Fig5"><div class="MediaObject" id="MO5"><img src="A978-1-4302-6137-7_7_Fig5_HTML.jpg" alt="A978-1-4302-6137-7_7_Fig5_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-5</span><div class="SimplePara">Methods of the Motion type</div></div></div></div>
          </div><div class="Para">Note that the current orientation of the phone can be obtained with the <span class="EmphasisFontCategoryNonProportional">senses</span>→ orientation method.
<div class="Figure" id="Fig6"><div class="MediaObject" id="MO6"><img src="A978-1-4302-6137-7_7_Fig6_HTML.jpg" alt="A978-1-4302-6137-7_7_Fig6_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-6</span><div class="SimplePara">Yaw, pitch and roll</div></div></div></div>
          </div><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant"><div class="Heading">Note</div><div class="Para">The image has been copied from the Wikipedia Commons, a freely licensed media file repository.</div></div></div></div></body></html>
