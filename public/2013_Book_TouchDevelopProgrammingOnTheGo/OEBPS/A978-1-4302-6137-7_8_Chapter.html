<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><title>Interactions</title><link href="springer_epub.css" type="text/css" rel="styleSheet"/></head><body><div class="ChapterContextInformation"><div class="ContextInformation" id="Chap8"><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">R. Nigel Horspool</span> and </span><span class="Author"><span class="AuthorName">Nikolai Tillmann</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" xml:lang="en">TouchDevelop: Programming on the Go</span><span class="BookEdition">Third Edition</span></span><span class="ChapterDOI">10.1007/978-1-4302-6137-7_8</span><span class="ChapterCopyright">© R. Nigel Horspool 2013</span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" xml:lang="en">8. Interactions</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">R. Nigel Horspool</span><sup>1 <span class="ContactIcon"/></sup> and </span><span class="Author"><span class="AuthorName">Nikolai Tillmann</span><sup>2 <span class="ContactIcon"/></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff1"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Canada, USA</div></div><div class="Affiliation" id="Aff2"><span class="AffiliationNumber">(2)</span><div class="AffiliationText">TU Berlin, Germany</div></div><div class="ClearBoth"> </div></div></div><div class="ArticleOrChapterToc"><div class="TocLine"><a href="#Sec1">8.1 Social messages</a></div><div class="TocLine"><a href="#Sec4">8.2 Locations, places, maps</a></div><div class="TocLine"><a href="#Sec5">8.3 Emails</a></div><div class="TocLine"><a href="#Sec6">8.4 Phone Calls</a></div><div class="TocLine"><a href="#Sec7">8.5 2D barcodes</a></div><div class="TocLine"><a href="#Sec8">8.6 SMS messages (WP8 only)</a></div><div class="TocLine"><a href="#Sec9">8.7 Calendar and appointments (WP8 only)</a></div><div class="TocLine"><a href="#Sec10">8.8 Contacts (WP8 and Android only)</a></div></div><div class="Abstract" id="Abs1" xml:lang="en"><div class="Heading">Abstract</div><div class="Para">Smart phones, tablets and computers provide calendars, e-mail, access to social media, some forms of instant messaging, SMS and phone calls. Even a computer might place a phone call through the use of a service like Skype. These are all forms of interaction which are covered in this chapter.</div></div><!--End Abstract--><div class="Fulltext"><div class="Para">Smart phones, tablets and computers provide calendars, e-mail, access to social media, some forms of instant messaging, SMS and phone calls. Even a computer might place a phone call through the use of a service like Skype. These are all forms of interaction which are covered in this chapter.</div><div id="Sec1" class="Section1 RenderAsSection1"><h2 class="Heading">8.1 Social messages</h2><div class="Para">Several websites, including Twitter and Facebook in particular, provide the ability to post messages for other people to read. These messages may have associated content, such as a picture or an audio clip. The TouchDevelop API provides facilities for downloading such messages and for posting new messages.</div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">social</span> resource provides the two methods listed in Table <span class="InternalRef"><a href="#Tab1">8-1</a></span> for creating a new message and for retrieving messages from a website. A simple example of obtaining messages from the two supported social networks and displaying them might be as follows.</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">TD msgs := social → search(“twitter”, “#touchdevelop”)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">more msgs := social → search(“facebook”, “TouchDevelop”)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">// combine the two collections into one</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">TD msgs → add many(more msgs)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">// reorder and display the messages</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">TD msgs → sort by date</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">TD msgs → post to wall</span>
          </div><div class="Para">
            <div id="Tab1" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-1</span><div class="SimplePara">Messaging methods of the social service</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Methods</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">social→create message(</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">message : String) : Message</span>
                      </div></td><td align="left"><div class="SimplePara">Creates a new message with the text body provided.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">social→search(network : String, terms : String) : Message Collection</span>
                      </div></td><td align="left"><div class="SimplePara">Searches twitter or Facebook for recent messages matching the search terms provided.</div></td></tr></tbody></table></div>
          </div><div id="Sec2" class="Section2 RenderAsSection2"><h3 class="Heading">8.1.1 Working with messages</h3><div class="Para">A <span class="EmphasisFontCategoryNonProportional">Message</span> value will usually have a text component, because that is the simplest form of message. However additional information is usually associated with that message. The TouchDevelop API supports many methods for accessing or setting extra content attached to a message. These are all methods of the <span class="EmphasisFontCategoryNonProportional">Message</span> datatype. The methods for accessing, or getting, content are listed in the first table of section C.25 in Appendix C, those for setting content in the second table, and some additional methods in the third table.</div><div class="Para">It should be remembered that the extra content of a message is not always present. After retrieving one of these optional values, such as <span class="EmphasisFontCategoryNonProportional">media link</span>, the script should perform the test <span class="EmphasisFontCategoryNonProportional">is invalid</span> to verify that the value was actually available.</div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">share</span> method of a <span class="EmphasisFontCategoryNonProportional">Message</span> instance allows the message to be transmitted in one of a variety of ways. Whichever choice is provided for the <span class="EmphasisTypeItalic">where</span> parameter, a dialog box is displayed. The message is not sent until a selection has been picked and/or a button to send the message has been tapped.</div></div><div id="Sec3" class="Section2 RenderAsSection2"><h3 class="Heading">8.1.2 Message collections</h3><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Message Collection</span> type is a mutable collection of messages. An empty instance may be created with the following call:</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
              <span class="EmphasisFontCategoryNonProportional">msgs := collections → create message collection</span>
            </div><div class="Para">This empty collection may then be populated using the standard methods for adding new elements to a collection.</div><div class="Para">Collections of messages may also be created by the <span class="EmphasisFontCategoryNonProportional">social</span>→<span class="EmphasisFontCategoryNonProportional">search</span> and <span class="EmphasisFontCategoryNonProportional">web</span>→<span class="EmphasisFontCategoryNonProportional">feed</span> methods. The <span class="EmphasisFontCategoryNonProportional">web</span>→<span class="EmphasisFontCategoryNonProportional">feed</span> method accesses an RSS stream or Atom feed on the internet and parses that stream into a sequence of messages. An example script which uses the method is <span class="EmphasisTypeItalic">rmc reader</span> (<span class="EmphasisFontCategoryNonProportional">/fiol</span>).</div><div class="Para">The <span class="EmphasisFontCategoryNonProportional">Message Collection</span> type provides several methods which are common to all mutable collection types. However there are two additional methods which are particularly useful for managing a message collection. These are listed in Table <span class="InternalRef"><a href="#Tab2">8-2</a></span>.
<div id="Tab2" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-2</span><div class="SimplePara">Extra methods of the Message Collection datatype</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Message Collection Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">reverse: Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Reverses the order of the messages in the collection</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                          <span class="EmphasisFontCategoryNonProportional">sort by date : Nothing</span>
                        </div></td><td align="left"><div class="SimplePara">Sorts the messages by their associated date and time values, from newest to oldest</div></td></tr></tbody></table></div>
            </div></div></div><div id="Sec4" class="Section1 RenderAsSection1"><h2 class="Heading">8.2 Locations, places, maps</h2><div class="Para">Many messages, pictures and media resources have location information associated with them. A location is implemented as a pair of geographical coordinates. However, web services exist for finding a place name near to the location, for pinpointing the location on a map, and for obtaining directions from one location to another.</div><div class="Para">A location can be created or described by using the methods of the <span class="EmphasisFontCategoryNonProportional">locations</span> resource. These methods are listed in Table <span class="InternalRef"><a href="#Tab3">8-3</a></span>.</div><div class="Para">In addition to the methods provided by the locations service, location values can be obtained from several other sources. Here is a list of the possibilities.
<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para">senses → current location</div></li><li><div class="Para">senses → current location accurate</div></li><li><div class="Para">maps → directions</div></li><li><div class="Para">location method of the Link datatype</div></li><li><div class="Para">center method of the Map datatype</div></li><li><div class="Para">location method of the Message datatype</div></li><li><div class="Para">location method of the Picture datatype</div></li><li><div class="Para">location method of the Place datatype</div></li></ul></div>
            <div id="Tab3" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-3</span><div class="SimplePara">Methods of the locations service</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">locations → create location(</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">latitude : Number,</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">longitude : Number) : Location</span>
                      </div></td><td align="left"><div class="SimplePara">Creates a new location from its coordinates</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">locations → create location list : Location Collection</span>
                      </div></td><td align="left"><div class="SimplePara">Creates an empty list of locations</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">locations → describe location(</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">location : Location) : String</span>
                      </div></td><td align="left"><div class="SimplePara">Finds a name or an address for a location using Bing</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">locations → search location(address : String, postal code : String, city : String, country : String) : Location</span>
                      </div></td><td align="left"><div class="SimplePara">Looks up the coordinates of an address using Bing</div></td></tr></tbody></table></div>
          </div><div class="Para">Locations are closely associated with maps. The TouchDevelop API provides both a <span class="EmphasisFontCategoryNonProportional">maps</span> service and a <span class="EmphasisFontCategoryNonProportional">Map</span> datatype. Maps are provided through use of Bing. The methods of the <span class="EmphasisFontCategoryNonProportional">maps</span> service are listed in Table <span class="InternalRef"><a href="#Tab4">8-4</a></span> and the methods of the Map datatype in Table <span class="InternalRef"><a href="#Tab5">8-5</a></span>.</div><div class="Para">A small example of using locations and the Bing map service is provided by the script <span class="EmphasisTypeItalic">go to picture</span> (<span class="EmphasisFontCategoryNonProportional">/gpona</span>). The entire script is reproduced below.</div><div class="Para ParaTypeProgramcode">       <span class="EmphasisFontCategoryNonProportional">action main( )</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">// Picks a picture in the library and displays</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">// directions to the location where it was taken.</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">pic := media → choose picture</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">loc := pic → location</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">if</span></span>
            <span class="EmphasisFontCategoryNonProportional">loc → is invalid</span>
            <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">then</span></span>
          </div><div class="Para ParaTypeProgramcode">                      <span class="EmphasisFontCategoryNonProportional">wall → prompt("This picture does not have location information.")</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">else</span></span>
          </div><div class="Para ParaTypeProgramcode">                      <span class="EmphasisFontCategoryNonProportional">maps → open directions("", senses → current location, "", loc)</span>
          </div><div class="Para">The Place datatype provides a wrapper for a location so that additional information can be attached to the location. There are both getter and setter methods for the different kinds of additional information. They are listed in the tables of Section C.37 in Appendix C. In addition to these methods, there the usual is invalid and post to wall methods and two more. They are check in, which is provided for Facebook interactions, and to string which creates a string representation of a place.
<div id="Tab4" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-4</span><div class="SimplePara">Methods of the maps service</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">maps→ create full map : Map</span>
                      </div></td><td align="left"><div class="SimplePara">Creates a full screen Bing map</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">maps → create map : Map</span>
                      </div></td><td align="left"><div class="SimplePara">Creates a Bing map</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">maps → directions(</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">from : Location, to : Location,</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">walking : Boolean) :</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">Location Collection</span>
                      </div></td><td align="left"><div class="SimplePara">Provides a point by point itinerary to get from the one location to another. If walking is true, the route is suitable for walking; otherwise a vehicle route is assumed</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">maps → open directions(</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">start search : String,</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">start loc : Location,</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">end search : String,</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">end loc : Location) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Opens the Bing map application to show the route from one point to another. The two end points can be specified by either a search term or a location. The search term should be “” if the location is to be used.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">maps → open map(center : Location, search : String,</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">zoom : Number) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Opens the Bing map application around a central point specified by either a search term or a location; zoom is 0 (close) to 1 (far)</div></td></tr></tbody></table></div>
          </div></div><div id="Sec5" class="Section1 RenderAsSection1"><h2 class="Heading">8.3 Emails</h2><div class="Para">A TouchDevelop script can prepare an email message ready for transmission, but it does not actually send it. The following short script prepares a message:</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">msg := social → create message(“The dinner party is tonight!”)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">msg → set from(“your friendly host”)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">msg → set to(“another@outlook.com”)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">msg → set title(“Invitation reminder”)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">msg → share(“email”)</span>
          </div><div class="Para">When these commands are executed, the last one (the <span class="EmphasisFontCategoryNonProportional">share</span> method call) asks which mail account should be used (if more than one has been set up on the phone) and then invokes the phone’s email application. The message is not sent until a <span class="EmphasisTypeItalic">send</span> button in that application is tapped.
<div id="Tab5" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-5</span><div class="SimplePara">Methods of the Map datatype</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Map Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">add line(locations : Location Collection, color : Color, thickness : Number) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Fits a line through the list of locations, drawing the line with the given thickness and color</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">add link(link : Link, background : Color, foreground : Color) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Adds a link pushpin to the map at the location associated with the link value</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">add message(msg : Message, background : Color, foreground : Color) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Adds a message pushpin to the map at the location associated with the message value</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">add picture(location : Location, picture : Picture, background : Color) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Adds a picture pushpin to the map at the location associated with the picture value</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">add place(place : Place, background : Color, foreground : Color) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Adds a place pushpin to the map at the location associated with the place value</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">add text(location : Location, text : String, background : Color, foreground : Color) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Adds a text pushpin to the map at the specified location</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">center : Location</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the map center location</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">clear : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Removes all lines, pushpins and regions</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">fill region(locations : Location Collection, fill : Color, stroke : Color, thickness : Number) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Draws the edges around a region whose vertices are specified by the list of locations, and fills the region with a given color.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">set center(center : Location) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Sets the map’s center</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">set zoom(level : Number) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Sets the map’s zoom level, ranging from 1 (whole earth displayed) to 21 (street level)</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">view pushpins : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Changes the zoom and center so that all pushpins are visible; the map must be posted on the wall</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">zoom : Number</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the current zoom level</div></td></tr></tbody></table></div>
          </div><div class="Para">Although the email application can be invoked to send a message, there is no API support for directly reading email with a TouchDevelop script.</div></div><div id="Sec6" class="Section1 RenderAsSection1"><h2 class="Heading">8.4 Phone Calls</h2><div class="Para">A script can prepare for a phone call by setting up the number and transferring control to the phone’s software for making the call. This facility is provided by the phone resource in the API. The relevant method calls in the API are listed in Table <span class="InternalRef"><a href="#Tab6">8-6</a></span>.
<div id="Tab6" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-6</span><div class="SimplePara">Methods for handling phone calls</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone → choose phone number: Link</span>
                      </div></td><td align="left"><div class="SimplePara">Opens the phone’s contact list so that a phone number can be selected</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone → dial phone number(number : String) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Sets up a phone call with the provided number, but does not dial the number</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">phone → save phone number(phone number : String) : Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Opens the phone’s contact list to allow the number to added to an existing entry or to a new entry</div></td></tr></tbody></table></div>
          </div><div class="Para">Some sample code to set up a phone call, ready for initiating the connection, is as follows:</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">link := phone → choose phone number</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">phone → dial phone number( link → address)</span>
          </div><div class="Para">It is not possible to write a script which answers an incoming phone call or which records an audio clip from a phone call.</div></div><div id="Sec7" class="Section1 RenderAsSection1"><h2 class="Heading">8.5 2D barcodes</h2><div class="Para">TouchDevelop provides access to the Microsoft Tag service which generates two-dimensional barcodes for text messages and for URLs. These barcodes are square images which can be printed onto documents or publicity material. Most smart phones, whether a Windows phone or not, possess scanning software which enables a user to focus on the barcode with the phone’s camera and automatically display the text or visit the webpage.</div><div class="Para">The barcode generation methods are provided by the tags resource. Its two methods are listed in Table <span class="InternalRef"><a href="#Tab7">8-7</a></span>.
<div id="Tab7" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-7</span><div class="SimplePara">Barcode generation methods</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">tags → tag text(text : String, size : Number, bw : Boolean) : Picture</span>
                      </div></td><td align="left"><div class="SimplePara">Generates a barcode for the text (up to 1000 characters); size is the width and height of the picture in inches and must be in the range 0.75 to 5.0; if bw is true, the image is generated in black and white, otherwise color.</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">tags → tag url(url : String, size : Number, bw : Boolean) : Picture</span>
                      </div></td><td align="left"><div class="SimplePara">Generates a barcode which points at the supplied URL; size and bw have the same meanings as above.</div></td></tr></tbody></table></div>
          </div><div class="Para">This sample code generates and displays a barcode:</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">pic := tags → tag text(“TouchDevelop is cool!”, 1.0, false)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">pic → post to wall</span>
          </div><div class="Para">The result of running these two statements is shown in Figure <span class="InternalRef"><a href="#Fig1">8-1</a></span> on the left. The result when the third argument is changed to true appears on the right. Both versions of the barcode work with scanning software.
<div class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img src="A978-1-4302-6137-7_8_Fig1_HTML.jpg" alt="A978-1-4302-6137-7_8_Fig1_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-1</span><div class="SimplePara">Examples of 2D barcodes</div></div></div></div>
          </div></div><div id="Sec8" class="Section1 RenderAsSection1"><h2 class="Heading">8.6 SMS messages (WP8 only)</h2><div class="Para">SMS is an abbreviation for <span class="EmphasisTypeItalic">Short Message Service</span>. It is a text messaging service provided by the phone company. It is normally used for sending a message from one cellphone to another cellphone, though some phone companies may provide additional methods for sending or receiving the messages. The original standard for SMS limited message bodies to be a maximum of 140 bytes. (The <span class="EmphasisTypeItalic">twitter</span> social networking service has the same limit.) Longer messages are automatically broken up into a sequence of short messages.</div><div class="Para">The TouchDevelop API allows a script to generate an SMS message ready for transmission but it will not actually send it. The user has to perform one additional action.</div><div class="Para">A few lines of script to generate an SMS message and prepare it for transmission are as follows:</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">msg := “Come right now, the pizza has arrived”</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">recipient := “202 555 1234”</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">social → send sms( recipient, msg )</span>
          </div><div class="Para">If that script is executed, the phone’s messaging software is activated and the phone displays the standard dialog for sending a SMS message, as shown in Figure <span class="InternalRef"><a href="#Fig2">8-2</a></span>.
<div class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img src="A978-1-4302-6137-7_8_Fig2_HTML.jpg" alt="A978-1-4302-6137-7_8_Fig2_HTML.jpg"/></div><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 8-2</span><div class="SimplePara">Sending an SMS message</div></div></div></div>
          </div></div><div id="Sec9" class="Section1 RenderAsSection1"><h2 class="Heading">8.7 Calendar and appointments (WP8 only)</h2><div class="Para">The Windows phone provides a calendar where each day’s schedule, comprised of various meetings or appointments, is recorded.</div><div class="Para">The phone’s calendar may be synchronized with one or more calendars held externally, such as a Windows Outlook calendar or a calendar of events on a social network site.</div><div class="Para">A TouchDevelop script has read-only access to the phone’s calendar and can retrieve all the appointments for a specific range of times. As a small example, the following statements will retrieve and display tomorrow’s appointments.</div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">start time := time → tomorrow</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">end time := start time → add hours(24)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisTypeBold"><span class="EmphasisFontCategoryNonProportional">var</span></span>
            <span class="EmphasisFontCategoryNonProportional">appts := social →</span>
            <span class="EmphasisFontCategoryNonProportional">search appointments</span>
            <span class="EmphasisFontCategoryNonProportional">(start time, end time)</span>
          </div><div class="Para ParaTypeProgramcode">               <span class="EmphasisFontCategoryNonProportional">appts → post to wall</span>
          </div><div class="Para">Note that <span class="EmphasisFontCategoryNonProportional">social</span>→<span class="EmphasisFontCategoryNonProportional">search</span> appointments is the only mechanism provided for accessing the calendar. Each appointment obtained from the calendar has several associated attributes. They may be accessed by using the methods listed in Table <span class="InternalRef"><a href="#Tab8">8-8</a></span>. (The two methods, <span class="EmphasisFontCategoryNonProportional">invalid</span> and <span class="EmphasisFontCategoryNonProportional">post to wall</span>, are omitted from the table.)
<div id="Tab8" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-8</span><div class="SimplePara">Methods of the Appointment datatype</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Appointment Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">attendees:</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">Contact Collection</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the list of attendees for the appointment</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">details</span>
                        <span class="EmphasisFontCategoryNonProportional">: String</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the details (body) of the appointment</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">end time</span>
                        <span class="EmphasisFontCategoryNonProportional">: DateTime</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the end time, if available</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">is all day event</span>
                        <span class="EmphasisFontCategoryNonProportional">: Boolean</span>
                      </div></td><td align="left"><div class="SimplePara">Returns true if the appointment is flagged as being all day</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">is private</span>
                        <span class="EmphasisFontCategoryNonProportional">: Boolean</span>
                      </div></td><td align="left"><div class="SimplePara">Returns true if the calendar entry is flagged as being private</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">location</span>
                        <span class="EmphasisFontCategoryNonProportional">: String</span>
                      </div></td><td align="left"><div class="SimplePara">Returns location associated with the appointment</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">organizer</span>
                        <span class="EmphasisFontCategoryNonProportional">: Contact</span>
                      </div></td><td align="left"><div class="SimplePara">Returns the organizer of the appointment, if available</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">source</span>
                        <span class="EmphasisFontCategoryNonProportional">: String</span>
                      </div></td><td align="left"><div class="SimplePara">Returns the appointment’s source, i.e. which calendar or social network site it came from</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">start time</span>
                        <span class="EmphasisFontCategoryNonProportional">: DateTime</span>
                      </div></td><td align="left"><div class="SimplePara">Gets the end time, if available</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">status</span>
                        <span class="EmphasisFontCategoryNonProportional">: String</span>
                      </div></td><td align="left"><div class="SimplePara">Returns the user’s status for this appointment (free, tentative, busy or outofoffice)</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">subject</span>
                        <span class="EmphasisFontCategoryNonProportional">: String</span>
                      </div></td><td align="left"><div class="SimplePara">Returns the appointment’s subject, if available</div></td></tr></tbody></table></div>
          </div></div><div id="Sec10" class="Section1 RenderAsSection1"><h2 class="Heading">8.8 Contacts (WP8 and Android only)</h2><div class="Para">Each contact contains several fields. All fields except for the name are optional. The values of these fields may be retrieved by using the access methods listed in first table given in Section C.7 of Appendix C. The values of nearly all these fields may be changed by using the methods listed in second table of that section.</div><div class="Para">When some part of the contact’s information has been changed, the updated contact may be saved back to the phone’s contact list by using the <span class="EmphasisFontCategoryNonProportional">social</span>→<span class="EmphasisFontCategoryNonProportional">save</span> contact method.
<div id="Tab9" class="Table"><div class="Caption" xml:lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 8-9</span><div class="SimplePara">Methods for accessing and creating contacts</div></div></div><table border="1"><colgroup><col align="left"/><col align="left"/></colgroup><thead><tr class="header"><th align="left"><div class="SimplePara">Method</div></th><th align="left"><div class="SimplePara">Description</div></th></tr></thead><tbody><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">social→</span>
                        <span class="EmphasisFontCategoryNonProportional">choose contact</span>
                        <span class="EmphasisFontCategoryNonProportional">: Contact</span>
                      </div></td><td align="left"><div class="SimplePara">Allows user to select a contact from the phone’s contact list</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">social→</span>
                        <span class="EmphasisFontCategoryNonProportional">choose email</span>
                        <span class="EmphasisFontCategoryNonProportional">: Link</span>
                      </div></td><td align="left"><div class="SimplePara">Allows user to select a contact’s email from the phone’s contact list</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">social→</span>
                        <span class="EmphasisFontCategoryNonProportional">create contact</span>
                        <span class="EmphasisFontCategoryNonProportional">( nickname : String) : Contact</span>
                      </div></td><td align="left"><div class="SimplePara">Creates a new contact with only the nickname field specified</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">social→</span>
                        <span class="EmphasisFontCategoryNonProportional">save contact</span>
                        <span class="EmphasisFontCategoryNonProportional">( contact : Contact): Nothing</span>
                      </div></td><td align="left"><div class="SimplePara">Saves a new contact in the phone’s contact list</div></td></tr><tr class="noclass"><td align="left"><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">social→</span>
                        <span class="EmphasisFontCategoryNonProportional">search contacts</span>
                        <span class="EmphasisFontCategoryNonProportional">( prefix : String) :</span>
                      </div><div class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional">Contact Collection</span>
                      </div></td><td align="left"><div class="SimplePara">Searches for contacts whose names begin with the supplied prefix</div></td></tr></tbody></table></div>
          </div></div></div></body></html>
